# å¦‚ä½•å†™ä¸€ä¸ª ERC-4626 ä»£å¸åˆåŒçš„æ”¶ç›Šç‡æ‰¿è½½é‡‘åº“

> åŸæ–‡ï¼š<https://blog.logrocket.com/write-erc-4626-token-contract-yield-bearing-vaults/>

2022 å¹´ 4 æœˆï¼Œæµè¡Œçš„ DEFI åè®®â€œæ¸´æœ›é‡‘èâ€å®£å¸ƒæ”¯æŒæ–°æ¨å‡ºçš„ä»¥å¤ªåŠå¾æ±‚æ„è§ç¨¿(ERC)-4626 ä»¤ç‰Œæ ‡å‡†ï¼Œå£°æ˜â€œæ¸´æœ› V3 + ERC-4626 =ä¸å¯é¿å…â€

> 5/å‘å¾€ V3 + ERC-4626 =ä¸å¯é¿å…è´¡çŒ®è€…å·²ç»åœ¨åŠªåŠ›å®ç°å‘å¾€ V3 ä¿é™©åº“çš„æ ‡å‡†ï¼Œæ‰€ä»¥å¼€å‘è€…åœ¨@AlchemixFiã€@balancerã€@RariCapitalã€@feiprotocolã€@OpenZeppelin å’Œå…¶ä»–åœ°æ–¹ï¼Œä¹Ÿè®¸æœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬ç”šè‡³ä¼šåœ¨@etherscan ä¸Šçœ‹åˆ° Erc4626 æ ‡ç­¾

å¯¹äºåŸºäºä»¥å¤ªåŠçš„åº”ç”¨ç¨‹åºï¼ŒERC(ä»¥å¤ªåŠè¯·æ±‚æ³¨é‡Š)æ˜¯åŒ…æ‹¬åç§°æ³¨å†Œã€åŒ…æ ¼å¼ã€åº“å’Œä»¤ç‰Œéœ€æ±‚çš„æ ‡å‡†ã€‚ä¸ºäº†ä½¿å…¶ä»–å¼€å‘äººå‘˜èƒ½å¤Ÿé¢„æµ‹ä¸€ç»„åŠŸèƒ½æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå³ä½¿æ— æ³•è®¿é—®ç¬¦åˆè¿™äº›æ ‡å‡†çš„åº”ç”¨ç¨‹åºçš„æºä»£ç ï¼Œè¿™ç»„æ ‡å‡†æè¿°äº†è¿™äº›åŠŸèƒ½å°†å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºå’Œæ™ºèƒ½åˆçº¦ä¸­å®ç°æˆ–äº¤äº’ã€‚

é‰´äºä»¥å¤ªåŠç¤¾åŒºçš„è§„æ¨¡ä»¥åŠå¼€å‘è€…æŠ€èƒ½æ°´å¹³å’Œå®ç°æ–¹æ³•çš„å¤šæ ·æ€§ï¼ŒERC å¯¹äºä»¥å¤ªåŠç”Ÿæ€ç³»ç»Ÿè‡³å…³é‡è¦ã€‚è¿™äº›å‡†åˆ™ä½œä¸ºä¸€ä¸ªæ¡†æ¶ï¼Œä¿è¯åº”ç”¨ç¨‹åºå’Œæ™ºèƒ½åˆçº¦ä»¥ä¸€è‡´çš„æ–¹å¼æ„å»ºï¼Œä»¥ä¾¿å…¶ä»–äººå¯ä»¥ä¸ºå®ƒä»¬åšå‡ºè´¡çŒ®ã€‚

åœ¨ ERC-4626 ä¹‹å‰ï¼Œå·²ç»æˆåŠŸéƒ¨ç½²äº†å¤§çº¦ 25 ä¸ª ERC æ ‡å‡†ï¼ŒåŒ…æ‹¬ ERC-20(å¯æ›¿æ¢ä»¤ç‰Œ)ã€ERC-721(ä¸å¯æ›¿æ¢ä»¤ç‰Œï¼Œæˆ– NFTs)å’Œ ERC-1155(å•ä¸€æ™ºèƒ½åˆçº¦å¤šä»¤ç‰Œ)ã€‚

æ²¡æœ‰æ¯” ERC-4626 æ›´ç®€å•çš„æ–¹æ³•æ¥å®ç°äº§é‡ä¿é™©åº“äº†ã€‚é€šè¿‡æä¾›ä¸€ä¸ªå•ä¸€çš„ APIï¼Œå…è®¸åœ¨ä¸€ä¸ªå…±äº«çš„æ¥å£ä¸Šä»å¤šä¸ªé“¾é“¸é€ ä»¤ç‰Œï¼ŒERC-4626 ä½¿ä¸åŒçš„åè®®å…·æœ‰äº’æ“ä½œæ€§ã€‚

æœ¬æ–‡å°†è§£é‡Šä»€ä¹ˆæ˜¯ ERC-4626ï¼Œæ”¶ç›Šç‡ä¿é™©åº“å¦‚ä½•å·¥ä½œï¼Œä»¥åŠå¦‚ä½•åˆ›å»ºæ”¶ç›Šç‡ä¿é™©åº“ ERC-4626 ä»¤ç‰Œæ™ºèƒ½åˆçº¦ã€‚

### å†…å®¹

## ä»€ä¹ˆæ˜¯å±ˆæœæ‹±é¡¶ï¼Ÿ

åˆ›å»ºæ™ºèƒ½åˆåŒæ˜¯ä¸ºäº†ç¡®ä¿å„ç§åŒºå—é“¾äº¤æ˜“ä¹‹é—´çš„åè®®å¾—åˆ°å±¥è¡Œã€‚æ”¶ç›Šç‡ä¿é™©åº“æ˜¯ä¸€ç§æ™ºèƒ½åˆçº¦ï¼Œå…è®¸ç”¨æˆ·å°†ä¸åŒçš„ ERC-20 ä»¤ç‰Œå­˜å…¥ä»¤ç‰Œæ± ï¼Œä»¥æ¢å– vTokens(ä¿é™©åº“ä»¤ç‰Œ)ã€‚

ç”¨æˆ·å°† vTokens å…‘æ¢æˆåˆå§‹èµ„æœ¬ä»¥åŠä»»ä½•åˆ©æ¶¦ã€‚å­˜æ”¾çš„ä»¤ç‰Œä¸å…¶ä»–ç±»ä¼¼çš„åŠ å¯†èµ„äº§äº¤æ¢(æ±‡é›†)å¹¶åˆ†å¸ƒåœ¨è®¸å¤šåè®®ä¸Šï¼Œèƒ½å¤Ÿåœ¨æœ€çŸ­çš„æ—¶é—´å†…äº§ç”Ÿæ”¶ç›Šã€‚

æ”¶ç›Šé‡‘åº“æ ¹æ®æ”¶ç›Šæœ€é«˜çš„åè®®å¯¹ä¸åŒçš„åè®®è¿›è¡Œæ’åºï¼Œç„¶åå°†ä»¤ç‰Œæ± çš„ä¸€éƒ¨åˆ†åˆ†é…ç»™æ”¶ç›Šæœ€é«˜çš„åè®®ï¼ŒåŒæ—¶ä¸ºæƒ³è¦æå–èµ„é‡‘çš„ç”¨æˆ·ä¿ç•™ä»¤ç‰Œã€‚åœ¨æ”¶è·åˆ©æ¶¦åï¼Œå½’å±ç¨‹åºé‡å¤è¿›è¡Œã€‚ç„¶åï¼Œä¿ç®¡åº“å°†å®ƒä»¬è½¬æ¢å›æœ€åˆå­˜æ”¾çš„ä»¤ç‰Œã€‚

ä¸‹å›¾æè¿°äº†é«˜äº§æ‹±é¡¶çš„å·¥ä½œåŸç†:

![vault smart contract diagram](img/d6ffdc3752d3c8eb589722ebc4ce2470.png)

ä¸Šå›¾å¯ä»¥åˆ†è§£ä¸ºå¦‚ä¸‹è¿‡ç¨‹:

é¦–å…ˆï¼Œè·³é©¬å‚ä¸è€…å¿…é¡»æŠ•å…¥ä»£å¸ã€‚ä¿ç®¡åº“å°†ç›¸ä¼¼çš„ ERC ä»£å¸åˆ†ç»„åˆ°ä¸€ä¸ªæ± ä¸­ã€‚å‘ä¿ç®¡åº“ä¸­çš„å‚ä¸è€…åˆ†é…ä¿ç®¡åº“ä»¤ç‰Œï¼Œè¿™äº›ä»¤ç‰Œåæ˜ äº†ä»–ä»¬å¯¹æ± ä¸­ä»¤ç‰Œçš„è¦æ±‚ã€‚

ä¸ºäº†ä¼˜åŒ–äº§é‡ï¼Œä¿é™©åº“é‡‡ç”¨äº†é¢„ç¼–ç¨‹ç­–ç•¥ã€‚è¿™ç§ç­–ç•¥å¯»æ‰¾æ”¶ç›Šç‡æœ€é«˜çš„æœºä¼šï¼Œå¹¶é‡æ–°åˆ†é…ä¸€å®šæ¯”ä¾‹çš„ä»£å¸ï¼Œä»¥ä¼˜åŒ–æ± åˆ©æ¶¦ï¼ŒåŒæ—¶ä¿ç•™ä¸€äº›ä»£å¸ã€‚

å½“ç”¨æˆ·æå–ä»¤ç‰Œæ—¶ï¼Œé¦–å…ˆä»ä¿ç®¡åº“å‚¨å¤‡ä¸­æå–ä»¤ç‰Œï¼Œç„¶åä»äº§å‡ºæ± ä¸­æå–ä»¤ç‰Œã€‚å½“å‚ä¸è€…é€€å‡ºæ—¶ï¼Œé€€å‡ºè´¹ç”¨è®¡ç®—ä¸ºå¤©ç„¶æ°”è´¹ã€ç­–ç•¥è´¹å’Œå›½åº“è´¹çš„æ€»å’Œã€‚

### å±ˆæœæ‹±é¡¶çš„ç”¨ä¾‹

æ—¢ç„¶ä½ çŸ¥é“äº†æ”¶ç›Šç‡æ‹±é¡¶çš„å·¥ä½œåŸç†ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚ä»¥ä¸‹æ˜¯æ‰¿è½½å±ˆæœçš„æ‹±é¡¶åº”ç”¨çš„ä¸€äº›ä¾‹å­:

*   èèµ„:é“ç»„ç»‡å’Œæ”¿åºœåœ¨æ²¡æœ‰ä¼—åŒ…çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨æ”¶ç›Šç‡é«˜çš„é‡‘åº“æ¥ç­¹é›†èµ„é‡‘
*   åŠ å¯†è´·æ¬¾:åƒ Yearn Finance è¿™æ ·çš„å…¬å¸æä¾›åè®®ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡è´·æ¬¾å’Œå‡ºå”®åŠ å¯†èµ„äº§æ¥æœ€å¤§åŒ–ä»–ä»¬çš„åˆ©æ¶¦
*   DCA(ç¾å…ƒå¹³å‡æˆæœ¬)é‡‘åº“:DCA é‡‘åº“é‡‡ç”¨æ”¶ç›Šç‡ç­–ç•¥æ¥ä¼˜åŒ–åˆ©æ¶¦

## ä»€ä¹ˆæ˜¯ ERC-4626ï¼Ÿ

â€œä»¤ç‰ŒåŒ–é‡‘åº“æ ‡å‡†â€ï¼Œä¹Ÿç§°ä¸º ERC-4626ï¼Œæ˜¯ä»¤ç‰ŒåŒ–é‡‘åº“çš„æ ‡å‡†åè®®ï¼Œä»£è¡¨æ”¶ç›Šç‡ä»¤ç‰Œçš„ä»½é¢ï¼Œå»ºç«‹åœ¨ ERC-20 ä»¤ç‰Œæ ‡å‡†çš„åŸºç¡€ä¸Šã€‚

æ¢å¥è¯è¯´ï¼ŒERC-4626 æ˜¯ ERC-20 çš„æ‰©å±•ï¼Œå¢åŠ äº†æ–°çš„åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·ä»ä»–ä»¬çš„è‚¡ä»½ä¸­è·åˆ©ã€‚ä»¥å‰ï¼Œä½¿ç”¨ ERC-20 æ ‡å‡†ï¼Œç”¨æˆ·åªèƒ½æå–å°‘äºæˆ–ç­‰äºä»–ä»¬å­˜å…¥å¸æˆ·çš„ä»£å¸é‡‘é¢ã€‚ERC-4626 å…è®¸ç”¨æˆ·æ ¹æ®é‡‘åº“äº§ç”Ÿçš„åˆ©æ¶¦ï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…æå–è¶…è¿‡åˆå§‹ä»˜æ¬¾çš„é‡‘é¢ã€‚

ä½œä¸º ERC-20 çš„æ‰©å±•ï¼ŒERC-4626 å®ç°äº†ä»¥ä¸‹åŠŸèƒ½:

*   å­˜æ¬¾å’Œå–æ¬¾
*   é‡‘åº“ä½™é¢
*   æ¥å£
*   äº‹ä»¶

## ERC å†å²-4626

2021 å¹´ 12 æœˆ 22 æ—¥ï¼Œè´¹é‡‘èçš„åˆ›å§‹äººä¹”ä¼ŠÂ·æ¡‘æ‰˜ç½—å’Œå…¶ä»–äº”ä½ä½œå®¶æå‡ºäº† 4626 ä½œä¸º[ä»¥å¤ªåŠæ”¹è¿›ææ¡ˆ](https://eips.ethereum.org/EIPS/eip-4626#:~:text=Reference%20Implementations-,Abstract,withdrawing%20tokens%20and%20reading%20balances.) (EIP)ï¼Œä»¥è§£å†³æ”¶ç›Šç‡ä»£å¸ç¼ºä¹æ ‡å‡†åŒ–è¿™ä¸€åˆ†æ•£é‡‘èä¸­çš„é—®é¢˜ã€‚

å¦‚æœä½ æƒ³çŸ¥é“â€œ4626â€è¿™ä¸ªæ•°å­—æ˜¯æ€ä¹ˆæ¥çš„ï¼ŒERC-4626 çš„åˆè‘—è€… T11s åœ¨ä¸€æ¡æ¨ç‰¹ä¸Šé€éœ²ï¼Œä¹”ä¼Šåœ¨ä¸€æ¬¡é”»ç‚¼ä¸­å‘ä»–å»ºè®®äº†è¿™ä¸ªæ•°å­—ï¼Œè¿™ä¸ªåå­—å¬èµ·æ¥æ¯”æœ€åˆæè®®çš„â€œ4700â€æ›´å¥½

> éšæœº 4626 æœ‰è¶£çš„äº‹å®:æœ€åˆæˆ‘ä»¬æƒ³ç­‰ä¸€ä¸ªå¹²å‡€çš„ EIP å·ç ï¼Œæ¯”å¦‚ 4700ï¼Œä½†ä¹”ä¼Šåœ¨ä¸€æ¬¡é€šè¯ä¸­éšæœºæåˆ°äº†å½“å‰çš„å·ç æ˜¯ 4626ï¼Œæˆ‘ä»¬éƒ½æ„è¯†åˆ°å®ƒæœ‰ä¸€ä¸ªç—…æ€çš„æŠ¼éŸµï¼Œå› ä¸ºå®ƒæ˜¯åœ¨è·‘æ­¥ä¸­ï¼Œä½†è¿˜æ˜¯è·‘å›å®¶æ¥ç¡®ä¿æˆ‘ä»¬å¾—åˆ°äº†å®ƒå“ˆå“ˆ

* * *

### æ›´å¤šæ¥è‡ª LogRocket çš„ç²¾å½©æ–‡ç« :

* * *

## å¦‚ä½•æ’°å†™ ERC-4626 ä¿é™©åº“åˆåŒ

å»ºç«‹æ‚¨çš„è®¸å¯è¯æ ‡è¯†ç¬¦å’Œç‰ˆæœ¬åï¼Œæ„å»ºæˆ‘ä»¬çš„ vault çš„ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºæ‚¨çš„ ERC20 å’Œ ERC4626 æ¥å£ï¼Œä¹Ÿç§°ä¸º IERC20 å’Œ IERC4626ã€‚è®°ä½ï¼Œä½ çš„å¥‘çº¦å¿…é¡»ä½¿ç”¨ä½ ç•Œé¢ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°ï¼›Solidity çš„æ¥å£æœ‰ä¸€ä¸ªå®šä¹‰å¥½çš„åŠŸèƒ½ï¼Œä¸é€»è¾‘ä¸€èµ·å®ç°ã€‚å®ƒä»¬æ˜¯ç»§æ‰¿çš„ï¼ŒåŸå§‹å¥‘çº¦åˆ©ç”¨äº†å®ƒä»¬çš„åŠŸèƒ½ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ª IERC20 ç•Œé¢:

```
// SPDX-License-Identifier: MIT
pragma solidity 0.8.7;

interface IERC20{

    function transferFrom(address A, address B, uint C) external view returns(bool);

    function approve() external view returns(uint256);

    function decimals() external view returns(uint256);

    function totalSupply() external view returns(uint256);

    function balanceOf(address account) external view returns(uint256);

    function transfer(address D, uint amount) external ;
}

```

ä¸‹é¢æ˜¯ä¸€ä¸ª IERC4626 ç•Œé¢:

```
//SPDX-License-Identifier: MIT
pragma solidity 0.8.7;

interface IERC4626 { 
    function totalAssets() external view returns (uint256); 
}

```

åˆ›å»ºæ¥å£åï¼Œä½¿ç”¨ ERC20 ä»¤ç‰Œæ ‡å‡†å°†å®ƒä»¬å¯¼å…¥åˆ°æ‚¨çš„åˆåŒä¸­ã€‚

ä¸‹ä¸€æ­¥æ˜¯å†™ä½ çš„åˆåŒã€‚ä¸ºæ‚¨çš„åˆåŒå‘½åï¼Œå¹¶å¯¼å…¥å¿…è¦çš„æ–‡ä»¶å’Œåº“ã€‚

```
//SPDX-License-Identifier: MIT
pragma solidity 0.8.7;

// Import the necessary files and lib
import "./Interfaces/IERC4626.sol";
import "./Interfaces/IERC20.sol";
import "https://github.com/Rari-Capital/solmate/blob/main/src/tokens/ERC20.sol";

// create your contract and inherit the your imports
contract TokenizedVault is IERC4626, ERC20 {

}

```

ç„¶åï¼Œåˆ›å»ºäº‹ä»¶ã€‚è¿™é‡Œå°†æœ‰ä¸¤ä¸ªäº‹ä»¶:ä¸€ä¸ªæ˜¯ä¾›ç”¨æˆ·å­˜æ”¾ä»¤ç‰Œçš„å­˜æ¬¾äº‹ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯ä¾›ç”¨æˆ·è¯·æ±‚å–æ¬¾çš„å–æ¬¾äº‹ä»¶:

```
// create an event that will the withdraw and deposit function
    event Deposit(address caller, uint256 amt);
    event Withdraw(address caller, address receiver, uint256 amt, uint256 shares);

```

æ‚¨å¯¼å…¥çš„ ERC-20 ä»¤ç‰Œå°†æ˜¯ä¸€ä¸ªä¸å¯å˜çš„èµ„äº§ï¼Œç”¨ä½œæ„é€ å‡½æ•°ã€‚ä¸ºæ­¤ï¼Œæ‚¨å°†åˆ›å»ºä¸€ä¸ªåä¸º`asset`çš„ä¸å¯å˜å˜é‡æ¥å¼•ç”¨æ‚¨çš„ ERC20ã€‚

ä¹‹åï¼Œåˆ¶ä½œä¸€ä¸ªæ˜ å°„æ¥å±•ç¤ºç”¨æˆ·åœ¨å­˜æ¬¾åä½œä¸ºè‚¡ä¸œçš„çŠ¶æ€:

```
// create your variables and immutables
    ERC20 public immutable asset;

// a mapping that checks if a user has deposited
    mapping(address => uint256) shareHolder;

```

æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå°†èµ„äº§å˜é‡åˆ†é…ç»™åº•å±‚ä»¤ç‰Œï¼Œè¯¥ä»¤ç‰Œçš„åœ°å€ä¸ ERC20 ä»¤ç‰Œçš„åœ°å€ã€åç§°å’Œç¬¦å·ç›¸å…³è”:

```
constructor(ERC20 _underlying, string memory _name, string memory _symbol )
     ERC20(_name, _symbol, 18) {
        asset = _underlying;
    }

```

ç°åœ¨ï¼Œåœ¨é…ç½®åˆåŒçš„èµ„äº§å’Œäº‹ä»¶ä¹‹åï¼Œä¸ºæ‚¨çš„ä¿é™©åº“ç¼–å†™å‡½æ•°ã€‚ç”¨æˆ·åº”è¯¥èƒ½å¤Ÿå­˜æ”¾ä»£å¸ä»¥ä½¿å¥‘çº¦èµ·åˆ°ä¿é™©åº“çš„ä½œç”¨ï¼›ç”¨æˆ·æ”¶åˆ°å­˜æ¬¾å‡­è¯åå­˜å…¥ï¼Œç§°ä¸ºâ€œè‚¡é‡‘â€ã€‚ç”¨æˆ·å°†åœ¨ææ¬¾æ—¶ä½¿ç”¨æ­¤ä¿¡æ¯æ¥è¦æ±‚å…¶è‚¡ä»½çš„æ‰€æœ‰æƒ:

```
// a deposit function that receives assets from users
    function deposit(uint256 assets) public{
        // checks that the deposit is higher than 0
        require (assets > 0, "Deposit less than Zero");

        asset.transferFrom(msg.sender, address(this), assets);
// checks the value of assets the holder has
        shareHolder[msg.sender] += assets;
// mints the reciept(shares)
        _mint(msg.sender, assets);

        emit Deposit(msg.sender, assets);

    }

```

åœ¨è¯¥åŠŸèƒ½å°†ä»£å¸è½¬ç§»æˆ–æ¥å—åˆ°ä¿ç®¡åº“ä¹‹å‰ï¼Œæ‰§è¡Œæ£€æŸ¥ä»¥ç¡®ä¿ç”¨æˆ·å­˜æ”¾çš„æ˜¯å®é™…ä»£å¸(è€Œä¸æ˜¯é›¶ä»£å¸)ã€‚ç”¨æˆ·æˆä¸ºè‚¡ä¸œï¼Œå¹¶ä¸”æ¯ä¸ªè‚¡ä¸œæ‹¥æœ‰ä¸ä»–ä»¬å­˜æ”¾åœ¨ä¿ç®¡åº“ä»£å¸ä¸­çš„æ•°é‡ç›¸ç­‰çš„è‚¡ä»½ï¼›æ‰€ä»¥ï¼Œå¦‚æœä»–ä»¬å­˜äº† 50 åŸƒç‰¹ï¼Œä»–ä»¬ç°åœ¨æ‹¥æœ‰çš„è‚¡ä»½å°±ç­‰äº 50 åŸƒç‰¹ã€‚

ä»¥ä¸‹å‡½æ•°ç»™å‡ºå­˜æ”¾åœ¨æ­¤ä¿é™©åº“ä¸­çš„èµ„äº§æ€»é¢:

```
// returns total number of assets
    function totalAssets() public view override returns(uint256) {
        return asset.balanceOf(address(this));
    } 

```

æ¥ä¸‹æ¥å°†å®ç°ä¸€ä¸ª`redeem`å‡½æ•°ã€‚æ­¤`internal`å‡½æ•°å°†æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰è‚¡ä»½ï¼Œä»¥åŠè‚¡ä»½æ•°é‡æ˜¯å¦å¤§äºé›¶ã€‚å¦‚æœç”¨æˆ·æ˜¯è‚¡ä¸œï¼Œä»–å¯ä»¥ä»åˆ†é…ç»™ä»–çš„è‚¡ä»½ä¸­èµå›ä»»æ„æ•°é‡çš„è‚¡ä»½ã€‚

åœ¨æ‰§è¡Œå°†è‚¡ä»½è½¬æ¢ä¸ºæœ€åˆå­˜æ”¾çš„ç›¸åŒèµ„äº§ä»¤ç‰Œçš„ burn å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸ºç”¨æˆ·æ‹¥æœ‰çš„è‚¡ä»½æ•°é‡åˆ†é… 10%çš„å›ºå®šåˆ©æ¯ã€‚

è¯·æ³¨æ„ï¼ŒåˆåŒæ‰€æœ‰è€…å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´è‚¡ä»½çš„åˆ©ç‡ã€‚

æœ€åï¼Œå®ƒå‘å‡ºå–æ¬¾äº‹ä»¶æ¥æˆäºˆç”¨æˆ·å¯¹èµ„äº§çš„è®¿é—®æƒ:

```
// users to return shares and get thier token back before they can withdraw, and requiers that the user has a deposit
function redeem(uint256 shares, address receiver ) internal returns (uint256 assets) {
        require(shareHolder[msg.sender] > 0, "Not a share holder");
        shareHolder[msg.sender] -= shares;

        uint256 per = (10 * shares) / 100;

        _burn(msg.sender, shares);

        assets = shares + per;

        emit Withdraw(receiver, assets, per);
        return assets;
    }

```

æœ€åæ˜¯`withdraw`åŠŸèƒ½ã€‚å…è®¸å­˜æ¬¾ä½†ä¸å…è®¸å–æ¬¾çš„ä¿é™©åº“è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ã€‚

ä¸ºäº†æ’¤é”€ï¼Œç”±`withdraw`å‡½æ•°è°ƒç”¨`redeem`å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è‚¡ç¥¨è½¬æ¢æˆèµ„äº§ä»¤ç‰Œå¹¶è®¡ç®—èµ„äº§çš„åˆ©æ¯ã€‚ç„¶åï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æå–å¥¹çš„èµ„äº§å’Œåˆ©æ¯:

```
// allow msg.sender to withdraw his deposit plus interest

    function withdraw(uint256 shares, address receiver) public {
        uint256 payout = redeem(shares, receiver);
        asset.transfer(receiver, payout);
    }

}

```

æ•´ä¸ªåˆåŒä»£ç å¯ä»¥åœ¨è¿™ä¸ª [GitHub gist](https://gist.github.com/wolz-CODElife/0acdee6ac30b85521377be81a0af19ac) ä¸­æ‰¾åˆ°ã€‚

## ç»“è®º

é˜…è¯»å®Œæœ¬æ–‡åï¼Œæ‚¨åº”è¯¥æœ‰æœ›æ›´å¥½åœ°äº†è§£ä»€ä¹ˆæ˜¯ ERCã€ERC-4626 ä»£å¸å’Œæ”¶ç›Šç‡é‡‘åº“ï¼Œä»¥åŠå¦‚ä½•ä¸º ERC-4626 ä»£å¸ç¼–å†™æ”¶ç›Šç‡é‡‘åº“æ™ºèƒ½åˆçº¦ã€‚

ä½ ä¹Ÿå¯ä»¥çœ‹çœ‹æˆ‘åœ¨ä»¥å¤ªåŠå®˜ç½‘ä¸Šä¸º ERC-4626 å†™çš„[æ–‡æ¡£](https://ethereum.org/en/developers/docs/standards/tokens/erc-4626/)ã€‚æ¬¢è¿åœ¨ä¸‹é¢çš„è¯„è®ºåŒºç•™ä¸‹ä½ çš„è¯„è®ºï¼ğŸ¥‚

## åŠ å…¥åƒ Bitso å’Œ Coinsquare è¿™æ ·çš„ç»„ç»‡ï¼Œä»–ä»¬ä½¿ç”¨ LogRocket ä¸»åŠ¨ç›‘æ§ä»–ä»¬çš„ Web3 åº”ç”¨

å½±å“ç”¨æˆ·åœ¨æ‚¨çš„åº”ç”¨ä¸­æ¿€æ´»å’Œäº¤æ˜“çš„èƒ½åŠ›çš„å®¢æˆ·ç«¯é—®é¢˜ä¼šæå¤§åœ°å½±å“æ‚¨çš„åº•çº¿ã€‚å¦‚æœæ‚¨å¯¹ç›‘æ§ UX é—®é¢˜ã€è‡ªåŠ¨æ˜¾ç¤º JavaScript é”™è¯¯ã€è·Ÿè¸ªç¼“æ…¢çš„ç½‘ç»œè¯·æ±‚å’Œç»„ä»¶åŠ è½½æ—¶é—´æ„Ÿå…´è¶£ï¼Œ

[try LogRocket](https://lp.logrocket.com/blg/web3-signup)

.

[![LogRocket Dashboard Free Trial Banner](img/dacb06c713aec161ffeaffae5bd048cd.png)](https://lp.logrocket.com/blg/web3-signup)[https://logrocket.com/signup/](https://lp.logrocket.com/blg/web3-signup)

LogRocket å°±åƒæ˜¯ç½‘ç»œå’Œç§»åŠ¨åº”ç”¨çš„ DVRï¼Œè®°å½•ä½ çš„ç½‘ç»œåº”ç”¨æˆ–ç½‘ç«™ä¸Šå‘ç”Ÿçš„ä¸€åˆ‡ã€‚æ‚¨å¯ä»¥æ±‡æ€»å’ŒæŠ¥å‘Šå…³é”®çš„å‰ç«¯æ€§èƒ½æŒ‡æ ‡ï¼Œé‡æ”¾ç”¨æˆ·ä¼šè¯å’Œåº”ç”¨ç¨‹åºçŠ¶æ€ï¼Œè®°å½•ç½‘ç»œè¯·æ±‚ï¼Œå¹¶è‡ªåŠ¨æ˜¾ç¤ºæ‰€æœ‰é”™è¯¯ï¼Œè€Œä¸æ˜¯çŒœæµ‹é—®é¢˜å‘ç”Ÿçš„åŸå› ã€‚

ç°ä»£åŒ–æ‚¨è°ƒè¯• web å’Œç§»åŠ¨åº”ç”¨çš„æ–¹å¼â€” [å¼€å§‹å…è´¹ç›‘æ§](https://lp.logrocket.com/blg/web3-signup)ã€‚