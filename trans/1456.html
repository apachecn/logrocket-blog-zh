<html>
<head>
<title>Using FastAPI to get updates from GitHub to Telegram - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>ä½¿ç”¨ FastAPI ä» GitHub è·å– Telegram - LogRocket åšå®¢çš„æ›´æ–°</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/#0001-01-01">https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/#0001-01-01</a></blockquote><div><article class="article-post">
<p>æ— è®ºä½ æ˜¯ä¸€ååˆéœ²å¤´è§’çš„å¼€å‘äººå‘˜è¿˜æ˜¯ä¸€åç»éªŒä¸°å¯Œçš„è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œä½ éƒ½å¯èƒ½ä½¿ç”¨è¿‡<a href="https://github.com" target="_blank" rel="noopener"> GitHub </a>ï¼Œè¿™æ˜¯ä¸€ä¸ªå¹³å°ï¼Œäººä»¬å¯ä»¥åœ¨è¿™ä¸ªå¹³å°ä¸Šæ‰˜ç®¡ä»–ä»¬é¡¹ç›®çš„æºä»£ç ï¼Œä¸ºå…¶ä»–å¼€å‘äººå‘˜çš„å…¶ä»–é¡¹ç›®åšå‡ºè´¡çŒ®ï¼Œå¹¶å¼€å‘å¼€æºè½¯ä»¶ã€‚</p>
<p>å®é™…ä¸Šï¼ŒGitHub å·²ç»æˆä¸ºäº‹å®ä¸Šçš„å¹³å°ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥æ‰¾åˆ°å„ç§å„æ ·çš„å¼€æºè½¯ä»¶å’Œç›¸å…³é¡¹ç›®ã€‚å®ƒæœ‰å¤§é‡çš„åŠŸèƒ½å’Œä¸€ä¸ªå¼€æ”¾çš„ APIï¼Œç”¨äºå¼€å‘å°†è¿æ¥åˆ° GitHub çš„åº”ç”¨ç¨‹åºã€‚</p>
<p><a href="https://telegram.org/" target="_blank" rel="noopener"> Telegram </a>æ˜¯ä¸€ä¸ªå¿«é€Ÿå¯æ‰©å±•çš„æ¶ˆæ¯å¹³å°ï¼Œå®ƒçš„ä¸€å¤§ä¼˜åŠ¿æ˜¯èŠå¤©æœºå™¨äººã€‚èŠå¤©æœºå™¨äººæ˜“äºç¼–ç¨‹ï¼Œå…·æœ‰ç®€å•çš„ HTTP APIï¼Œå¹¶ä¸”æ˜“äºç®¡ç†ã€‚è€Œä¸”ï¼Œå¤§å¤šæ•°è¯­è¨€éƒ½æœ‰åŒ…è£…å™¨æ¥ä½¿ç”¨ Telegram çš„ Bot APIã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç”µæŠ¥æœºå™¨äººï¼Œå®ƒä½¿ç”¨ Python å’Œ GitHub webhooks ä» GitHub å­˜å‚¨åº“ä¸­è·å–æ›´æ–°ã€‚æˆ‘ä»¬å°†åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ FastAPIï¼Œåœ¨å‘é€æ¶ˆæ¯æ—¶ä½¿ç”¨ Telegram çš„ HTTP APIã€‚</p>
<h2>è¦æ±‚</h2>
<ul>
<li><a href="https://www.python.org/downloads/" target="_blank" rel="noopener"> Python </a>å®‰è£…åœ¨ä½ çš„æœºå™¨ä¸Šä»¥ä¾¿åˆ›å»ºæœåŠ¡å™¨ã€‚</li>
<li>ä¸€ä»½<a href="https://telegram.org/" target="_blank" rel="noopener">ç”µæŠ¥</a>è®°è¿°</li>
<li>ä¸€ä¸ªç”µæŠ¥æœºå™¨äººï¼Œæˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­è®¨è®ºå®ƒã€‚</li>
</ul>
<h2>è®¾ç½® Python å¼€å‘ç¯å¢ƒ</h2>
<p>åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª<a href="https://docs.python.org/3/tutorial/venv.html" target="_blank" rel="noopener"> Python è™šæ‹Ÿç¯å¢ƒ</a>æ¥è¿›è¡Œä¸€ä¸ªå¹²å‡€çš„è®¾ç½®ã€‚</p>
<p>è¿™äº›æ˜¯æˆ‘ä»¬æ„å»ºé¡¹ç›®æ‰€éœ€çš„åŒ…:</p>
<ul>
<li><a href="https://fastapi.tiangolo.com" target="_blank" rel="noopener"> FastAPI </a>ä½œä¸ºåç«¯æ¡†æ¶</li>
<li><a href="https://www.python-httpx.org" target="_blank" rel="noopener"> HTTPX </a>ç”¨äºä¸ç”µæŠ¥ API é€šä¿¡çš„å¼‚æ­¥ HTTP è¯·æ±‚ã€‚</li>
<li>æœåŠ¡å™¨çš„<a href="https://www.uvicorn.org/" target="_blank" rel="noopener">uv icon</a></li>
<li>é€šè¿‡éš§é“è¿æ¥æˆ‘ä»¬çš„æœ¬åœ°æœåŠ¡å™¨</li>
</ul>
<p>å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä»è®¾ç½®ç¯å¢ƒå¼€å§‹ã€‚æˆ‘ä»¬å°†æŠŠæ‰€æœ‰ä»£ç å†™åœ¨ä¸€ä¸ª<code>main.py</code>æ–‡ä»¶ä¸­:</p>
<pre>$ mkdir fastapi-tg
$ cd fastapi-tg
$ python3 -m venv venv
$ source venv/bin/activate # For Linux and Mac
$ venv\Scripts\activate # For Windows
(venv) $ pip install fastapi uvicorn pyngrok httpx
</pre>
<h2>ä»ç”µæŠ¥è·å– bot å‡­è¯</h2>
<p>ä¸ºäº†è®©ä¿¡æ¯å‘é€ç»™æˆ‘ä»¬å¹¶è¢«æˆ‘ä»¬æ¥æ”¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›å¯ç¼–ç¨‹çš„ä¸œè¥¿ã€‚è¿™å°±æ˜¯ç”µæŠ¥æœºå™¨äººçš„ç”¨æ­¦ä¹‹åœ°ã€‚æœºå™¨äººæ˜¯ç”µæŠ¥ä¿¡æ¯å¹³å°çš„å¯ç¼–ç¨‹èŠå¤©æœºå™¨äººã€‚</p>
<p>ç”µæŠ¥æœºå™¨äººå°†æœ‰ä¸€ä¸ª<code>BOT_TOKEN</code>ï¼Œè¿™æ˜¯æœºå™¨äººçš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚è¦ä¸º Telegram åˆ›å»ºä¸€ä¸ªæœºå™¨äººï¼Œæˆ‘ä»¬éœ€è¦è·å¾—<code>BOT_TOKEN</code>ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†é€šè¿‡ç”µæŠ¥ä¸å¦ä¸€ä¸ªæœºå™¨äººå¯¹è¯ï¼Œ<a href="https://t.me/BotFather" target="_blank" rel="noopener">æœºå™¨äººçˆ¶äº²</a>ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å…¥<code>/newbot</code>å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æœºå™¨äººã€‚æˆ‘ä»¬è¿˜éœ€è¦è¾“å…¥æœºå™¨äººçš„åç§°å’Œæ˜¾ç¤ºåç§°ã€‚</p>
<p><img data-attachment-id="31812" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/creating-new-bot/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png" data-orig-size="647,488" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Creating a new bot" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot-300x226.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png" decoding="async" class="aligncenter size-full wp-image-31812 jetpack-lazy-image" src="../Images/09be6fbab991231413f4184f338a6eb0.png" alt="Creating a New Bot" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png 647w, https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot-300x226.png 300w" data-lazy-sizes="(max-width: 647px) 100vw, 647px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31812" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/creating-new-bot/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png" data-orig-size="647,488" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Creating a new bot" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot-300x226.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31812" src="../Images/09be6fbab991231413f4184f338a6eb0.png" alt="Creating a New Bot" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png 647w, https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot-300x226.png 300w" sizes="(max-width: 647px) 100vw, 647px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/creating-new-bot.png"/></noscript>
<p>å®Œæˆè¿™äº›æ­¥éª¤åï¼Œæˆ‘ä»¬å°†æ”¶åˆ°<code>BOT_TOKEN</code>ã€‚ä¸€æ—¦æœ‰äº†å®ƒï¼Œå°±åœ¨<code>terminal/cmd</code>ä¸­å°†å®ƒè®¾ç½®ä¸ºç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬èŠ‚ç»“æŸæ—¶å®Œæˆã€‚</p>
<p>ç°åœ¨ï¼Œé€šè¿‡æ‰§è¡Œ<code>/start</code>å‘½ä»¤å¯åŠ¨æ‚¨çš„æœºå™¨äººã€‚</p>
<p>ä¸€æ—¦æˆ‘ä»¬æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªç”µæŠ¥æœºå™¨äººï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è·å¾—ä¸€ä¸ª<code>CHAT_ID</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”µæŠ¥ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œæ¯ä¸ªç”µæŠ¥ç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªã€‚</p>
<p>è¦è·å¾—<code>CHAT_ID</code>ï¼Œåœ¨ Telegram ä¸­æ‰“å¼€ä¸<a href="https://t.me/JsonDumpBot" target="_blank" rel="noopener"> <strong> Json Dump Bot </strong> </a>çš„èŠå¤©å¯¹è¯ã€‚<code>/start</code>å‘½ä»¤æœ¬èº«ä¼šç»™ä½ ä¸€ä¸ªæ–‡æœ¬å½¢å¼çš„ JSON å¯¹è±¡ã€‚å®ƒçœ‹èµ·æ¥ç±»ä¼¼äºè¿™æ ·:</p>
<pre>{
  "update_id": 143931094,
  "message": {
    "message_id": 155844,
    "from": {
      "id": 123456789, //this is the Chat_ID of a telegram user
      "is_bot": false,
      "first_name": "&lt;name&gt;",
      "username": "&lt;username&gt;"
    },
    "chat": {
      "id": 123456789, //this is the Chat_ID of a telegram user
      "first_name": "&lt;name&gt;",
      "username": "&lt;username&gt;",
      "type": "private"
    },
    "date": 1575035172,
    "text": "/start",
    "entities": [
      {
        "offset": 0,
        "length": 6,
        "type": "bot_command"
      }
    ]
  }
}
</pre>
<p>æˆ‘ä»¬å¯ä»¥ä»<code>id</code>é”®å¾—åˆ°<code>CHAT_ID</code>ã€‚ä¸€æ—¦æˆ‘ä»¬æœ‰äº†<code>TOKEN</code>å’Œ<code>CHAT_ID</code>ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒä»¬ä½œä¸ºç¯å¢ƒå˜é‡æ·»åŠ åˆ°æˆ‘ä»¬çš„æœ¬åœ°ä¼šè¯ä¸­ã€‚</p>
<p>åœ¨ç»ˆç«¯/å‘½ä»¤æç¤ºç¬¦ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p>
<pre># for linux/mac
$ export TOKEN=&lt;bot_token&gt;
$ export CHAT_ID=&lt;chat_id&gt;

# for windows
$ set TOKEN=&lt;bot_token&gt;
$ set CHAT_ID=&lt;chat_id&gt;
</pre>
<p>ä¸€æ—¦æ‚¨åŠ è½½äº†ç¯å¢ƒå˜é‡ï¼Œè®©æˆ‘ä»¬ç¼–å†™æˆ‘ä»¬çš„æœåŠ¡å™¨</p>
<h2>ç”¨ fastagi åˆ›å»ºæœåŠ¡å™¨</h2>
<p>æˆ‘ä»¬å°†ä»¥â€œä½ å¥½ï¼Œä¸–ç•Œâ€å¼€å§‹å¸¦æœ‰ FastAPI çš„ç«¯ç‚¹ã€‚FastAPI æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„ Python web æ¡†æ¶ï¼Œåœ¨è¿‡å»çš„å‡ ä¸ªæœˆé‡Œå¹¿å—æ¬¢è¿ã€‚</p>
<p>å®ƒæ”¯æŒå¼‚æ­¥æ“ä½œï¼Œå¹¶åŸºäº<a href="https://docs.python.org/3/library/typing.html" target="_blank" rel="noopener"> Python ç±»å‹æç¤º</a>å’Œ<a href="https://github.com/OAI/OpenAPI-Specification" target="_blank" rel="noopener"> OpenAPI </a>ï¼Œè¿™æ˜¯ API çš„ä¸€ä¸ªè§„èŒƒã€‚æˆ‘ä»¬è¿˜åœ¨<code>/docs</code>å’Œ<code>/redoc</code>ç«¯ç‚¹è·å–æ–‡æ¡£ã€‚</p>
<p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„â€œHello Worldâ€ç«¯ç‚¹ï¼Œå®ƒè¿”å›ä¸€ä¸ªä½œä¸º url å‚æ•°ä¼ é€’çš„<code>name</code>:</p>
<pre># main.py

from fastapi import FastAPI

app = FastAPI()

@app.get("/{name}")
async def helloname(name:str):
    """
    Returns a Hello to the User with a wave emoji
    """
    return f"Hello {name} ğŸ‘‹"
</pre>
<p>æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¦æœ‰ FastAPI çš„ç®€å•çš„â€œHello Worldâ€åº”ç”¨ç¨‹åºã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°†ç«¯ç‚¹æŒ‡å®šä¸º<code>/</code>ã€‚è¿™ä¸ªç«¯ç‚¹æœ‰ä¸€ä¸ª URL å‚æ•°ï¼Œæˆ‘ä»¬å°†å…¶æŒ‡å®šä¸º<code>name</code>ã€‚</p>
<p>ä¸ºäº†è¿è¡ŒæœåŠ¡å™¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ ASGI(å¼‚æ­¥æœåŠ¡å™¨ç½‘å…³æ¥å£)æœåŠ¡å™¨ã€‚</p>
<p>åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨æœåŠ¡å™¨:</p>
<pre>$ uvicorn main:app --reload --port 9000
</pre>
<p>è¿™å°†åœ¨<code>port 9000</code>å¯åŠ¨æˆ‘ä»¬çš„ FastAPI æœåŠ¡å™¨ã€‚å¦‚æœæˆ‘ä»¬å¯¼èˆªåˆ°<code><a href="http://localhost:9000/docs" rel="nofollow">http://localhost:9000/docs</a></code>ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ç”±<a href="https://swagger.io/" target="_blank" rel="noopener"> Swagger </a>è‡ªåŠ¨ç”Ÿæˆçš„äº¤äº’æ–‡æ¡£ã€‚</p>
<p><img data-attachment-id="31813" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/swagger-documentation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png" data-orig-size="730,144" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Swagger documentation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation-300x59.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png" decoding="async" class="aligncenter size-full wp-image-31813 jetpack-lazy-image" src="../Images/4356eda5eaafe7865e8fdfee460d91f9.png" alt="Swagger Documentation" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation-300x59.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31813" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/swagger-documentation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png" data-orig-size="730,144" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Swagger documentation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation-300x59.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31813" src="../Images/4356eda5eaafe7865e8fdfee460d91f9.png" alt="Swagger Documentation" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation-300x59.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/swagger-documentation.png"/></noscript>
<p>å¦‚æœæˆ‘ä»¬å¯¼èˆªåˆ°<code><a href="http://localhost:9000/redoc" rel="nofollow">http://localhost:9000/redoc</a></code>ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æ›´å¤šä½¿ç”¨ redoc è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£ã€‚</p>
<p><img data-attachment-id="31814" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/redoc-documentation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png" data-orig-size="730,339" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Redoc documentation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation-300x139.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png" decoding="async" class="aligncenter size-full wp-image-31814 jetpack-lazy-image" src="../Images/c4ba842b96bd52eccec6cfabfb6e240d.png" alt="Redoc Documentation" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation-300x139.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31814" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/redoc-documentation/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png" data-orig-size="730,339" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Redoc documentation" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation-300x139.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31814" src="../Images/c4ba842b96bd52eccec6cfabfb6e240d.png" alt="Redoc Documentation" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation-300x139.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/redoc-documentation.png"/></noscript>
<p>å¦‚æœæˆ‘ä»¬å°è¯•ç”¨<a href="https://curl.se/" target="_blank" rel="noopener"> curl </a>æˆ–<a href="https://httpie.io" target="_blank" rel="noopener"> Httpie </a>è·å–ç«¯ç‚¹ï¼Œç»“æœå°†æ˜¯è¿™æ ·:</p>
<p><img data-attachment-id="31815" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/server-response/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png" data-orig-size="422,352" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Server response" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response-300x250.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png" decoding="async" class="aligncenter size-full wp-image-31815 jetpack-lazy-image" src="../Images/528d9227295ff82a2bffc6607970efd1.png" alt="Server Response" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png 422w, https://blog.logrocket.com/wp-content/uploads/2021/01/server-response-300x250.png 300w" data-lazy-sizes="(max-width: 422px) 100vw, 422px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31815" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/server-response/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png" data-orig-size="422,352" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Server response" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response-300x250.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31815" src="../Images/528d9227295ff82a2bffc6607970efd1.png" alt="Server Response" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png 422w, https://blog.logrocket.com/wp-content/uploads/2021/01/server-response-300x250.png 300w" sizes="(max-width: 422px) 100vw, 422px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/server-response.png"/></noscript>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¼–å†™æ¥æ”¶ webhooks å’Œå‘é€æ¶ˆæ¯çš„æœåŠ¡å™¨ã€‚æˆ‘ä»¬çš„æœåŠ¡å™¨å°†æ‰§è¡Œä»¥ä¸‹ä»»åŠ¡:</p>
<ul>
<li>ä» GitHub æ¥æ”¶ webhooks</li>
<li>å¤„ç† webhook è´Ÿè½½å¹¶è½¬æ¢ä¸ºæ¶ˆæ¯</li>
<li>é€šè¿‡ç”µæŠ¥å°†æ¶ˆæ¯å‘é€ç»™ç”¨æˆ·</li>
</ul>
<h2>ä» GitHub æ¥æ”¶ webhooks</h2>
<p>Webhooks æ˜¯ä¸€ä¸ªæœåŠ¡å™¨åœ¨ä¸€ä¸ªåŠ¨ä½œå‘ç”Ÿæ—¶å‘é€ç»™å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„æœ‰æ•ˆè½½è·å’Œä¿¡æ¯ã€‚é€šå¸¸ webhook çš„æœ‰æ•ˆè½½è·æ˜¯ JSON æ ¼å¼çš„ã€‚</p>
<p>å¦‚æœå­˜å‚¨åº“ä¸­å‘ç”Ÿäº†æŸä¸ªåŠ¨ä½œï¼ŒGitHub ä¼šå‘æŒ‡å®šçš„ URL å‘é€ä¸€ä¸ª webhookã€‚æˆ‘ä»¬å°†ç¼–å†™æˆ‘ä»¬çš„æœåŠ¡å™¨æ¥æ¥æ”¶è¿™äº› webhooks å¹¶å¤„ç†å®ƒä»¬ï¼Œç„¶ååœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ä¸­ä¸ºæœåŠ¡å™¨æ·»åŠ æ›´å¤šçš„åŠŸèƒ½ã€‚</p>
<p>ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†åªå¤„ç†<code>star</code>å’Œ<code>pull_request</code> GitHub äº‹ä»¶ã€‚å½“å­˜å‚¨åº“è¢«å¯åŠ¨æ—¶ä¼šè§¦å‘<code>star</code>äº‹ä»¶ï¼Œå½“æ‰“å¼€æˆ–å…³é—­ä¸€ä¸ªæ‹‰è¯·æ±‚æ—¶ä¼šè§¦å‘<code>pull_request</code>äº‹ä»¶ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äº<a href="https://docs.github.com/en/free-pro-team@latest/developers/webhooks-and-events/webhook-events-and-payloads#pull_request" target="_blank" rel="noopener"> GitHub æ‹‰è¯·æ±‚çš„ä¿¡æ¯</a>ã€‚</p>
<pre># main.py
from fastapi import FastAPI,Request
import os

app=FastAPI()

TOKEN = os.getenv("TOKEN")  # Telegram Bot API Key
CHAT_ID = os.getenv("CHAT_ID")  # Telegram Chat ID

async def sendTgMessage():
# TODO

@app.post("/hook")
async def recWebHook(req: Request):
    """
    Receive the Webhook and process the Webhook Payload to get relevant data
    Refer https://developer.github.com/webhooks/event-payloads for all GitHub Webhook Events and Payloads
    """
    body = await req.json()
    event = req.headers.get("X-Github-Event")
    if event == "star":  # check if the event is a star
        nos_stars = body\["repository"\]["stargazers_count"]
        starrer_username = body\["sender"\]["login"]
        repo_url = body\["repository"\]["html_url"]
        repo_name = body\["repository"\]["name"]
        message = f"{starrer_username} has starred the \[{repo_name}\]({repo_url}). \n\n The Total Stars are {nos_stars}"
        await sendTgMessage(message)
    elif event == "pull_request":  # check if event is a pull request
        pr_number = body["number"]
        if body\["pull_request"\]["merged"] == True:
            pr_action = "merged"
        pr_action = body["action"]
        pr_title = body\["pull_request"\]["title"]
        pr_desc = body\["pull_request"\]["body"]
        pr_login = body\["sender"\]["login"]
        pr_login_url = body\["sender"\]["html_url"]
        pr_url = body\["pull_request"\]["html_url"]
        message = f"Pull Request(\[{pr_number}\]({pr_url})) {pr_action} by \[{pr_login}\]({pr_login_url}).\n\n Title: *{pr_title}* \n\n Description: **{pr_desc}**"
        await sendTgMessage(message)
</pre>
<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ç¼–å†™äº†<code>/hook</code>ç«¯ç‚¹æ¥æ¥æ”¶æ¥è‡ª GitHub çš„ webhookï¼Œå¹¶å°† web hook å¤„ç†æˆå°†é€šè¿‡ Telegram å‘é€çš„æ¶ˆæ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ FastAPI çš„<code>Request</code>ç±»æ¥æ”¶ webhook æœ‰æ•ˆè´Ÿè½½åŠå…¶å¤´éƒ¨ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ£€æŸ¥åŠ¨ä½œæ˜¯ä»€ä¹ˆã€‚å¦‚æœæ˜¯ star æˆ– pull è¯·æ±‚äº‹ä»¶ï¼Œæˆ‘ä»¬å°†ä¸ºè¯¥ç‰¹å®šäº‹ä»¶ç”Ÿæˆæ¶ˆæ¯ã€‚æˆ‘ä»¬ä» JSON ä¸»ä½“ä¸­è·å¾—æ‰€éœ€çš„æ•°æ®ã€‚JSON è¢«è§£æä¸º Python å­—å…¸ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨å­—å…¸é”®ä½œä¸ºç´¢å¼•ï¼Œå¹¶è·å–è¿™äº›é”®çš„å€¼ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å­—å…¸çš„<code><a href="https://www.programiz.com/python-programming/methods/dictionary/get" target="_blank" rel="noopener">get()</a></code>æ–¹æ³•æ¥åšåŒæ ·çš„äº‹æƒ…ã€‚</p>
<p>å¯¹äº star äº‹ä»¶ï¼Œæˆ‘ä»¬æ¥æ”¶å½“å‰çš„æ˜Ÿæ•°ã€ä¸ºå­˜å‚¨åº“åŠ æ˜Ÿçš„äººçš„ GitHub ç”¨æˆ·åå’Œå­˜å‚¨åº“çš„ URLã€‚å¯¹äºæ‹‰è¯·æ±‚ï¼Œæˆ‘ä»¬è¿˜å°†è·å–æ‹‰è¯·æ±‚çš„æ ‡é¢˜å’Œä¸»ä½“ï¼Œå¹¶æ£€æŸ¥æ‹‰è¯·æ±‚æ˜¯å¦è¢«åˆå¹¶ã€‚</p>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ‰©å±•åˆ°è®¸å¤šå…¶ä»–äº‹ä»¶ï¼Œå¦‚é—®é¢˜å’Œè¯„è®ºï¼Œå‡ ä¹æ‰€æœ‰çš„äº‹ä»¶éƒ½æ˜¯ç±»ä¼¼çš„æ¨¡å¼ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†ç¼–å†™<code>sendTgMessage()</code>æ–¹æ³•æ¥å°†ç”Ÿæˆçš„å›¾åƒå‘é€åˆ° telegramã€‚</p>
<h3>å‘ç”µæŠ¥å‘é€ä¿¡æ¯</h3>
<p>Telegram æœ‰ä¸€ä¸ªå¼ºå¤§çš„ bot APIã€‚å®ƒæœ‰å¤§é‡çš„åŒ…è£…å™¨ï¼Œä½†æ˜¯åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ HTTP API é€šè¿‡ä¸Šé¢åˆ›å»ºçš„ bot å¼‚æ­¥å‘é€æ¶ˆæ¯ã€‚</p>
<pre># main.py
import httpx

async def sendTgMessage(message:str):
    """
    Sends the Message to telegram with the Telegram BOT API
    """
    tg_msg = {"chat_id": CHAT_ID, "text": message, "parse_mode": "Markdown"}
    API_URL = f"https://api.telegram.org/bot{TOKEN}/sendMessage"
    async with httpx.AsyncClient() as client:
        await client.post(API_URL, json=tg_msg)
</pre>
<p>è¿™é‡Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†æ¶ˆæ¯ä½œä¸ºå‚æ•°ã€‚Telegram éå¸¸æ”¯æŒæ¶ˆæ¯ä¸­çš„ Markdown å’Œ HTML æ ¼å¼ã€‚è®©æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨é™ä»·æ ¼å¼é€‰é¡¹ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äºç”µæŠ¥ä¿¡æ¯çš„<a href="https://core.telegram.org/bots/api#formatting-options" target="_blank" rel="noopener">æ ¼å¼é€‰é¡¹ã€‚</a></p>
<p>Telegram Bot API éœ€è¦ JSON å½¢å¼çš„æ•°æ®ä½œä¸ºå¯¹<code>sendMessage</code>ç«¯ç‚¹çš„<code>POST</code>è¯·æ±‚çš„ä¸»ä½“ã€‚JSON ä¸»ä½“éœ€è¦ä»¥ä¸‹é”®æ¥å‘é€æ¶ˆæ¯:</p>
<ul>
<li><code>CHAT_ID</code>é”®æ˜¯ç”¨æˆ·çš„èŠå¤© IDï¼Œæœºå™¨äººåº”è¯¥åœ¨é‚£é‡Œå‘é€æ¶ˆæ¯</li>
<li><code>text</code>é”®è¡¨ç¤ºæ¶ˆæ¯åº”è¯¥æ˜¯ä»€ä¹ˆ</li>
<li><code>parse_mode</code>æ˜¯æ¶ˆæ¯çš„æ ¼å¼é€‰é¡¹</li>
<li>ä½ å¯ä»¥åœ¨<a href="https://core.telegram.org/bots/api#sendmessage" target="_blank" rel="noopener">æ–‡æ¡£</a>ä¸­è¯»åˆ°å…³äº<code>sendMessage</code> API æ–¹æ³•çš„å…¶ä»–é”®ã€‚</li>
</ul>
<p>æˆ‘ä»¬ä½¿ç”¨ Python å­—å…¸ä½œä¸º<code>POST</code>è¯·æ±‚ä½“ï¼Œå¹¶ç”¨<a href="https://www.python-httpx.org/" target="_blank" rel="noopener"> httpx </a>å‘é€è¯·æ±‚ã€‚Httpx æ˜¯ä¸€ä¸ªå¼‚æ­¥ HTTP åº“ï¼Œå…·æœ‰ç±»ä¼¼äº Python è¯·æ±‚åº“çš„ APIã€‚</p>
<p>ä¸€æ—¦æ¶ˆæ¯è¢«å‘é€ï¼Œæ— è®ºæ¶ˆæ¯æ˜¯å¦è¢«å‘é€ï¼Œæˆ‘ä»¬éƒ½ä¼šæ”¶åˆ°ä¸€ä¸ª JSON å“åº”ã€‚</p>
<h2>è¿è¡Œå’Œæµ‹è¯•æœåŠ¡å™¨</h2>
<p>è®©æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„æœåŠ¡å™¨ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„æºä»£ç :</p>
<pre># main.py
from fastapi import FastAPI, Request
import os
import httpx

app = FastAPI()

TOKEN = os.getenv("TOKEN")  # Telegram Bot API Key
CHAT_ID = os.getenv("CHAT_ID")  # Telegram Chat ID

async def sendTgMessage(message: str):
    """
    Sends the Message to telegram with the Telegram BOT API
    """
    print(message)
    tg_msg = {"chat_id": CHAT_ID, "text": message, "parse_mode": "Markdown"}
    API_URL = f"https://api.telegram.org/bot{TOKEN}/sendMessage"
    async with httpx.AsyncClient() as client:
        await client.post(API_URL, json=tg_msg)

@app.post("/hook")
async def recWebHook(req: Request):
    """
    Receive the Webhook and process the Webhook Payload to get relevant data
    Refer https://developer.github.com/webhooks/event-payloads for all GitHub Webhook Events and Payloads
    """
    body = await req.json()
    print(body)
    event = req.headers.get("X-Github-Event")
    if event == "star":  # check if the event is a star
        nos_stars = body\["repository"\]["stargazers_count"]
        starrer_username = body\["sender"\]["login"]
        repo_url = body\["repository"\]["html_url"]
        repo_name = body\["repository"\]["name"]
        message = f"{starrer_username} has starred the \[{repo_name}\]({repo_url}). \n\n The Total Stars are {nos_stars}"
        await sendTgMessage(message)
    elif event == "pull_request":  # check if event is a pull request
        pr_number = body["number"]
        if body\["pull_request"\]["merged"] == True:
            pr_action = "merged"
        pr_action = body["action"]
        pr_title = body\["pull_request"\]["title"]
        pr_desc = body\["pull_request"\]["body"]
        pr_login = body\["sender"\]["login"]
        pr_login_url = body\["sender"\]["html_url"]
        pr_url = body\["pull_request"\]["html_url"]
        message = f"Pull Request(\[{pr_number}\]({pr_url})) {pr_action} by \[{pr_login}\]({pr_login_url}).\n\n Title: {pr_title} \n\n Description: {pr_desc}"
        await sendTgMessage(message)
</pre>
<p>è¦è¿è¡Œæˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œè¯·åœ¨å‘½ä»¤è¡Œ/ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚ç¡®ä¿æ‚¨åœ¨è™šæ‹Ÿç¯å¢ƒä¸­:</p>
<pre>$ uvicorn main:app --reload --port 9000
</pre>
<p>è¿™å°†åœ¨ç«¯å£ 9000 ä¸Šæ‰“å¼€æˆ‘ä»¬çš„æœåŠ¡å™¨ã€‚ä¸ºäº†ä» GitHub æ¥æ”¶æ•°æ®åˆ°æˆ‘ä»¬çš„æœ¬åœ°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¿…é¡»å°†æˆ‘ä»¬çš„æœ¬åœ°æœåŠ¡å™¨æš´éœ²ç»™äº’è”ç½‘ï¼Œè¿™å°±æ˜¯<a href="https://ngrok.com/" target="_blank" rel="noopener"> ngrok </a>çš„ç”¨æ­¦ä¹‹åœ°ã€‚æˆ‘ä»¬å·²ç»ç”¨ pip å®‰è£…äº†<a href="https://pypi.org/project/pyngrok/" target="_blank" rel="noopener"> Pyngrok </a>ã€‚Pyngrok æ˜¯ ngrok çš„ Python åŒ…è£…å™¨ï¼Œæœ‰è‡ªå·±çš„äºŒè¿›åˆ¶æ–‡ä»¶ç”¨äºåˆ†å‘ã€‚</p>
<p>ä¸ºäº†éš§é“æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬éœ€è¦è®©æˆ‘ä»¬çš„æœåŠ¡å™¨è¿è¡Œã€‚æ‰“å¼€å¦ä¸€ä¸ªç»ˆç«¯/å‘½ä»¤è¡Œçª—å£æˆ–é€‰é¡¹å¡ï¼Œå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒã€‚ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p>
<pre>$ ngrok http 9000
</pre>
<p>æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡º:</p>
<p><img data-attachment-id="31816" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/ngrok-sample-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png" data-orig-size="730,239" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Ngrok sample output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output-300x98.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png" decoding="async" class="aligncenter size-full wp-image-31816 jetpack-lazy-image" src="../Images/f682731368f848e5c73fa0cde1465270.png" alt="Ngrok Sample Output" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output-300x98.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31816" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/ngrok-sample-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png" data-orig-size="730,239" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Ngrok sample output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output-300x98.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31816" src="../Images/f682731368f848e5c73fa0cde1465270.png" alt="Ngrok Sample Output" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output-300x98.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/ngrok-sample-output.png"/></noscript>
<p>å°†ä¼šæœ‰ä¸¤ä¸ª URL æš´éœ²æˆ‘ä»¬çš„æœ¬åœ°æœåŠ¡å™¨ã€‚æˆ‘ä»¬åªéœ€è¦å¸¦æœ‰å‰ç¼€<code>https</code>æˆ–ç¬¬äºŒä¸ª URL çš„é‚£ä¸ªã€‚</p>
<p>ä¸‹ä¸€æ­¥æ˜¯å‘Šè¯‰ GitHub å°† webhooks å‘é€åˆ°è¿™ä¸ª URLã€‚</p>
<h3>è¿æ¥åˆ° GitHub</h3>
<p>è¦å°†æˆ‘ä»¬çš„æœåŠ¡å™¨è¿æ¥åˆ° GitHubï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå­˜å‚¨åº“ã€‚è¿™å¯ä»¥æ˜¯æ–°çš„å­˜å‚¨åº“ï¼Œä¹Ÿå¯ä»¥æ˜¯ç°æœ‰çš„å­˜å‚¨åº“ã€‚å¦‚æœæ‚¨æƒ³è¦åˆ›å»ºæ–°çš„å­˜å‚¨åº“ï¼Œè¯·å¯¼èˆªåˆ°<a href="https://github.new" rel="nofollow"> https://github.new </a>æ¥åˆ›å»ºæ–°çš„å­˜å‚¨åº“ã€‚</p>
<p>è¦è®¾ç½® webhooksï¼Œè¯·è½¬åˆ°æ‚¨çš„å­˜å‚¨åº“ä¸­çš„<strong>è®¾ç½®</strong>é€‰é¡¹å¡ï¼Œå¹¶é€‰æ‹©<strong> webhooks éƒ¨åˆ†</strong>ã€‚æŒ‰ä¸‹<code>Add Webhook</code>æŒ‰é’®æ·»åŠ ä¸€ä¸ªæ–°çš„ç½‘é¡µæŒ‚é’©ã€‚ç„¶åä½ ä¼šè¢«è¦æ±‚è¾“å…¥ä½ çš„ GitHub å¯†ç ã€‚</p>
<p>ä¸€æ—¦å®Œæˆï¼Œæ·»åŠ æˆ‘ä»¬ä» ngrok æ”¶åˆ°çš„ URL(ä¸è¦å¿˜è®°æ·»åŠ <code>/hook</code>ä½œä¸º URL çš„åç¼€)ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬æ¥æ”¶ webhooks çš„ç«¯ç‚¹ã€‚å°†<code>content-type</code>æ”¹ä¸º<code>application/json</code>ã€‚ç„¶åï¼Œé€‰æ‹©æ‚¨æƒ³è¦è·å–çš„ webhook äº‹ä»¶ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦<code>star</code>å’Œ<code>pull_request</code>äº‹ä»¶ã€‚æœ€åï¼Œä¿å­˜è¿™äº›æ›´æ”¹ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªç®€çŸ­çš„è§†é¢‘ã€‚</p>
<p><img data-attachment-id="31818" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/video-walkthrough/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough.gif" data-orig-size="730,365" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Video walkthrough" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough-300x150.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough.gif" decoding="async" class="aligncenter wp-image-31818 size-full jetpack-lazy-image" src="../Images/d64cfb8cf90db4d7a86039918c66a29d.png" alt="Video Walkthrough" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough.gif?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough.gif"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31818" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/video-walkthrough/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough.gif" data-orig-size="730,365" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Video walkthrough" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough-300x150.gif" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough.gif" decoding="async" loading="lazy" class="aligncenter wp-image-31818 size-full" src="../Images/d64cfb8cf90db4d7a86039918c66a29d.png" alt="Video Walkthrough" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/video-walkthrough.gif"/></noscript>
<p>ä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„æœºå™¨äººæ­£åœ¨å·¥ä½œï¼Œå¯åŠ¨å­˜å‚¨åº“ã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬å°†ä»æˆ‘ä»¬åˆ›å»ºçš„æœºå™¨äººé‚£é‡Œæ”¶åˆ°ä¸€æ¡å‘å¾€æŒ‡å®š<code>CHAT_ID</code>çš„ç”µæŠ¥æ¶ˆæ¯ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹æ¶ˆæ¯ã€‚</p>
<p><img data-attachment-id="31817" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/sample-message/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png" data-orig-size="321,70" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sample message" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message-300x65.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png" decoding="async" class="aligncenter size-full wp-image-31817 jetpack-lazy-image" src="../Images/6fcd01467b2160310740c4dfdeb1ebb7.png" alt="Sample Message" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png 321w, https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message-300x65.png 300w" data-lazy-sizes="(max-width: 321px) 100vw, 321px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="31817" data-permalink="https://blog.logrocket.com/using-fastapi-to-get-updates-from-github-to-telegram/sample-message/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png" data-orig-size="321,70" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Sample message" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message-300x65.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-31817" src="../Images/6fcd01467b2160310740c4dfdeb1ebb7.png" alt="Sample Message" srcset="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png 321w, https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message-300x65.png 300w" sizes="(max-width: 321px) 100vw, 321px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/01/sample-message.png"/></noscript>
<p>æ­å–œä½ ï¼æˆ‘ä»¬çš„æœåŠ¡å™¨æ­£åœ¨å·¥ä½œå¹¶å‘ Telegram å‘é€æ¶ˆæ¯ã€‚å¤šé…·å•Šã€‚</p>
<p>æ‚¨å¯ä»¥æ‰©å±• webhook å¤„ç†æ¥è·å¾—å…³äºé—®é¢˜ã€è¯„è®ºã€æ¨é€ç­‰çš„è¯¦ç»†ä¿¡æ¯ã€‚GitHub æ–‡æ¡£ä¸­å¾ˆå¥½åœ°è®°å½•äº†æ‰€æœ‰çš„ webhook äº‹ä»¶ã€‚æ­¤å¤–ï¼Œç”µæŠ¥æœºå™¨äºº API æ–‡æ¡£æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‚è€ƒã€‚</p>
<p>ä½ å¯ä»¥åœ¨<a href="https://github.com/athul/Telegram-GH-Webhooks" target="_blank" rel="noopener"> GitHub </a>æ‰¾åˆ°å®Œæ•´çš„æºä»£ç ã€‚</p>
<h2>ä½¿ç”¨ GitHub å’Œ Telegram çš„åç»­æ­¥éª¤</h2>
<p>å½“ç„¶ï¼Œæ‚¨å¯ä»¥è¿›ä¸€æ­¥æ‰©å±•è¿™ä¸ªé¡¹ç›®ï¼Œä»¥è·å¾—å…³äºé—®é¢˜ã€æ–°çš„æ¨é€å’Œæ‹‰å–è¯·æ±‚å®¡æŸ¥ä»¥åŠä»»ä½•å…¶ä»– GitHub webhook äº‹ä»¶çš„ä¿¡æ¯ã€‚ä½†æ˜¯è¦ç¡®ä¿åœ¨ GitHub webhook è®¾ç½®ä¸­æ›´æ”¹æ‚¨éœ€è¦çš„äº‹ä»¶ã€‚</p>
<p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ bot å‘<strong>é¢‘é“/ç»„</strong>å‘é€æ¶ˆæ¯â€”â€”åªéœ€å°† bot æ·»åŠ åˆ°é¢‘é“/ç»„ï¼Œå¹¶ç”¨<a href="https://gist.github.com/mraaroncruz/e76d19f7d61d59419002db54030ebe35" target="_blank" rel="noopener">é¢‘é“/ç»„ ID </a>æ›´æ”¹<code>CHAT_ID</code>ç¯å¢ƒå˜é‡ã€‚</p>
<h2>ç»“è®º</h2>
<p>æˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¦‚ä½•ç”¨ FastAPI å’Œ Python åˆ¶ä½œ REST APIï¼Œåˆ›å»º Telegram Botï¼Œä»¥åŠç”¨ ngrok å°†æœ¬åœ°æœåŠ¡å™¨è¿æ¥åˆ° GitHubã€‚æ„Ÿè°¢é˜…è¯»ï¼</p>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>