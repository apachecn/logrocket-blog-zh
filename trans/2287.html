<html>
<head>
<title>Understanding Flutterâ€™s Timer class and Timer.periodic - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>äº†è§£ Flutter çš„å®šæ—¶å™¨ç±»å’Œ Timer.periodic - LogRocket åšå®¢</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.logrocket.com/understanding-flutter-timer-class-timer-periodic/#0001-01-01">https://blog.logrocket.com/understanding-flutter-timer-class-timer-periodic/#0001-01-01</a></blockquote><div><article class="article-post">
<p>åœ¨æ„å»ºç§»åŠ¨åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯:åœ¨æŸä¸ªæŒç»­æ—¶é—´ä¹‹åï¼Œæˆ‘ä»¬å¿…é¡»æ‰§è¡Œä¸€é¡¹ä»»åŠ¡ã€‚è¿˜è®°å¾—åœ¨è¿›å…¥åº”ç”¨ç¨‹åºä¹‹å‰çœ‹åˆ°é—ªäº®çš„é—ªå±å—ï¼Ÿæˆ–è€…ï¼Œåœ¨ä¸€ä¸ªç¾é£Ÿåº”ç”¨ç¨‹åºä¸Šç‚¹äº†ä¸€ä¸ªå–œæ¬¢çš„èœåï¼Œä¸€ä¸ªæ”¾æ¾çš„å±å¹•ï¼Ÿ</p>
<p>æˆ–è€…ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¸€æ®µä»£ç åœ¨æŸä¸ªæŒç»­æ—¶é—´åé‡å¤æ‰§è¡Œï¼Œæ¯”å¦‚æ˜¾ç¤ºå¡«å……ä¸€æ¬¡æ€§å¯†ç çš„å‰©ä½™æ—¶é—´é™åˆ¶ï¼Œæˆ–è€…æ¯ç§’æ”¹å˜ä¸€ä¸ªå°éƒ¨ä»¶çš„é¢œè‰²ä»¥åˆ›å»ºä¸€ä¸ªæ¼‚äº®çš„åŠ¨ç”»ã€‚</p>
<p>ä¸ºäº†è§£å†³é¢¤æŒ¯åº”ç”¨ä¸­çš„è¿™äº›éœ€æ±‚ï¼Œæˆ‘ä»¬æ¨å‡ºäº†<code>Timer</code>çº§ã€‚å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä»¥ä¸‹å‡ ç‚¹ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å¦‚ä½•åœ¨æ‚¨è‡ªå·±çš„ Flutter åº”ç”¨ç¨‹åºä¸­å®ç°è¿™äº›åŠŸèƒ½:</p>
<ul>
<li>ä»€ä¹ˆæ˜¯<code>Timer</code>ç±»ï¼Œæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒ</li>
<li>å¦‚ä½•ç”¨<code>timer.periodic</code>åˆ›å»ºå‘¨æœŸæ€§å®šæ—¶å™¨</li>
<li>å¦‚ä½•åˆ›å»ºå¯é‡å¯å®šæ—¶å™¨</li>
<li>ä½¿ç”¨<code>Timer</code>ç±»çš„ä¾‹å­</li>
</ul>
<p>å°±è¿™æ ·ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</p>
<h2>ä»€ä¹ˆæ˜¯<code>Timer</code>ç±»ï¼Ÿ</h2>
<p>Flutter çš„<code>Timer</code>ç±»å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå€’è®¡æ—¶å™¨ã€‚åœ¨å…¶ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå®ƒåˆ†åˆ«ç»å†ä»¥ä¸‹çŠ¶æ€:</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªè®¡æ—¶å™¨</li>
<li>æ‰§è¡Œå›è°ƒ</li>
<li>è®¡æ—¶å™¨ç»“æŸ</li>
</ul>
<p>è¦ä½¿ç”¨å±äº Dart å¼‚æ­¥åº“çš„<a href="https://blog.logrocket.com/introduction-to-using-dart-in-flutter/">éƒ¨åˆ†çš„<code>Timer</code>ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ import è¯­å¥å¯¼å…¥å®ƒ:</a></p>
<pre class="language-dart hljs">import 'dart:async';
</pre>
<h3>åˆ›å»ºç®€å•çš„è®¡æ—¶å™¨</h3>
<p>ç°åœ¨ï¼Œè¦åˆ›å»ºä¸€ä¸ªç®€å•çš„ 3 ç§’é’Ÿè®¡æ—¶å™¨ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œå®ƒä¼šåœ¨æ‰§è¡Œåè§¦å‘ä¸€ä¸ªå›è°ƒ:</p>
<pre class="language-dart hljs">final timer = Timer(
  const Duration(seconds: 3),
  () {
    // Navigate to your favorite place
  },
);
</pre>
<p>ä¾‹å¦‚ï¼Œä¸€æ—¦å›è°ƒè§¦å‘ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·å¯¼èˆªåˆ°ä¸€ä¸ªæ–°çš„å±å¹•ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œå›è°ƒåªè§¦å‘ä¸€æ¬¡ã€‚</p>
<h3>åˆ›å»ºä¸€ä¸ªç®€å•çš„å‘¨æœŸæ€§å®šæ—¶å™¨</h3>
<p>ä½¿ç”¨<code>Timer.periodic</code>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåœ¨ç»™å®šæŒç»­æ—¶é—´åæ‰§è¡Œçš„é‡å¤è®¡æ—¶å™¨ã€‚å®šæœŸè®¡æ—¶å™¨ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œç›´åˆ°è¢«æ‰‹åŠ¨å–æ¶ˆã€‚Flutter æœ‰ä¸€ä¸ªä¸åŒçš„å·¥å‚æ–¹æ³•ï¼Œåä¸º<code>periodic</code>ï¼Œæ¥åˆ›å»ºè¿™æ ·ä¸€ä¸ªå®šæ—¶å™¨ã€‚</p>
<p>å®šæœŸè®¡æ—¶å™¨çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯æ˜¾ç¤ºæ—¶é—´æ•æ„Ÿæ“ä½œçš„å‰©ä½™æ—¶é—´ï¼Œæ¯”å¦‚åœ¨ 10 åˆ†é’Ÿå†…å®Œæˆæ”¯ä»˜ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œä»£ç ç”Ÿæˆä¸€ä¸ªæ¯ç§’è§¦å‘ä¸€æ¬¡å›è°ƒçš„è®¡æ—¶å™¨:</p>
<pre class="language-dart hljs">final periodicTimer = Timer.periodic(
  const Duration(seconds: 1),
  (timer) {
    // Update user about remaining time
  },
);
</pre>
<p>è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®šæœŸå®šæ—¶å™¨æ— é™æœŸä¿æŒæ´»åŠ¨çŠ¶æ€ã€‚</p>
<p>å¾ˆç®€å•ï¼Œä¸æ˜¯å—ï¼Ÿæ˜¯çš„ï¼Œä½†æ˜¯åœ¨å®é™…ç”¨ä¾‹ä¸­ä½¿ç”¨å®ƒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»å›ç­”å…¶ä»–é—®é¢˜:</p>
<ul>
<li>å¦‚ä½•å–æ¶ˆæ¿€æ´»çš„å®šæ—¶å™¨</li>
<li>å¦‚ä½•çŸ¥é“å®šæ—¶å™¨æ˜¯å¦ä»ç„¶æœ‰æ•ˆ</li>
<li>å¦‚ä½•çŸ¥é“è¿‡å»çš„æŒç»­æ—¶é—´</li>
</ul>
<h2>å¦‚ä½•ä½¿ç”¨<code>Timer</code>ç±»</h2>
<p><code>Timer</code>ç±»ç»™äº†æˆ‘ä»¬è®¸å¤šå…¶ä»–çš„é€‰é¡¹æ¥è½»æ¾åœ°ä½¿ç”¨å®ƒã€‚è®©æˆ‘ä»¬æ·±å…¥äº†è§£å¦‚ä½•ä½¿ç”¨è¿™äº›å…¶ä»–é€‰é¡¹ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•ä¸æ­£å¸¸å’Œå®šæœŸå®šæ—¶å™¨ä¸€èµ·å·¥ä½œã€‚</p>
<h3>å¦‚ä½•å–æ¶ˆæ¿€æ´»çš„å®šæ—¶å™¨</h3>
<p><code>Timer</code>ç±»æœ‰ä¸€ä¸ª<code>cancel()</code>æ–¹æ³•ï¼Œç”¨äºå–æ¶ˆä»»ä½•æ´»åŠ¨çš„è®¡æ—¶å™¨ã€‚å¯¹äºæ™®é€šçš„è®¡æ—¶å™¨ï¼Œè°ƒç”¨<code>cancel</code>ä¸ä¼šè°ƒç”¨å›è°ƒã€‚å¯¹äºå‘¨æœŸæ€§å®šæ—¶å™¨æ¥è¯´ï¼Œ<code>cancel</code>æ–¹æ³•å˜å¾—éå¸¸é‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»å®Œæˆå®šæ—¶å™¨:</p>
<pre class="language-dart hljs">final periodicTimer = Timer.periodic(
  const Duration(seconds: 1),
  (timer) {
    // Update user about remaining time
  },
);

final shouldStop = true; //No more tick-tock now! Please

if (shouldStop) {
  timer.cancel();
}
</pre>
<p>æ³¨æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„å¤šæ¬¡è°ƒç”¨<code>cancel</code>è€Œä¸ä¼šæœ‰ä»»ä½•å‰¯ä½œç”¨ï¼›è¿›ä¸€æ­¥çš„è°ƒç”¨å°†è¢«å¿½ç•¥ã€‚</p>
<h3>å¦‚ä½•çŸ¥é“ä¸€ä¸ªå®šæ—¶å™¨æ˜¯å¦ä»ç„¶æœ‰æ•ˆ</h3>
<p>å¦‚æœå›è°ƒæ²¡æœ‰è§¦å‘ï¼Œå¹¶ä¸”æˆ‘ä»¬æ²¡æœ‰æ˜¾å¼å–æ¶ˆå®ƒï¼Œé‚£ä¹ˆæ™®é€šçš„è®¡æ—¶å™¨è¢«è°ƒç”¨<code>active</code>ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ç‰¹åˆ«å–æ¶ˆå®šæœŸè®¡æ—¶å™¨ï¼Œå®ƒä»¬æ€»æ˜¯å¤„äºæ´»åŠ¨çŠ¶æ€:</p>
<pre class="language-dart hljs">final timer = Timer(
  const Duration(seconds: 3),
  () {
    // Navigate to your favorite place
  },
);

if (timer.isActive) {
  //Oh no!, it's taking longer than expected
}
</pre>
<h3>å¦‚ä½•çŸ¥é“æ—¶é—´æµé€äº†å¤šå°‘</h3>
<p>åˆ›å»ºä¸€ä¸ªæŒç»­æ—¶é—´ä¸º 1 ç§’çš„å®šæœŸè®¡æ—¶å™¨å°†åœ¨ä¸€åˆ†é’Ÿå†…æ»´ç­” 60 æ¬¡ã€‚è™½ç„¶æˆ‘ä»¬çŸ¥é“è¿™æœ¬è´¨ä¸Šæ˜¯å¯¹çš„ï¼Œä½†æˆ‘ä»¬æ€ä¹ˆèƒ½è‚¯å®šåœ°çŸ¥é“è¿™äº›æ•°å­—å‘¢ï¼Ÿ</p>
<p>è¿™å°±æ˜¯<code>tick</code>çš„ç”¨æ­¦ä¹‹åœ°ã€‚ä¸€ä¸ª<code>tick</code>å€¼ä»é›¶å¼€å§‹ï¼Œå¹¶ä¸”æ¯å½“å®šæ—¶å™¨äº‹ä»¶å‘ç”Ÿæ—¶é€’å¢ï¼›è¯¥å€¼æ˜¯åæ˜ ç»è¿‡çš„æŒç»­æ—¶é—´çš„è®¡æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸€ä¸ªæŒç»­æ—¶é—´ä¸º 10 ç§’çš„å‘¨æœŸæ€§å®šæ—¶å™¨åœ¨ä¸€åˆ†é’Ÿå†…å°†æœ‰ 6 ä¸ªäº‹ä»¶ï¼Œè€Œ<code>tick</code>å°†ç»™å‡ºç›¸å¯¹äºå½“å‰æ—¶é—´ç‚¹çš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŠåˆ†é’Ÿåï¼Œ<code>tick</code>å€¼å°†ä¸º<code>3</code>ï¼Œå¹¶åœ¨æ¯ä¸ªäº‹ä»¶ä¸Šç»§ç»­é€’å¢:</p>
<pre class="language-dart hljs">final periodicTimer = Timer.periodic(
  const Duration(seconds: 10),
  (timer) {
    // Update user about remaining time
  },
);

final howMuchTimeBuddy = periodicTimer.tick;
</pre>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæŒç»­æ—¶é—´ä¸º 10 ç§’çš„å‘¨æœŸæ€§å®šæ—¶å™¨ã€‚å¯¹äºä»»ä½•ç»™å®šçš„æ—¶é—´ç‚¹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨<code>periodicTimer.tick</code>å¾—åˆ°<code>tick</code>å€¼ã€‚</p>
<h3>å¦‚ä½•å®‰æ’å›ç”µ</h3>
<p><code>Timer</code>ç±»è¿˜æœ‰ä¸€ä¸ªæ›´æœ‰è¶£çš„ç”¨ä¾‹ã€‚ä½¿ç”¨<code>Timer</code>ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒåº¦ä¸€ä¸ªå›è°ƒï¼Œåœ¨å¼‚æ­¥æ¨¡å¼ä¸‹å°½å¿«æ‰§è¡Œã€‚ä¸ºæ­¤ï¼Œåªéœ€å¯åŠ¨ä¸€ä¸ªå¸¦æœ‰<code>zero</code>æŒç»­æ—¶é—´çš„è®¡æ—¶å™¨:</p>
<pre class="language-dart hljs">final zeroDurationTimer = Timer(
  Duration.zero,
  () {
    //Execute this callback ASAP but asynchronously
  },
);
</pre>
<p>è¿˜æœ‰ä¸€ä¸ªç›¸å½“äºä¸Šè¿°ä»£ç çš„ç®€ä¾¿æ–¹æ³•ï¼Œä½†æ›´ç®€æ´:</p>
<pre class="language-dart hljs">final zeroDurationTimer = Timer.run(() {
  //Execute this callback ASAP but asynchronously
});
</pre>
<h2>åœ¨ Flutter ä¸­åˆ›å»ºä¸€ä¸ªå¯é‡å¯çš„å®šæ—¶å™¨</h2>
<p>æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨<code>cancel()</code>æ–¹æ³•æ¥å–æ¶ˆ<code>Timer</code>ã€‚ç„¶è€Œï¼Œåœ¨<code>Timer</code>ç±»ä¸­æ²¡æœ‰ç›´æ¥çš„æ–¹æ³•æ¥é‡å¯åŒä¸€ä¸ªè®¡æ—¶å™¨ï¼Œé™¤éæˆ‘ä»¬é‡æ–°åˆ›å»ºè®¡æ—¶å™¨å®ä¾‹ã€‚</p>
<p>ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œ<a href="https://pub.dev/documentation/async/latest/async/RestartableTimer-class.html">æ—‹èˆå°±æœ‰äº†</a> <code><a href="https://pub.dev/documentation/async/latest/async/RestartableTimer-class.html">RestartableTimer</a></code>ã€‚è¿™ä¸ªå¯é‡å¯è®¡æ—¶å™¨çš„åº•å±‚å®ç°ä¸åˆ›å»ºè®¡æ—¶å™¨å®ä¾‹ç›¸åŒã€‚ç”±äº<code>Timer</code>æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œ<code>RestartableTimer</code>æ˜¯å®ƒçš„ä¸€ä¸ªå…·ä½“å®ç°ã€‚</p>
<p><code><a href="https://pub.dev/packages/async">RestartableTimer</a></code> <a href="https://pub.dev/packages/async">æ˜¯å¼‚æ­¥åŒ…</a>çš„ä¸€éƒ¨åˆ†ï¼ŒåŒ…å«<code>dart:async</code>çš„å®ç”¨ç¨‹åºç±»ã€‚å®ƒå·²ç»æ˜¯ Flutter SDK çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å†…å®¹å¯¼å…¥:</p>
<pre class="language-dart hljs">import 'package:async/async.dart';
</pre>
<p>å¯¼å…¥åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„ 3 ç§’é’Ÿ<code>RestartableTimer</code>:</p>
<pre class="language-dart hljs">final restartableTimer = RestartableTimer(
  const Duration(seconds: 3),
  () {
    //Callback
  },
);

//Restart the timer
restartableTimer.reset();
</pre>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé‡ç½®å®šæ—¶å™¨ä¼šä»å…¶åŸå§‹æŒç»­æ—¶é—´é‡æ–°åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ã€‚<code>RestartableTimer</code>ä»…ç”¨äºéå‘¨æœŸæ€§å®šæ—¶å™¨ã€‚</p>
<h2>é¢¤æŒ¯<code>Timer</code>ç¤ºä¾‹å’Œç”¨ä¾‹</h2>
<h3>åœ¨ç¦»å¼€ä¹‹å‰åˆ›å»ºç‰¹å®šæŒç»­æ—¶é—´çš„å±å¹•</h3>
<p>å½“å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ç»å¸¸åˆ›å»ºä¸€ä¸ªåœ¨ä¸€æ®µæ—¶é—´å†…ä¿æŒæ´»åŠ¨çš„å±å¹•ï¼Œç„¶åç»§ç»­åº”ç”¨ç¨‹åºçš„æµç¨‹ã€‚<a href="https://blog.logrocket.com/make-splash-screen-flutter/">è¿™å¯èƒ½æ˜¯ä¸€ä¸ªé—ªå±</a>ï¼Œä¸€ä¸ªâ€œæ‚¨çš„è®¢å•å·²ä¸‹â€å±å¹•ï¼Œæˆ–ä»»ä½•å…¶ä»–è¿‡æ¸¡å…ƒç´ ã€‚</p>
<p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬æœ‰ç¬¬ä¸€ä¸ªå±å¹•<code>RelaxingScreen</code>ï¼Œå®ƒå°†å¯¹ç”¨æˆ·å¯è§ 3 ç§’é’Ÿï¼Œå¹¶åœ¨æ—¶é—´ç»“æŸæ—¶å¯¼èˆªåˆ°<code>NextScreen</code>ã€‚</p>
<p>å½“ä½¿ç”¨<code>Timer</code>æ—¶ï¼Œåœ¨ dispose ä¸Šå–æ¶ˆæ˜¯å¾ˆé‡è¦çš„ã€‚è¿™ä¿è¯äº†å½“ä»æ ‘ä¸­åˆ é™¤ç›¸åº”çš„å°éƒ¨ä»¶æ—¶ï¼Œæ²¡æœ‰è®¡æ—¶å™¨ä¿æŒæ´»åŠ¨çŠ¶æ€ã€‚</p>
<p>çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼Œä½¿ç”¨<code>Timer</code>ç±»å®ç°åŒæ ·çš„åŠŸèƒ½:</p>
<pre class="language-dart hljs">import 'dart:async';

import 'package:flutter/material.dart';

const Color darkBlue = Color.fromARGB(255, 18, 32, 47);

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      theme: ThemeData.dark().copyWith(
        scaffoldBackgroundColor: darkBlue,
      ),
      debugShowCheckedModeBanner: false,
      home: const Scaffold(
        body: Center(
          child: RelaxingScreen(),
        ),
      ),
    );
  }
}

/// Releaxing screen that stays visible for 3 seconds
class RelaxingScreen extends StatefulWidget {
  const RelaxingScreen({Key? key}) : super(key: key);

  @override
  _RelaxingScreenState createState() =&gt; _RelaxingScreenState();
}

class _RelaxingScreenState extends State&lt;RelaxingScreen&gt; {
  //Declare a timer
  Timer? timer;


  @override
  void initState() {
    super.initState();

    /// Initialize timer for 3 seconds, it will be active as soon as intialized
    timer = Timer(
      const Duration(seconds: 3),
      () {
        /// Navigate to seconds screen when timer callback in executed
        Navigator.push(
          context,
          MaterialPageRoute(
            builder: (context) =&gt; const NextScreen(),
          ),
        );
      },
    );
  }

  /// cancel the timer when widget is disposed, 
  /// to avoid any active timer that is not executed yet
  @override
  void dispose() {
    super.dispose();
    timer?.cancel();
  }

  @override
  Widget build(BuildContext context) {
    return const Text("Relaxing Screen!!");
  }
}

class NextScreen extends StatelessWidget {
  const NextScreen({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return const Scaffold(
      body: Center(
        child: Text("Next Screen"),
      ),
    );
  }
}
</pre>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè®©<code>RelaxingScreen</code>å¯¹ç”¨æˆ·å¯è§ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€çš„å°éƒ¨ä»¶ï¼Œç„¶åæˆ‘ä»¬å¿…é¡»åœ¨<code>initState()</code>ä¸Šæ³¨å†Œ<code>Timer</code>ã€‚</p>
<p>3 ç§’é’Ÿåï¼Œä¸€ä¸ªå›è°ƒè§¦å‘å¯¼èˆªç”¨æˆ·åˆ°<code>NextScreen</code>ã€‚é‡è¦çš„æ˜¯å–æ¶ˆ<code>dispose()</code>æ–¹æ³•ä¸Šçš„è®¡æ—¶å™¨ï¼Œä»¥é¿å…å¦‚æœç”¨æˆ·åœ¨å›è°ƒè§¦å‘ä¹‹å‰ç¦»å¼€<code>RelaxingScreen</code>å¯èƒ½äº§ç”Ÿçš„ä»»ä½•å¼‚å¸¸ã€‚</p>
<h3>è‡ªåŠ¨å°†è®¡æ•°å™¨åº”ç”¨ç¨‹åºå¢åŠ  1 ç§’</h3>
<p>ä½œä¸ºä¸€ä¸ªé¢¤æŒ¯å¼€å‘è€…ï¼Œä½ æœ€æœ‰å¯èƒ½<a href="https://blog.logrocket.com/whats-new-in-flutter-2-5/#new-app-template">ç†Ÿæ‚‰éå¸¸è‘—åçš„è®¡æ•°å™¨åº”ç”¨</a>ğŸ˜…ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç±»ä¼¼çš„è®¡æ•°å™¨åº”ç”¨ç¨‹åºï¼Œä½†ä¸æ˜¯æŒ‰+æŒ‰é’®ï¼Œè€Œæ˜¯æ¯ 1 ç§’é’Ÿè‡ªåŠ¨å¢åŠ ä¸€æ¬¡è®¡æ•°å™¨ï¼Œå¹¶é€šè¿‡é‡å»ºä¸€ä¸ª<code>Text</code>å°éƒ¨ä»¶å‘ç”¨æˆ·æ˜¾ç¤º:</p>
<pre class="language-dart hljs">import 'dart:async';

import 'package:flutter/material.dart';

const Color darkBlue = Color.fromARGB(255, 18, 32, 47);

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      theme: ThemeData.dark().copyWith(
        scaffoldBackgroundColor: darkBlue,
      ),
      debugShowCheckedModeBanner: false,
      home: const Scaffold(
        body: Center(
          child: CounterScreen(),
        ),
      ),
    );
  }
}

class CounterScreen extends StatefulWidget {
  const CounterScreen({Key? key}) : super(key: key);

  @override
  _CounterScreenState createState() =&gt; _CounterScreenState();
}

class _CounterScreenState extends State&lt;CounterScreen&gt; {

  /// declare a cound variable with initial value
  int count = 0;

  /// declare a timer
  Timer? timer;

  @override
  void initState() {
    super.initState();

    /// Initialize a periodic timer with 1 second duration
    timer = Timer.periodic(
      const Duration(seconds: 1),
      (timer) {
        /// callback will be executed every 1 second, increament a count value 
        /// on each callback
        setState(() {
          count++;
        });
      },
    );
  }

  /// Since periodic timer doesn't cancels untill expicitely called
  /// It is important to cancel them on dispose, so that it doesn't stays active
  /// when widget is not binded to tree
  @override
  void dispose() {
    super.dispose();
    timer?.cancel();
  }

  @override
  Widget build(BuildContext context) {
    return Text("Counter reached $count");
  }
}
</pre>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæœ‰ä¸€ä¸ª<code>StatefulWidget</code>ã€<code>CounterScreen</code>ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­æ³¨å†Œäº†ä¸€ä¸ªæ¯ 1 ç§’æ»´ç­”ä¸€æ¬¡çš„å‘¨æœŸæ€§å®šæ—¶å™¨ã€‚æ¯è§¦å‘ä¸€æ¬¡å›è°ƒï¼Œæˆ‘ä»¬å°±å¢åŠ çŠ¶æ€å˜é‡<code>count</code>ã€‚ç„¶åä¸€ä¸ª<code>Text</code>å°éƒ¨ä»¶æ˜¾ç¤º<code>count</code>çš„æœ€æ–°å€¼ã€‚</p>
<p>ä¹Ÿå¯ä»¥é‡‡ç”¨ç±»ä¼¼çš„æ–¹æ³•æ¥æ˜¾ç¤ºå€’è®¡æ—¶å®šæ—¶å™¨æˆ–å‰©ä½™æŒç»­æ—¶é—´(ä¾‹å¦‚ï¼Œä¸€æ¬¡æ€§å¯†ç è¶…æ—¶)ã€‚</p>
<h2>Flutter çš„<code>Timer</code>çº§çš„å±€é™æ€§</h2>
<p>å½“æˆ‘ä»¬æƒ³åˆ°é€šç”¨å®šæ—¶å™¨æ—¶ï¼Œé€šå¸¸ä¼šæƒ³åˆ°æš‚åœæˆ–æ¢å¤å®šæ—¶å™¨ä¹‹ç±»çš„å®ç”¨ç¨‹åºã€‚æ­£å¦‚æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€çœ‹åˆ°çš„ï¼ŒFlutter çš„<code>Timer</code>ç±»æ—¨åœ¨ä¸ºä»¥åè°ƒåº¦ä¸€ä¸ªä»£ç å—ï¼Œæˆ–è€…åœ¨ç‰¹å®šçš„æŒç»­æ—¶é—´å†…é‡å¤æ‰§è¡Œå®ƒã€‚</p>
<p>è¦åœ¨ Flutter ä¸­å®ç°æš‚åœå’Œæ¢å¤è®¡æ—¶å™¨ç­‰å®ç”¨ç¨‹åºï¼Œ<a href="https://api.flutter.dev/flutter/dart-core/Stopwatch-class.html">å¯ä»¥ä½¿ç”¨</a> <code><a href="https://api.flutter.dev/flutter/dart-core/Stopwatch-class.html">Stopwatch</a></code> <a href="https://api.flutter.dev/flutter/dart-core/Stopwatch-class.html">ç±»</a>ã€‚</p>
<h2>åŒ…æ‰</h2>
<p>Flutter çš„<code>Timer</code>ç±»å¤„ç†æ¯ä¸€ä¸ªä¸å€’è®¡æ—¶å®šæ—¶å™¨ç›¸å…³çš„ç”¨ä¾‹ã€‚æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ­£å¸¸çš„å’Œå®šæœŸçš„è®¡æ—¶å™¨ï¼Œå…·æœ‰å®Œæ•´çš„å®ç”¨ç¨‹åºï¼Œå¦‚å–æ¶ˆè®¡æ—¶å™¨ï¼Œè¯†åˆ«è®¡æ—¶å™¨æ˜¯å¦æ´»åŠ¨ï¼Œä»¥åŠæ»´ç­”è®¡æ•°ã€‚</p>
<p>æˆ‘ä»¬è¿˜çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨<code>RestartableTimer</code>é‡æ–°è®¾ç½®å’Œå¯åŠ¨å®šæ—¶å™¨ã€‚</p>
<p>æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œä¸è¦å¿˜è®°åˆ†äº«æ‚¨åœ¨<code>Timer</code>çš„å¸®åŠ©ä¸‹æ­£åœ¨åˆ›é€ å¤šä¹ˆç¾ä¸½çš„ UXğŸ¤©ã€‚</p><div class="code-block code-block-2">
<div class="blog-plug base-cta"><h2>ä½¿ç”¨<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>æ¶ˆé™¤ä¼ ç»Ÿé”™è¯¯æŠ¥å‘Šçš„å¹²æ‰°</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>æ˜¯ä¸€ä¸ªæ•°å­—ä½“éªŒåˆ†æè§£å†³æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥ä¿æŠ¤æ‚¨å…å—æ•°ç™¾ä¸ªå‡é˜³æ€§é”™è¯¯è­¦æŠ¥çš„å½±å“ï¼Œåªé’ˆå¯¹å‡ ä¸ªçœŸæ­£é‡è¦çš„é¡¹ç›®ã€‚LogRocket ä¼šå‘Šè¯‰æ‚¨åº”ç”¨ç¨‹åºä¸­å®é™…å½±å“ç”¨æˆ·çš„æœ€å…·å½±å“åŠ›çš„ bug å’Œ UX é—®é¢˜ã€‚</p>
<p>ç„¶åï¼Œä½¿ç”¨å…·æœ‰æ·±å±‚æŠ€æœ¯é¥æµ‹çš„ä¼šè¯é‡æ”¾æ¥ç¡®åˆ‡åœ°æŸ¥çœ‹ç”¨æˆ·çœ‹åˆ°äº†ä»€ä¹ˆä»¥åŠæ˜¯ä»€ä¹ˆå¯¼è‡´äº†é—®é¢˜ï¼Œå°±åƒä½ åœ¨ä»–ä»¬èº«åçœ‹ä¸€æ ·ã€‚</p>
<p>LogRocket è‡ªåŠ¨èšåˆå®¢æˆ·ç«¯é”™è¯¯ã€JS å¼‚å¸¸ã€å‰ç«¯æ€§èƒ½æŒ‡æ ‡å’Œç”¨æˆ·äº¤äº’ã€‚ç„¶å LogRocket ä½¿ç”¨æœºå™¨å­¦ä¹ æ¥å‘Šè¯‰ä½ å“ªäº›é—®é¢˜æ­£åœ¨å½±å“å¤§å¤šæ•°ç”¨æˆ·ï¼Œå¹¶æä¾›ä½ éœ€è¦ä¿®å¤å®ƒçš„ä¸Šä¸‹æ–‡ã€‚</p>
<p>å…³æ³¨é‡è¦çš„ bugâ€”<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">ä»Šå¤©å°±è¯•è¯• LogRocketã€‘ã€‚</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>