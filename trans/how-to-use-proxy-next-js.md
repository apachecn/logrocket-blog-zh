# å¦‚ä½•åœ¨ Next.js - LogRocket åšå®¢ä¸­ä½¿ç”¨ä»£ç†

> åŸæ–‡ï¼š<https://blog.logrocket.com/how-to-use-proxy-next-js/>

ä¸­é—´å•†æ— å¤„ä¸åœ¨ã€‚ç”±äºè¿™äº›ä¸­é—´äººçš„å¸®åŠ©ï¼Œæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ä½¿ç”¨çš„å¤§éƒ¨åˆ†ä¸œè¥¿éƒ½æ˜¯å¯æŒç»­çš„å’Œå¯ç”¨çš„ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å•†å“å’ŒæœåŠ¡çš„é›¶å”®å•†å’Œæ‰¹å‘å•†åªä¸è¿‡æ˜¯å¸®åŠ©æˆ‘ä»¬ä»¥æ›´æœ‰æ•ˆçš„æ–¹å¼è·å¾—æ‰€éœ€çš„ä¸­é—´å•†ã€‚æˆ‘ä»¬ä¸éœ€è¦è§åˆ¶é€ å•†ï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“åŸææ–™æ¥è‡ªå“ªé‡Œã€‚

ä»æœ¬è´¨ä¸Šè¯´ï¼Œè¿™å°±æ˜¯ä»£ç†â€”â€”å®ƒå……å½“æˆ‘ä»¬çš„æ•°å­—ä¸­é—´äººã€‚

## ä»€ä¹ˆæ˜¯ä»£ç†ï¼Ÿ

ä»£ç†æˆ–ä»£ç†æœåŠ¡å™¨å……å½“æ‚¨æ­£åœ¨è®¿é—®çš„ç½‘ç«™å’Œæ‚¨çš„è®¾å¤‡ä¹‹é—´çš„ä¸­ç»§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è€ƒè™‘åˆ°ä»£ç†æ„å‘³ç€æ‚¨ä¸å¿…æš´éœ²æ‚¨çš„çœŸå®èº«ä»½ï¼Œè¿™å¯ä»¥ä¸ºå®‰å…¨æ€§æä¾›å·¨å¤§çš„å¥½å¤„ã€‚

å°±åƒä¸­é—´äººä¸€æ ·ï¼Œä»£ç†æœåŠ¡å™¨é€šè¿‡å°†å®¢æˆ·ç«¯è¯·æ±‚è½¬å‘ç»™èµ„æºæ¥å……å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä¸­é—´æœåŠ¡å™¨â€”â€”æœ€å¥½å°†å…¶è§†ä¸ºç½‘å…³ã€‚ä»£ç†æœåŠ¡å™¨ä¸åº”è¢«è¯¯è®¤ä¸ºè™šæ‹Ÿä¸“ç”¨ç½‘ç»œ(VPN ),å› ä¸ºè™½ç„¶å®ƒä»¬çš„ç”¨é€”å¯èƒ½ç›¸ä¼¼ï¼Œä½†å®ƒä»¬å¹¶ä¸ç›¸åŒã€‚

ç”µè„‘ä¸Šçš„ VPN å®¢æˆ·ç«¯ä¸ VPN æœåŠ¡å™¨å»ºç«‹å®‰å…¨éš§é“ï¼Œå–ä»£æœ¬åœ° ISP è·¯ç”±ã€‚VPN è¿æ¥åŠ å¯†å’Œä¿æŠ¤æ‚¨çš„æ‰€æœ‰ç½‘ç»œæµé‡ï¼›ä¸ä»…ä»…æ˜¯ HTTPS åƒä»£ç†æœåŠ¡å™¨ä¸€æ ·ä»æµè§ˆå™¨è°ƒç”¨ã€‚

äº’è”ç½‘ä¸Šçš„ä»»ä½•ä¸œè¥¿è¦ä¹ˆåœ¨å®¢æˆ·ç«¯ï¼Œè¦ä¹ˆåœ¨æœåŠ¡å™¨ç«¯ã€‚ä½ çš„æµè§ˆå™¨å°±æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯çš„ä¾‹å­ï¼›å½“ä½ åœ¨è„¸ä¹¦æˆ– Twitter ä¸Šæ³¨å†Œæ—¶ï¼Œä½ å¡«å†™çš„è¡¨å•åŸŸ(æµé‡)ä¼šè¢«æœåŠ¡å™¨å‘é€å’Œå¤„ç†ã€‚

ç°åœ¨ï¼Œå½“ä½ è¯•å›¾åœ¨äº’è”ç½‘ä¸Šåšä»»ä½•äº‹æƒ…æ—¶ï¼Œä½ çš„è®¡ç®—æœº(å®¢æˆ·æœº)ç›´æ¥ä¸æœåŠ¡å™¨é€šä¿¡ã€‚è¿™æ˜¯ä»£ç†æœåŠ¡å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬é¿å…çš„ã€‚

## ä»£ç†çš„é‡è¦æ€§

### ä¿æŠ¤

åœ¨å½“ä»Šçš„ç½‘ç»œå®‰å…¨ç¯å¢ƒä¸‹ï¼Œä¸ä½¿ç”¨ä»£ç†è®¿é—®ç½‘ç«™è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼›å®ƒä½¿æ‚¨å¤„äºå¼€æ”¾çŠ¶æ€ï¼Œå®¹æ˜“å—åˆ°ä»»ä½•èƒ½å¤Ÿè®¿é—®æœåŠ¡å™¨çš„äººçš„æ”»å‡»ã€‚ä½¿ç”¨ä»£ç†æœ‰åŠ©äºä¿æŠ¤å®¢æˆ·ä¿¡æ¯ä¸è¢«æ³„éœ²ã€‚

### é˜²ç«å¢™

å¤§å¤šæ•°å…¬å¸æˆ–å®¶åº­è®¾ç½®äº†é˜²ç«å¢™æ¥é™åˆ¶ç½‘ç»œç”¨æˆ·è®¿é—®æŸäº›ç½‘ç«™ã€‚ä»£ç†æœåŠ¡å™¨å¯ç”¨äºç»•è¿‡è¢«é˜»æ­¢çš„ç½‘ç«™ã€‚å¯¹äºç»„ç»‡æ¥è¯´ï¼Œå°†è¢«è®¤ä¸ºå¯¹å‘˜å·¥æ•°æ®å®‰å…¨æœ‰å±é™©çš„ç½‘ç«™å±è”½æˆ–åˆ—å…¥é»‘åå•æ˜¯å¾ˆå¸¸è§çš„ã€‚

å¦å¤–ï¼Œå¾ˆå¤šç½‘ç«™éƒ½æœ‰åœ°åŸŸé™åˆ¶ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¦‚æœè®¿é—®ç½‘ç«™æ˜¯å¿…è¦çš„ï¼Œä»£ç†æœåŠ¡å™¨å¯ä»¥å¸®åŠ©ä½ ã€‚

### åŒ¿å

å› ä¸ºä½ æ˜¯é€šè¿‡ç½‘å…³å‘é€æµé‡ï¼Œè¿™å°±äº§ç”Ÿäº†ä¸€å®šç¨‹åº¦çš„åŒ¿åæ€§ã€‚

å®ƒå°†æ‚¨çš„èº«ä»½ä»å®¢æˆ·ç«¯-æœåŠ¡å™¨ç­‰å¼ä¸­ç§»é™¤ï¼Œå¹¶é€šè¿‡ä»…å°†æŸäº›æ•°æ®äº¤ç»™ä¸­é—´äººæ¥å®ç°è¿™ä¸€ç‚¹ï¼Œè¿™æ˜¯æœåŠ¡å™¨æ¥æ”¶åˆ°çš„å…³äºæ‚¨çš„å”¯ä¸€ä¿¡æ¯ã€‚é€šè¿‡ä½¿ç”¨ä»£ç†ï¼Œç”¨æˆ·å¯ä»¥ä»¥è¿™ç§æ–¹å¼åŒ¿åä¿å­˜ä»–ä»¬çš„ä¸ªäººä¿¡æ¯å’Œæµè§ˆä¹ æƒ¯ã€‚

## åœ¨ Next.js åº”ç”¨ç¨‹åºä¸­å®ç°ä»£ç†

Next.js æ˜¯æ„å»ºåœ¨ Node.js ä¹‹ä¸Šçš„å¼€æºå¼€å‘æ¡†æ¶ï¼Œæ”¯æŒåŸºäº React çš„ web åº”ç”¨åŠŸèƒ½ï¼Œæ¯”å¦‚æœåŠ¡å™¨ç«¯æ¸²æŸ“å’Œé™æ€ç½‘ç«™ç”Ÿæˆã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å°†åœ¨ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºä¸­è¯•éªŒæˆ‘ä»¬å·²ç»è®¨è®ºè¿‡çš„å…³äºä»£ç†æœåŠ¡å™¨çš„æ‰€æœ‰å†…å®¹ã€‚Next.js ç”šè‡³æä¾›äº†ä¸€ç§ç”¨å®ƒçš„[é‡å†™](https://nextjs.org/docs/api-reference/next.config.js/rewrites)æ•°ç»„æ¥åšè¿™ä»¶äº‹çš„æ–¹æ³•ã€‚

ç¡®ä¿æ‚¨çš„è®¡ç®—æœºä¸Šè‡³å°‘å®‰è£…äº† Node.js ç‰ˆæœ¬ 12ã€‚åœ¨æ‚¨çš„æœºå™¨ä¸Šå®‰è£… Node.js å¸¦æœ‰ npm(èŠ‚ç‚¹åŒ…ç®¡ç†å™¨)ï¼Œå®ƒä¹Ÿå¸¦æœ‰ npx(èŠ‚ç‚¹åŒ…æ‰§è¡Œ)ï¼Œå®ƒå°†ç”¨äºå®‰è£… Next.jsã€‚

ä¸€äº›å¼€å‘äººå‘˜æ›´å–œæ¬¢ Yarnï¼Œè¿™æ˜¯æ›¿ä»£ npm çš„å¦ä¸€ä¸ªé€‰é¡¹â€”â€”å¦‚æœæ‚¨æƒ³ä½¿ç”¨å®ƒï¼Œè¯·å®‰è£…å®ƒã€‚

### **å®‰è£… Next.js**

åœ¨æ‚¨çš„æœºå™¨ä¸Šè¾“å…¥ä»¥ä¸‹å‘½ä»¤:

```
npx [emailÂ protected]
#OR
yarn create next-app

```

ä¸ç®¡æ‚¨å®‰è£…äº†ä»€ä¹ˆæ ·çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼Œæ‚¨éƒ½ä¼šå¾—åˆ°:

![Nextjs Proxy Example Screenshot Implementation](img/f33e151aa925c61a86cdbd6944226e31.png)

ç‚¹å‡»**è¿›å…¥**ï¼Œä¹‹åä¼šæç¤ºä½ è¾“å…¥é¡¹ç›®æ‰€åœ¨æ–‡ä»¶å¤¹çš„åç§°ã€‚å¦‚æœä½ å†æ¬¡ç‚¹å‡»**è¾“å…¥**ï¼Œè¿™ä¸ªé¡¹ç›®çš„åå­—å°†ä¼šæ˜¯â€œæˆ‘çš„åº”ç”¨â€ã€‚

å®‰è£…å®Œæˆåï¼Œè¿›å…¥æ‚¨çš„é¡¹ç›®ç›®å½•ã€‚è¿™æ˜¯æ‚¨çš„ Next.js å…¨æ–°å®‰è£…çš„æ ·å­:

![Proxy Nextjs Installation Project Directory](img/2a89ac75dd6acb0756161759b644e1aa.png)

è¦å¯åŠ¨å®ƒï¼Œè¯·è¿è¡Œ:

```
npm run dev
#OR
yarn dev

```

ä¼šä» [http://localhost:3000](http://localhost:3000) å¼€å§‹ã€‚

![Proxy And Nextjs Screenshot Example](img/1e53fb6de127a5a91c59946526146360.png)

ä½ ä¼šå¾—åˆ°ç±»ä¼¼è¿™æ ·çš„å›¾åƒ(æˆ‘åœ¨è¿™é‡Œåšäº†ä¸€äº›å°çš„ç¼–è¾‘ğŸ˜).

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘å‡è®¾æ‚¨å¯¹ Next.js æœ‰ä¸€å®šç¨‹åº¦çš„ç†Ÿæ‚‰ï¼Œæ‰€ä»¥æˆ‘å°†å¼€é—¨è§å±±ã€‚æˆ‘ä»¬å‡†å¤‡ç”¨è¿™ä¸ª app(æ³¨æ„é»˜è®¤è¿è¡Œåœ¨ 3000 ç«¯å£ï¼›æ‚¨æ€»æ˜¯å¯ä»¥é‡æ–°é…ç½®å®ƒ)å¹¶è®©å®ƒè¿æ¥åˆ°å¦ä¸€ä¸ªå®Œå…¨ä¸åŒç«¯å£ä¸Šçš„åç«¯æœåŠ¡å™¨ã€‚

æˆ‘å°†åˆ›å»ºä¸€ä¸ªçŒ«é¡µé¢ï¼Œåœ¨é‚£é‡Œæˆ‘å°†ä»[https://meowfacts.herokuapp.com](https://meowfacts.herokuapp.com)è·å¾—å…³äºçŒ«çš„éšæœºäº‹å®(è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ APIï¼Œæ˜¾ç¤ºå…³äºçŒ«çš„éšæœºäº‹å®)ã€‚

Next.js æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚åœ¨`next.config.js` *ï¼Œ*ä¸­ç”¨è¿™ä¸ªæ›¿æ¢é‡Œé¢çš„ä»£ç :

```
//js
module.exports = () => {
  const rewrites = () => {
    return [
      {
        source: "/cats",
        destination: "https://meowfacts.herokuapp.com",
      },
    ];
  };
  return {
    rewrites,
  };
};

```

[é‡å†™](https://nextjs.org/docs/api-reference/next.config.js/rewrites)å…è®¸æ‚¨å°†ä¼ å…¥è¯·æ±‚è·¯å¾„æ˜ å°„åˆ°ä¸åŒçš„ç›®æ ‡è·¯å¾„ã€‚

é‡å†™å……å½“ URL ä»£ç†å¹¶å±è”½ç›®æ ‡è·¯å¾„ï¼Œä½¿å…¶çœ‹èµ·æ¥å¥½åƒç”¨æˆ·æ²¡æœ‰æ”¹å˜ä»–ä»¬åœ¨ç«™ç‚¹ä¸Šçš„ä½ç½®ã€‚ç›¸åï¼Œ[é‡å®šå‘](https://nextjs.org/docs/api-reference/next.config.js/redirects)å°†é‡æ–°è·¯ç”±åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œå¹¶æ˜¾ç¤º URL çš„å˜åŒ–ã€‚

æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ä¸­æ‰€åšçš„åªæ˜¯ç®€å•åœ°é…ç½®æˆ‘ä»¬çš„ Next.js åº”ç”¨ç¨‹åºï¼Œä»¥ä¾¿å½“æˆ‘ä»¬è½¬åˆ°`/cats`æ—¶ï¼Œå®ƒä»ç›®çš„åœ°è·å–æ•°æ®è€Œä¸æ³„éœ²å®ƒã€‚

æˆ‘å°†ç»§ç»­æ·»åŠ å¦ä¸€æ¡ä»[https://random-d.uk/api/random](https://random-d.uk/api/random)è·å–æ•°æ®(éšæœºé¸­å­å›¾åƒ)çš„è·¯çº¿ã€‚æˆ‘åªéœ€è¦æ·»åŠ å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
  {
        source: "/ducks",
        destination: "https://random-d.uk/api/random",
      },

```

ç°åœ¨ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·:

```
module.exports = () => {
  const rewrites = () => {
    return [
      {
        source: "/cats",
        destination: "https://meowfacts.herokuapp.com",
      },
      {
        source: "/ducks",
        destination: "https://random-d.uk/api/random",
      },
    ];
  };
  return {
    rewrites,
  };
};

```

è¿™æ ·ï¼Œå½“æˆ‘ä»¬åœ¨ Next.js åº”ç”¨ç¨‹åºä¸Šè®¿é—®`/ducks`æ—¶ï¼Œå®ƒä¼šä»[https://random-d.uk/api/random](https://random-d.uk/api/random)è·å–æ•°æ®ï¼Œè€Œä¸ä¼šæš´éœ²å…¶ URLã€‚ä»¥ä¸‹é¢çš„å›¾ç‰‡ä¸ºä¾‹:

![Nextjs Data Retrieval Proxy Example Screenshot](img/d26f640fd523b287bcd6aff2b0e9b7be.png)

![Proxy Nextjs Retrieval Example Cat Website](img/ace88a1d48f03137718ee49939662e3f.png)

## ç»“è®º

æ­å–œä½ ï¼æ‚¨å·²ç»åˆ°è¾¾æœ¬æ•™ç¨‹çš„ç»“å°¾ã€‚æˆ‘ä»¬å·²ç»ç ”ç©¶äº†ä»€ä¹ˆæ˜¯ä»£ç†ä»¥åŠä»£ç†çš„æ•ˆç”¨â€”â€”ä»å®ƒæä¾›çš„ä¿æŠ¤åˆ°å®ƒå¸¦æ¥çš„åŒ¿åæ€§ã€‚

æˆ‘ä»¬åœ¨ Next.js ä¸­å®ç°äº†ä¸€ä¸ªä»£ç†ï¼Œå®ƒæä¾›äº†ä¸€ç§å¼€ç®±å³ç”¨çš„æ–¹å¼æ¥å®ç°è¿™ä¸€ç‚¹ã€‚é€šè¿‡é‡å†™ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå°†ä¼ å…¥çš„è¯·æ±‚è·¯å¾„æ˜ å°„åˆ°ä¸åŒçš„ç›®æ ‡è·¯å¾„ï¼Œå¹¶ä¸”èƒ½å¤Ÿä½¿ç”¨ä¸€äº›å¤–éƒ¨ API å¯¹æ­¤è¿›è¡Œæµ‹è¯•ï¼Œå¹¶åœ¨æˆ‘ä»¬çš„æœ¬åœ°æœºå™¨ä¸Šçº æ­£æè¦ã€‚

## [LogRocket](https://lp.logrocket.com/blg/nextjs-signup) :å…¨é¢äº†è§£ç”Ÿäº§ Next.js åº”ç”¨

è°ƒè¯•ä¸‹ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯èƒ½ä¼šå¾ˆå›°éš¾ï¼Œå°¤å…¶æ˜¯å½“ç”¨æˆ·é‡åˆ°éš¾ä»¥é‡ç°çš„é—®é¢˜æ—¶ã€‚å¦‚æœæ‚¨å¯¹ç›‘è§†å’Œè·Ÿè¸ªçŠ¶æ€ã€è‡ªåŠ¨æ˜¾ç¤º JavaScript é”™è¯¯ã€è·Ÿè¸ªç¼“æ…¢çš„ç½‘ç»œè¯·æ±‚å’Œç»„ä»¶åŠ è½½æ—¶é—´æ„Ÿå…´è¶£ï¼Œ

[try LogRocket](https://lp.logrocket.com/blg/nextjs-signup)

.

[![](img/f300c244a1a1cf916df8b4cb02bec6c6.png)](https://lp.logrocket.com/blg/nextjs-signup)[![LogRocket Dashboard Free Trial Banner](img/d6f5a5dd739296c1dd7aab3d5e77eeb9.png)](https://lp.logrocket.com/blg/nextjs-signup)

LogRocket å°±åƒæ˜¯ç½‘ç»œå’Œç§»åŠ¨åº”ç”¨çš„ DVRï¼Œè®°å½•ä¸‹ä½ çš„ Next.js åº”ç”¨ä¸Šå‘ç”Ÿçš„ä¸€åˆ‡ã€‚æ‚¨å¯ä»¥æ±‡æ€»å¹¶æŠ¥å‘Šé—®é¢˜å‘ç”Ÿæ—¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯çŒœæµ‹é—®é¢˜å‘ç”Ÿçš„åŸå› ã€‚LogRocket è¿˜å¯ä»¥ç›‘æ§åº”ç”¨ç¨‹åºçš„æ€§èƒ½ï¼ŒæŠ¥å‘Šå®¢æˆ·ç«¯ CPU è´Ÿè½½ã€å®¢æˆ·ç«¯å†…å­˜ä½¿ç”¨ç­‰æŒ‡æ ‡ã€‚

LogRocket Redux ä¸­é—´ä»¶åŒ…ä¸ºæ‚¨çš„ç”¨æˆ·ä¼šè¯å¢åŠ äº†ä¸€å±‚é¢å¤–çš„å¯è§æ€§ã€‚LogRocket è®°å½• Redux å­˜å‚¨ä¸­çš„æ‰€æœ‰æ“ä½œå’ŒçŠ¶æ€ã€‚

è®©æ‚¨è°ƒè¯• Next.js åº”ç”¨çš„æ–¹å¼ç°ä»£åŒ–â€” [å¼€å§‹å…è´¹ç›‘æ§](https://lp.logrocket.com/blg/nextjs-signup)ã€‚