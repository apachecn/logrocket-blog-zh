<html>
<head>
<title>Build an internal error notification system in Go and Svelte </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>åœ¨Goå’ŒSvelteä¸­æ„å»ºå†…éƒ¨é”™è¯¯é€šçŸ¥ç³»ç»Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/#0001-01-01">https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/#0001-01-01</a></blockquote><div><article class="article-post">
<p>å†…éƒ¨é”™è¯¯é€šçŸ¥ç³»ç»Ÿæ˜¯ä»»ä½•å¤§å‹ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚å®ƒé€šè¿‡å„ç§æ–¹å¼(å¦‚ç”µå­é‚®ä»¶ã€Slackç­‰)æŠ¥å‘Šæ—¥å¿—ï¼Œå¸®åŠ©å¼€å‘äººå‘˜è¯†åˆ«å’Œä¿®å¤ç³»ç»Ÿä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹å¦‚ä½•ä½¿ç”¨<code>notify</code>åº“åœ¨Golangä¸­æ„å»ºä¸€ä¸ªç®€å•çš„å†…éƒ¨é”™è¯¯é€šçŸ¥ç³»ç»Ÿã€‚</p>
<p>Notifyæ˜¯ä¸€ä¸ªç®€å•çš„Goåº“ï¼Œç”¨äºå‘å„ç§æ¶ˆæ¯æœåŠ¡å‘é€é€šçŸ¥ã€‚å®ƒæ”¯æŒSlackã€emailã€Amazon SESã€Amazon SNSã€Barkã€DingTalkã€MailGridã€Discordã€Redditã€Viberã€Twilioç­‰ç­‰ã€‚</p>
<p><em>å‘å‰è·³è·ƒ</em>:</p>

<h2 id="comparison-notify-sentry">Notifyå’ŒSentryçš„æ¯”è¾ƒ</h2>
<p><code>notify</code>åŒ…æä¾›äº†ä¸€ä¸ªç‹¬ç«‹äºå¹³å°çš„æ¥å£ï¼Œç”¨äºå‘ä¸€ä¸ªæˆ–å¤šä¸ªæ¶ˆæ¯æœåŠ¡å‘é€æ¶ˆæ¯ã€‚è¿™å¯¹äºè§¦å‘æŸäº›æ“ä½œæˆ–å®ç°é€šçŸ¥ç³»ç»Ÿéå¸¸æœ‰ç”¨ã€‚</p>
<p><a href="https://sentry.io/"> Sentry </a>æ˜¯ä¸€ä¸ªåŸºäºäº‘çš„é”™è¯¯è·Ÿè¸ªå¹³å°ï¼Œå¸®åŠ©å¼€å‘äººå‘˜è·Ÿè¸ªå’Œä¿®å¤ä»–ä»¬åº”ç”¨ç¨‹åºä¸­çš„é”™è¯¯ã€‚å®ƒæä¾›å®æ—¶é”™è¯¯æŠ¥å‘Šã€è­¦æŠ¥å’Œæ´å¯Ÿï¼Œå¸®åŠ©å¼€å‘äººå‘˜å°½å¿«è¯†åˆ«å’Œä¿®å¤é”™è¯¯ã€‚Sentryæ”¯æŒå¤šç§è¯­è¨€å’Œå¹³å°ã€‚</p>
<p><code>notify</code>å’ŒSentryçš„ä¸»è¦åŒºåˆ«åœ¨äº<code>notify</code>æ˜¯ä¸€ä¸ªç”¨äºå‘ä¸€ä¸ªæˆ–å¤šä¸ªæ¶ˆæ¯æœåŠ¡å‘é€é€šçŸ¥çš„åŒ…ï¼Œè€ŒSentryæ˜¯ä¸€ä¸ªç”¨äºè·Ÿè¸ªå’Œä¿®å¤åº”ç”¨ç¨‹åºä¸­é”™è¯¯çš„å¹³å°ã€‚å®ƒä»¬æœåŠ¡äºä¸åŒçš„ç›®çš„ï¼Œä¸å…·æœ‰ç›´æ¥çš„å¯æ¯”æ€§ï¼Œä½†æ˜¯å›´ç»•Notifyæ„å»ºä¸€ä¸ªç³»ç»Ÿä½¿å®ƒæ›´æœ‰èƒ½åŠ›ä½œä¸ºä¸€ä¸ªå·¥å…·æ¥æŠ¥å‘Šå¤šä¸ªæ¶ˆæ¯æœåŠ¡ä¸Šçš„é”™è¯¯ã€‚</p>
<h2 id="prerequisites">æœ¬æ•™ç¨‹çš„å…ˆå†³æ¡ä»¶</h2>
<p>è¦ç»§ç»­å­¦ä¹ æœ¬æ•™ç¨‹ï¼Œæ‚¨éœ€è¦å®‰è£…ä»¥ä¸‹è½¯ä»¶:</p>

<h2 id="setting-up-project">è®¾ç½®æˆ‘ä»¬çš„é¡¹ç›®</h2>
<p>ä¸ºäº†åˆ©ç”¨Notifyçš„å¼ºå¤§åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç®€å•çš„å†…éƒ¨é”™è¯¯é€šçŸ¥ç³»ç»Ÿï¼Œå®ƒå°†èƒ½å¤Ÿ:</p>
<ul>
<li>è®°å½•é”™è¯¯å¹¶å‘ç”µå­é‚®ä»¶å’ŒSlackå‘é€é€šçŸ¥</li>
<li>æ˜¾ç¤ºæ˜¾ç¤ºé€šçŸ¥æ—¥å¿—åˆ—è¡¨çš„ä»ªè¡¨æ¿</li>
</ul>
<p>è¯¥é¡¹ç›®å°†åœ¨ä»¥ä¸‹å †æ ˆ/æ¡†æ¶ä¸­å®ç°:</p>

<h2 id="setting-up-backend-services">è®¾ç½®åç«¯å’ŒæœåŠ¡</h2>
<p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º<code>alert.go</code>çš„æ–‡ä»¶æ¥å¤„ç†é”™è¯¯æ—¥å¿—ã€å‘é€é€šçŸ¥å’Œä»ªè¡¨æ¿çš„APIç«¯ç‚¹ã€‚</p>
<p>æˆ‘ä»¬å°†ä»è®¾ç½®ç¯å¢ƒå’Œå®‰è£…åŒ…å¼€å§‹:</p>
<pre class="language-bash hljs">go mod init main
</pre>
<p>æˆ‘ä»¬å°†ä½¿ç”¨GolangåŒ…ç®¡ç†å™¨<code>go get</code>æ¥å®‰è£…<a href="https://github.com/nikoksr/notify">é€šçŸ¥</a>:</p>
<pre class="language-bash hljs">go get -u github.com/nikoksr/notify
</pre>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®æˆ‘ä»¬çš„æœåŠ¡ã€‚è®¾ç½®æœåŠ¡åŒ…æ‹¬é…ç½®åŒ…ä»¥å‘å„ç§å¤–éƒ¨æœåŠ¡å‘é€é€šçŸ¥ï¼Œå¦‚ç”µå­é‚®ä»¶ã€Slackç­‰ã€‚</p>
<p>è¦é€šè¿‡ç”µå­é‚®ä»¶å‘é€é€šçŸ¥ï¼Œæ‚¨éœ€è¦å®‰è£…ä¸€ä¸ªè½¯ä»¶åŒ…:</p>
<pre class="language-bash hljs">go get github.com/jordan-wright/email
</pre>
<p>ç„¶åï¼Œé…ç½®SMTPæœåŠ¡å™¨ï¼Œå¹¶ä¸ºåŒ…æä¾›å¿…è¦çš„å‡­æ®ï¼Œå¦‚æœåŠ¡å™¨åœ°å€ã€ç«¯å£å·å’Œç™»å½•å‡­æ®:</p>
<pre class="language-golang hljs">email := NewMailService("<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bad0d5d2d494ded5dffaddd7dbd3d694d9d5d7">[emailÂ protected]</a>", "&lt;host&gt;:&lt;port&gt;")
email.AddReceivers("&lt;email&gt;")
email.AuthenticateSMTP("", "&lt;username&gt;", "&lt;password&gt;", "&lt;host&gt;")
</pre>
<p>è¦å‘Slackå‘é€é€šçŸ¥ï¼Œæ‚¨éœ€è¦åœ¨Slackä¸­åˆ›å»ºä¸€ä¸ªwebhookï¼Œå®ƒå°†ä¸ºæ‚¨æä¾›ä¸€ä¸ªæƒŸä¸€çš„URLï¼Œæˆ‘ä»¬å°†éœ€è¦è¿™ä¸ªURLæ¥é…ç½®è¿™ä¸ªåŒ…ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥å†³å®šä½¿ç”¨é€šçŸ¥å»ºè®®ï¼Œå®ƒå¯ä»¥ä¸ä»¥ä¸‹å†…å®¹ä¸€èµ·å®‰è£…:</p>
<pre class="language-bash hljs">go get github.com/slack-go/slack
</pre>
<p>ç„¶è€Œï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªåŒ…åŒ…å«äº†ä¸€ä¸ªbugã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸“é—¨ä¸ºæ­¤é¡¹ç›®å®æ–½äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ:</p>
<pre class="language-golang hljs">func (s Slack) Send(ctx context.Context, subject, message string) error {
    data := map[string]string{
        "text": "```\n" + message + "\n```",
    }
    j, err := json.Marshal(data)
    if err != nil {
        log.Fatal(err)
    }
    url := "https://hooks.slack.com/services/..."
    resp, err := http.Post(url, "application/json", bytes.NewBuffer(j))
    if err != nil {
        return err
    }
    var res map[string]interface{}
    json.NewDecoder(resp.Body).Decode(&amp;res)
    return nil
}
</pre>
<p>æŸ¥çœ‹Notify æ”¯æŒçš„<a href="https://github.com/nikoksr/notify/tree/main/service">å¤–éƒ¨æœåŠ¡åˆ—è¡¨ã€‚</a></p>
<h2 id="adding-services-notify">æ·»åŠ è¦é€šçŸ¥çš„æœåŠ¡</h2>
<p>åœ¨æ·»åŠ è¦é€šçŸ¥çš„æœåŠ¡ä¹‹å‰ï¼Œå¿…é¡»å®ä¾‹åŒ–æ¯ä¸ªæœåŠ¡åº“ï¼Œè¿™å°†éœ€è¦ä¸€ä¸ªæˆ–å¤šä¸ªAPIé”®æˆ–ä¸€äº›å…¶ä»–è®¾ç½®ã€‚å¯ä»¥ä½¿ç”¨<code>UseServices()</code>æ·»åŠ è¿™äº›æœåŠ¡:</p>
<pre class="language-golang hljs">notify.UseService(slack, telegram, ...) 


slack := SlackService()
slack.AddReceiver("CHANNEL_ID")
notify.UseServices(slack, ...)


email := emailService()
email.AddReceivers("<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4a20252224642e252f0a2d272b232664292527">[emailÂ protected]</a>")
notify.UseServices(email)
</pre>
<h2 id="sending-notifications">å‘é€é€šçŸ¥</h2>
<p>æ·»åŠ æœåŠ¡åï¼ŒNotifyå°†ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å‘å¤–éƒ¨æœåŠ¡å‘é€æ¶ˆæ¯:</p>
<pre class="language-golang hljs">err := notify.Send(
    context.Background(),
    "Demo App:: Attention required", // notification title
    message,
)
if err != nil {
    log.Fatal(err.Error())
}
</pre>
<h2 id="logger">è®°å½•å™¨</h2>
<p><code>Logger</code>æ˜¯ä¸€ä¸ªå¤„ç†å‘å„ç§æœåŠ¡å‘é€é”™è¯¯æ¶ˆæ¯çš„åŠŸèƒ½ã€‚å®ƒè¿˜å…è®¸æˆ‘ä»¬å°†æ¶ˆæ¯è®°å½•åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶éšåé€šè¿‡ä¸€ä¸ªç«¯ç‚¹æä¾›ç»™æˆ‘ä»¬çš„ä»ªè¡¨æ¿:</p>
<pre class="language-golang hljs">func (l *Logger) Log(message string) {
    services := map[string]notify.Notifier{
        "email": mailService(),
        "slack": slackService(),
    }
    var wg sync.WaitGroup
    for _, v := range l.services {
        if _, ok := services[v]; !ok {
            continue
        }
        wg.Add(1)
        v := v
        go (func() {
            defer wg.Done()
            notify.UseServices(services[v])
            err := notify.Send(
                context.Background(),
                "Demo App:: Attention required",
                message,
            )
            if err != nil {
                log.Fatal(err.Error())
            }
            now := time.Now()
            logToFile(&amp;LocalLog{
                ServiceName: v,
                Date:        now.Format(time.RFC3339),
                Environment: "production", // staging, dev, etc.
                Message:     message,
            })
        })()
    }
    wg.Wait()
}


func logToFile(payload *LocalLog) {
    f, err := os.OpenFile("local.log", os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0644)
    if err != nil {
        log.Fatal(err)
    }
    res := fmt.Sprintf("[%v]::[%s]::[%s]:: %s", payload.ServiceName, payload.Environment, payload.Date, payload.Message)
    _, err = f.WriteString(res + "\n")
    if err != nil {
        log.Fatal(err)
    }
    f.Close()
}
</pre>
<p>ç«¯ç‚¹æ˜¯<code>alert.go</code>æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒéœ€è¦ä¸€ä¸ªæœåŠ¡å™¨ã€‚ä¸ºäº†ç¡®ä¿å®ƒä¸æˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒæœåŠ¡å™¨å¹¶å‘è¿è¡Œï¼Œæˆ‘ä»¬å°†å®ƒåŒ…å«åœ¨ä¸€ä¸ªgoroutineä¸­ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†ç«¯ç‚¹å¤„ç†ç¨‹åºå¦‚ä½•ä»æ—¥å¿—æ–‡ä»¶ä¸­è¯»å–æ•°æ®æµã€‚è¯·æ³¨æ„ï¼Œæ–‡ä»¶è®°å½•å™¨å¯ä»¥ç”¨å…¶ä»–å½¢å¼çš„æ•°æ®åº“ä»£æ›¿ï¼Œå¦‚MongoDBã€Firebaseç­‰:</p>
<pre class="language-golang hljs">func (a *Alert) Server(port string) {
    e := echo.New()
    UseCors(e)
    e.GET("/logs", handleLogs)

    go func() {
        e.Logger.Fatal(e.Start(port))
    }()
}
</pre>
<h2 id="using-svelte-tailwind-css-frontend">åœ¨å‰ç«¯ä½¿ç”¨è‹—æ¡å’Œé¡ºé£CSS</h2>
<p>è¦è®¾ç½®å‰ç«¯çš„è‹—æ¡ï¼Œæˆ‘ä»¬å»ºè®®éµå¾ª<a href="https://svelte.dev/">è‹—æ¡ç½‘ç«™</a>ä¸Šçš„è¯´æ˜ã€‚Svelteæ˜¯ä¸€ä¸ªå¼ºå¤§è€Œé«˜æ•ˆçš„JavaScriptæ¡†æ¶ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ„å»ºé«˜æ€§èƒ½çš„webåº”ç”¨ç¨‹åºã€‚</p>
<p>ä¸ºäº†å¢åŠ è¶£å‘³ï¼Œæˆ‘ä»¬å°†ç»“åˆä½¿ç”¨Svelteå’Œä¸€ä¸ªæµè¡Œçš„å®ç”¨ä¼˜å…ˆçš„CSSæ¡†æ¶Tailwindï¼Œæ¥åˆ›å»ºä¸€ä¸ªç®€å•ä¸”å“åº”è¿…é€Ÿçš„ä»ªè¡¨æ¿ã€‚Tailwindé€šè¿‡æä¾›å¯è½»æ¾åº”ç”¨äºç»„ä»¶çš„é¢„è®¾è®¡CSSç±»ï¼Œæ”¯æŒå¿«é€Ÿå¼€å‘å’ŒåŸå‹åˆ¶ä½œ:</p>
<pre class="language-golang hljs">&lt;script lang="ts"&gt;
import TableList from "./components/TableList.svelte";
  import Tailwindcss from "./components/Tailwind.svelte";
  import Layout from "./components/Layout.svelte";
  import Modal from "./components/Modal.svelte";
  import Footer from "./components/Footer.svelte";
&lt;/script&gt;
&lt;main&gt;
  &lt;Tailwindcss /&gt;
  &lt;Modal /&gt;
  &lt;Layout&gt;
  &lt;TableList /&gt;
  &lt;/Layout&gt;
  &lt;Footer /&gt;
&lt;/main&gt;




&lt;table
    class="w-full border-collapse bg-white text-left text-sm text-gray-500"
  &gt;
    &lt;thead class="bg-gray-50"&gt;
      &lt;tr&gt;
        &lt;th scope="col" class="px-6 py-4 font-medium text-gray-900"&gt;Service&lt;/th&gt;
        &lt;th scope="col" class="px-6 py-4 font-medium text-gray-900"
          &gt;Environment&lt;/th
        &gt;
        &lt;!-- &lt;th scope="col" class="px-6 py-4 font-medium text-gray-900"&gt;Status&lt;/th&gt; --&gt;
        &lt;th scope="col" class="px-6 py-4 font-medium text-gray-900"&gt;Message&lt;/th&gt;
        &lt;th scope="col" class="px-6 py-4 font-medium text-gray-900"&gt;Date&lt;/th&gt;
        &lt;th scope="col" class="px-6 py-4 font-medium text-gray-900" /&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody class="divide-y divide-gray-100 border-t border-gray-100"&gt;
      {#each $logs as log}
        &lt;TableRow payload={log} /&gt;
      {/each}
    &lt;/tbody&gt;
  &lt;/table&gt;
</pre>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä»ªè¡¨æ¿UIï¼Œå®ƒåˆ—å‡ºäº†ä»æˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒæœåŠ¡å™¨æŠ¥å‘Šçš„é”™è¯¯:</p>
<p><img data-attachment-id="159897" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/dashboard-ui-lists-errors/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png" data-orig-size="730,427" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Dashboard UI that lists the errors reported" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors-300x175.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png" decoding="async" class="aligncenter size-full wp-image-159897 jetpack-lazy-image" src="../Images/1952d0de9322ae77290f60ad43b865cd.png" alt="Dashboard UI That Lists The Errors Reported" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors-300x175.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="159897" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/dashboard-ui-lists-errors/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png" data-orig-size="730,427" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Dashboard UI that lists the errors reported" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors-300x175.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-159897" src="../Images/1952d0de9322ae77290f60ad43b865cd.png" alt="Dashboard UI That Lists The Errors Reported" srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors-300x175.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/dashboard-ui-lists-errors.png"/></noscript>
<h2 id="setting-up-test-environment">è®¾ç½®æµ‹è¯•ç¯å¢ƒ</h2>
<p>ä¸ºäº†æµ‹è¯•æˆ‘ä»¬çš„é¡¹ç›®åŠå…¶é›†æˆï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒã€‚</p>
<p>ä¸€ä¸ªé¡µé¢è¢«åˆ›å»ºå¹¶é“¾æ¥åˆ°<code>alert.Log()</code>ï¼Œå®ƒä¹Ÿè¢«æ·»åŠ åˆ°<a href="http://echo.labstack.com/">å›é€åº“</a> <code>HTTPErrorHandler</code>ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ•è·å¹¶è®°å½•æ‰€æœ‰é¡µé¢é”™è¯¯ï¼Œç„¶åå°†è¿™äº›é”™è¯¯ä½œä¸ºæ¶ˆæ¯å‘é€ç»™å¯ç”¨çš„æ¶ˆæ¯æœåŠ¡:</p>
<pre class="language-golang hljs">// integration
var alert = NewAlert()

func main() {
    alert.Server(":1323")
    alert.SetNotificationService("email", "slack", "telegram")

   e := echo.New()
    e.HTTPErrorHandler = CustomHTTPErrorHandler

    e.GET("/", func(c echo.Context) error {
    alert.Log(fmt.Sprintf("LOG:[%v] error occured here this is a sample for error logger", t))
        return c.String(http.StatusOK, "alert-notify is integerated with the endpoint !")
    })
    e.Logger.Fatal(e.Start(":9000"))
}

func CustomHTTPErrorHandler(err error, c echo.Context) {
    if er, ok := err.(*echo.HTTPError); ok {
        alert.Log(string(er.Error()))
        c.Logger().Error(err)
    }
}
</pre>
<p>ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªæ‰¾ä¸åˆ°çš„é¡µé¢ï¼Œå¯¼è‡´äº†ä¸€ä¸ªé”™è¯¯ï¼Œéœ€è¦ä½¿ç”¨Notifyå‘æˆ‘ä»¬çš„ç³»ç»ŸæŠ¥å‘Šã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨Echoçš„<code>CustomHTTPErrorHandler(err error, c echo.Context)</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°æ•è·HTTPé”™è¯¯:</p>
<p><img data-attachment-id="159899" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/error-pages-needs-reporting/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png" data-orig-size="730,505" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Error page that needs reporting" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting-300x208.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png" decoding="async" class="aligncenter size-full wp-image-159899 jetpack-lazy-image" src="../Images/f8ebfda59171ce65bfb6a40e31944c7a.png" alt="Error Page That Needs Reporting" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting-300x208.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="159899" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/error-pages-needs-reporting/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png" data-orig-size="730,505" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Error page that needs reporting" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting-300x208.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-159899" src="../Images/f8ebfda59171ce65bfb6a40e31944c7a.png" alt="Error Page That Needs Reporting" srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting-300x208.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/error-pages-needs-reporting.png"/></noscript>
<p>ä¸€æ—¦ç³»ç»ŸæŠ¥å‘Šäº†é”™è¯¯ï¼Œå®šåˆ¶çš„æ§åˆ¶é¢æ¿å°†æ˜¾ç¤ºç›¸åº”çš„æ—¥å¿—:</p>
<p><img data-attachment-id="159901" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/custom-built-dashboard-displays-logs/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png" data-orig-size="730,112" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Custom built dashboard displays corresponding logs" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs-300x46.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png" decoding="async" class="aligncenter size-full wp-image-159901 jetpack-lazy-image" src="../Images/439eac00111fa3105a608e4e51198392.png" alt="Custom Built Dashboard Displays Corresponding Logs" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs-300x46.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="159901" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/custom-built-dashboard-displays-logs/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png" data-orig-size="730,112" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Custom built dashboard displays corresponding logs" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs-300x46.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-159901" src="../Images/439eac00111fa3105a608e4e51198392.png" alt="Custom Built Dashboard Displays Corresponding Logs" srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs-300x46.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/custom-built-dashboard-displays-logs.png"/></noscript>
<p>å¦‚æœå¤–éƒ¨æœåŠ¡è¢«é€‚å½“åœ°é…ç½®ï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°æˆ‘ä»¬çš„æ¶ˆæ¯è¢«ä¼ é€’ğŸ‰ã€‚</p>
<p>ä¸‹é¢æ˜¯Slackå’Œemail ( <a href="http://mailtrap.io/"> Mailtrap </a>)çš„é¢„è§ˆ:</p>
<p><img data-attachment-id="159903" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/slack-preview/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png" data-orig-size="730,169" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Slack preview" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview-300x69.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png" decoding="async" class="aligncenter size-full wp-image-159903 jetpack-lazy-image" src="../Images/b8bcc4d5b1d82f67bddac6ae2fb5fe68.png" alt="Slack Preview" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview-300x69.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="159903" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/slack-preview/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png" data-orig-size="730,169" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Slack preview" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview-300x69.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-159903" src="../Images/b8bcc4d5b1d82f67bddac6ae2fb5fe68.png" alt="Slack Preview" srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview-300x69.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/slack-preview.png"/></noscript>
<p><img data-attachment-id="159908" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/email-preview/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png" data-orig-size="730,229" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Email preview" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview-300x94.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png" decoding="async" class="aligncenter size-full wp-image-159908 jetpack-lazy-image" src="../Images/7cb6a129926508f8afb37ac28c8ac14c.png" alt="Email Preview" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview-300x94.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="159908" data-permalink="https://blog.logrocket.com/build-internal-error-notification-system-go-svelte/attachment/email-preview/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png" data-orig-size="730,229" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Email preview" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview-300x94.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-159908" src="../Images/7cb6a129926508f8afb37ac28c8ac14c.png" alt="Email Preview" srcset="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png 730w, https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview-300x94.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2023/02/email-preview.png"/></noscript>
<h2 id="conclusion">ç»“è®º</h2>
<p>ä½¿ç”¨Goæ„å»ºå†…éƒ¨é”™è¯¯é€šçŸ¥ç³»ç»Ÿå¯ä»¥ä¸ºç›‘æ§å’Œå¤„ç†åº”ç”¨ç¨‹åºä¸­çš„é”™è¯¯æä¾›ä¸€ä¸ªå¼ºå¤§è€Œé«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚Goå¤„ç†å¹¶å‘å’Œé«˜æ€§èƒ½ç½‘ç»œçš„èƒ½åŠ›ä»¥åŠNotifyä½¿å®ƒæˆä¸ºç³»ç»Ÿåç«¯çš„ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚æœ‰äº†è¿™ä¸ªç³»ç»Ÿï¼Œæ‚¨çš„å¼€å‘å›¢é˜Ÿå°†èƒ½å¤Ÿå¿«é€Ÿæœ‰æ•ˆåœ°è¯†åˆ«å’Œè§£å†³é”™è¯¯ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„æ•´ä½“ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p>
<p>æŸ¥çœ‹è¯¥é¡¹ç›®çš„<a href="https://github.com/iamhabbeboy/notify-system"> GitHubåº“</a>ã€‚</p><div class="code-block code-block-4">
<div class="blog-plug base-cta"><h2>ä½¿ç”¨<a class="signup" href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>æ¶ˆé™¤ä¼ ç»Ÿé”™è¯¯æŠ¥å‘Šçš„å¹²æ‰°</h2>
<a href="https://lp.logrocket.com/blg/signup" class="signup" target="_blank" rel="noopener noreferrer"><img class="alignnone size-full wp-image-46 jetpack-lazy-image" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/><noscript><img data-lazy-fallback="1" class="alignnone size-full wp-image-46" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/></noscript></a>
<p><a href="https://lp.logrocket.com/blg/signup" target="_blank" rel="noopener noreferrer"> LogRocket </a>æ˜¯ä¸€ä¸ªæ•°å­—ä½“éªŒåˆ†æè§£å†³æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥ä¿æŠ¤æ‚¨å…å—æ•°ç™¾ä¸ªå‡é˜³æ€§é”™è¯¯è­¦æŠ¥çš„å½±å“ï¼Œåªé’ˆå¯¹å‡ ä¸ªçœŸæ­£é‡è¦çš„é¡¹ç›®ã€‚LogRocketä¼šå‘Šè¯‰æ‚¨åº”ç”¨ç¨‹åºä¸­å®é™…å½±å“ç”¨æˆ·çš„æœ€å…·å½±å“åŠ›çš„bugå’ŒUXé—®é¢˜ã€‚</p>
<p>ç„¶åï¼Œä½¿ç”¨å…·æœ‰æ·±å±‚æŠ€æœ¯é¥æµ‹çš„ä¼šè¯é‡æ”¾æ¥ç¡®åˆ‡åœ°æŸ¥çœ‹ç”¨æˆ·çœ‹åˆ°äº†ä»€ä¹ˆä»¥åŠæ˜¯ä»€ä¹ˆå¯¼è‡´äº†é—®é¢˜ï¼Œå°±åƒä½ åœ¨ä»–ä»¬èº«åçœ‹ä¸€æ ·ã€‚</p>
<p>LogRocketè‡ªåŠ¨èšåˆå®¢æˆ·ç«¯é”™è¯¯ã€JSå¼‚å¸¸ã€å‰ç«¯æ€§èƒ½æŒ‡æ ‡å’Œç”¨æˆ·äº¤äº’ã€‚ç„¶åLogRocketä½¿ç”¨æœºå™¨å­¦ä¹ æ¥å‘Šè¯‰ä½ å“ªäº›é—®é¢˜æ­£åœ¨å½±å“å¤§å¤šæ•°ç”¨æˆ·ï¼Œå¹¶æä¾›ä½ éœ€è¦ä¿®å¤å®ƒçš„ä¸Šä¸‹æ–‡ã€‚</p>
<p>å…³æ³¨é‡è¦çš„bugâ€”<a class="signup" href="https://lp.logrocket.com/blg/signup-issue-free" target="_blank" rel="noopener noreferrer">ä»Šå¤©å°±è¯•è¯•LogRocketã€‘ã€‚</a></p></div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>