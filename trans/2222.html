<html>
<head>
<title>Improve custom Hook debugging with useDebugValue - LogRocket Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>ä½¿ç”¨ useDebugValue - LogRocket åšå®¢æ”¹è¿›å®šåˆ¶é’©å­è°ƒè¯•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/#0001-01-01">https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/#0001-01-01</a></blockquote><div><article class="article-post">
<p>æ²¡æœ‰å¤ªå¤šå¼€å‘äººå‘˜çŸ¥é“<a href="https://reactjs.org/docs/hooks-reference.html#usedebugvalue" target="_blank" rel="noopener"> <code>useDebugValue</code>é’©å­</a>ï¼Œå°½ç®¡å®ƒåœ¨è°ƒè¯•å®šåˆ¶é’©å­æ—¶æä¾›äº†æ›´å¥½çš„è°ƒè¯•ä½“éªŒã€‚</p>
<p><code>useDebugValue</code>æ˜¯ä¸€ä¸ªç®€å•çš„å†…ç½®é’©å­ï¼Œå®ƒæä¾›äº†å…³äº<a href="https://blog.logrocket.com/debug-react-applications-with-the-new-react-devtools/" target="_blank" rel="noopener"> React DevTools </a>ä¸­å®šåˆ¶é’©å­å†…éƒ¨é€»è¾‘çš„æ›´å¤šä¿¡æ¯ã€‚å®ƒå…è®¸æ‚¨åœ¨è‡ªå®šä¹‰æŒ‚é’©æ—è¾¹æ˜¾ç¤ºé™„åŠ çš„ã€æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¹¶å¸¦æœ‰å¯é€‰çš„æ ¼å¼ã€‚</p>
<h2><code>useDebugValue</code>å’Œ React DevTools</h2>
<p><code>useDebugValue</code>åœ¨ React DevTools çš„<a href="https://github.com/facebook/react/tree/main/packages/react-devtools#inspecting-component-instances" target="_blank" rel="noopener">ç»„ä»¶æ£€æŸ¥å™¨</a>ä¸­æ‰©å±•äº†å®šåˆ¶é’©å­æ•°æ®çš„å¯è§†åŒ–ã€‚ä½ å¯ä»¥å°†<code>React DevTools</code>å®‰è£…ä¸º<a href="https://www.npmjs.com/package/react-devtools" target="_blank" rel="noopener">ç‹¬ç«‹åº”ç”¨</a>æˆ–<a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi" target="_blank" rel="noopener">æµè§ˆå™¨æ‰©å±•</a>ã€‚</p>
<p>ä¸‹ä¸€ä¸ªæˆªå›¾æ˜¾ç¤ºäº† React DevTools Chrome æ‰©å±•çš„<strong>ç»„ä»¶</strong>é€‰é¡¹å¡ã€‚</p>
<p><img data-attachment-id="70241" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/components-tab-react-devtools-chrome-extension/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png" data-orig-size="730,589" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="components-tab-react-devtools-chrome-extension" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension-300x242.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png" decoding="async" class="aligncenter size-full wp-image-70241 jetpack-lazy-image" src="../Images/5944749f83824d03dcd63aa8ba86b365.png" alt="The Components tab of the React DevTools Chrome extension" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension-300x242.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70241" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/components-tab-react-devtools-chrome-extension/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png" data-orig-size="730,589" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="components-tab-react-devtools-chrome-extension" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension-300x242.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-70241" src="../Images/5944749f83824d03dcd63aa8ba86b365.png" alt="The Components tab of the React DevTools Chrome extension" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension-300x242.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/components-tab-react-devtools-chrome-extension.png"/></noscript>
<p>è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åˆ©ç”¨<code>useDebugValue</code>é’©å­ã€‚è€ƒè™‘è¿™ä¸ªç›¸å½“ç®€å•çš„å®šåˆ¶å–é’©å­ã€‚</p>
<pre class="language-javascript hljs">import { useEffect, useState } from "react";

export const useFetch = (url) =&gt; {
  const [response, setResponse] = useState([]);
  const [error, setError] = useState(null);
  useEffect(() =&gt; {
    async function fetchFiles() {
      try {
        const response = await fetch(url);
        const json = await response.json();
        setResponse(json);
      } catch (error) {
        setError(error);
      }
    }
    fetchFiles();
  }, [setError, setResponse, url]);
  return [response, error];
};
</pre>
<p>è¿™å°±æ˜¯é’©å­æ•°æ®çš„æ˜¾ç¤ºæ–¹å¼ã€‚</p>
<p><img data-attachment-id="70243" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/debug-information-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png" data-orig-size="730,577" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="debug-information-output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output-300x237.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png" decoding="async" class="aligncenter size-full wp-image-70243 jetpack-lazy-image" src="../Images/969a8fda5971ed137b62356e17d43013.png" alt="The debug information output" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output-300x237.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70243" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/debug-information-output/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png" data-orig-size="730,577" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="debug-information-output" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output-300x237.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-70243" src="../Images/969a8fda5971ed137b62356e17d43013.png" alt="The debug information output" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output-300x237.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-information-output.png"/></noscript>
<p>è°ƒè¯•ä¿¡æ¯ä»…é™äºæ˜¾ç¤ºæˆ‘ä»¬çš„é’©å­å†…éƒ¨ä½¿ç”¨çš„å…¶ä»–å†…ç½® React é’©å­çš„ä¿¡æ¯(åœ¨æœ¬ä¾‹ä¸­æ˜¯<code>useState</code>å’Œ<code>useEffect</code>)ã€‚æ­¤å¤–ï¼Œè¿™äº›ä¿¡æ¯å¾ˆéš¾é˜…è¯»ï¼Œå› ä¸ºæ²¡æœ‰æè¿°æ€§çš„æ ‡ç­¾â€”â€”æ‚¨å¿…é¡»è®¡ç®—è¾“å‡ºä¸­çš„æ¯ä¸€è¡Œï¼Œä»¥ä¾¿çŸ¥é“å“ªäº›æ¡ç›®æ˜ å°„å¯¹åº”äºä»£ç åº“å†…éƒ¨è°ƒç”¨çš„é’©å­ã€‚</p>
<p>åœ¨å†…ç½®çš„<code>useDebugValue</code>é’©å­çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ºè‡ªå®šä¹‰é’©å­å‘ React DevTools è¾“å‡ºæ·»åŠ é¢å¤–çš„æ¡ç›®æ¥æ”¹å–„è¿™ç§æƒ…å†µã€‚</p>
<pre class="language-javascript hljs">import { useEffect, useDebugValue, useState } from "react";

export const useFetch = (url) =&gt; {
  useDebugValue(url);
  const [response, setResponse] = useState([]);
  const clown = "ğŸ¤¡";
  useDebugValue(`crazy ${clown}`);
  const [error, setError] = useState(null);
  const [httpResponse, setHttpResponse] = useState();
  useDebugValue(
    httpResponse ? "status code " + httpResponse.status : "no response"
  );
  useDebugValue(error, (e) =&gt;
    e ? `fetch failed due to ${e.message}` : "fetch successful"
  );
  useEffect(() =&gt; {
    async function fetchFiles() {
      try {
        const response = await fetch(url);
        setHttpResponse(response);
        const json = await response.json();
        setResponse(json);
      } catch (error) {
        setError(error);
      }
    }
    fetchFiles();
  }, [setError, setResponse, url]);
  useDebugValue(response, (mp3s) =&gt;
    mp3s.length &gt; 0 ? mp3s.map((mp3) =&gt; mp3.label) : "no mp3s loaded"
  );
  return [response, error];
}
</pre>
<p>ä¸‹ä¸€ä¸ªå±å¹•æˆªå›¾æ˜¾ç¤ºäº†å‡ºç°ç½‘ç»œé”™è¯¯æ—¶çš„è¾“å‡ºã€‚</p>
<p><img data-attachment-id="70245" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/debug-output-fetch-error-case/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png" data-orig-size="730,356" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="debug-output-fetch-error-case" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case-300x146.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png" decoding="async" class="aligncenter size-full wp-image-70245 jetpack-lazy-image" src="../Images/7e07bae4757f00652e09b33234e24645.png" alt="Debug output for the fetch error case" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case-300x146.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70245" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/debug-output-fetch-error-case/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png" data-orig-size="730,356" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="debug-output-fetch-error-case" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case-300x146.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-70245" src="../Images/7e07bae4757f00652e09b33234e24645.png" alt="Debug output for the fetch error case" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case-300x146.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-fetch-error-case.png"/></noscript>
<p>å±•å¼€çš„<code>DebugValue</code>æ¡ç›®æŒ‰ç…§æºä»£ç ä¸­å‡ºç°çš„é¡ºåºåˆ—å‡ºäº†<code>useDebugValue</code>è°ƒç”¨çš„è¾“å‡ºã€‚ä¸åŒçš„æ¡ç›®æ˜¾ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¿™ä¸ªé’©å­ã€‚å°ä¸‘æ¡ç›®å¹¶æ²¡æœ‰é‚£ä¹ˆä¸¥è‚ƒï¼Œä½†æ˜¯å®ƒè¡¨æ˜æ‚¨å¯ä»¥æ³¨é”€ä»»ä½•æ‚¨æƒ³è¦çš„ä¸œè¥¿â€”â€”æ•°å­—ã€å­—ç¬¦ä¸²å’Œå¯¹è±¡ï¼Œè€Œä¸ä»…ä»…æ˜¯è‡ªå®šä¹‰é’©å­çš„å‡½æ•°å‚æ•°æˆ–çŠ¶æ€å˜é‡ã€‚</p>
<p>ç¬¬ä¸‰åˆ°ç¬¬äº”é¡¹æ¼”ç¤ºäº†<a href="https://reactjs.org/docs/hooks-reference.html#defer-formatting-debug-values" target="_blank" rel="noopener">å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°</a>å¯¹<code>useDebugValue</code>é’©å­çš„ä½¿ç”¨ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå®ƒæ¥æ”¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸­æŒ‡å®šçš„æ•°æ®ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„æ˜¾ç¤ºå€¼ã€‚</p>
<p>è¿™æ˜¯ä¸ºäº†åœ¨è®¡ç®—è¦æ˜¾ç¤ºçš„å€¼çš„å¼€é”€å¾ˆå¤§çš„æƒ…å†µä¸‹æ¨è¿Ÿæ ¼å¼åŒ–ã€‚å¦‚æœæ‚¨ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œå½“æ‚¨åœ¨ React DevTools ä¸­æ£€æŸ¥è‡ªå®šä¹‰é’©å­æ—¶ï¼Œè¿™ä¸ªå‡½æ•°é¦–å…ˆè¢«æ‰§è¡Œã€‚</p>
<h2><code>useDebugValue</code>çš„å±€é™æ€§</h2>
<p>å½“ç„¶ï¼Œç”±äºé’©å­çš„<a href="https://reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener">è§„åˆ™ï¼Œæ‚¨ä¸èƒ½ä½¿ç”¨<code>useDebugValue</code>æ³¨é”€æ¡ä»¶å’ŒåµŒå¥—æ•°æ®ã€‚</a></p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ä½¿ç”¨äº†ä¸€ä¸ªé¢å¤–çš„çŠ¶æ€å˜é‡<code>httpResponse</code>ï¼Œæ¥è®¿é—®å“åº”çš„çŠ¶æ€ä»£ç ã€‚æé†’ä¸€ä¸‹ï¼Œè¿™æ˜¯ç”±äºé’©å­çš„è§„åˆ™ï¼Œå®ƒåªå…è®¸é’©å­ç”¨åœ¨åŠŸèƒ½æ€§ React ç»„ä»¶æˆ–å®šåˆ¶é’©å­çš„é¡¶å±‚ã€‚</p>
<p>æ ¹æ®<a href="https://reactjs.org/docs/hooks-reference.html#defer-formatting-debug-values" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ï¼Œ<code>useDebugValue</code>åªèƒ½åœ¨è‡ªå®šä¹‰æŒ‚é’©çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚å¦‚æœæ‚¨åœ¨ React åŠŸèƒ½ç»„ä»¶çš„é¡¶å±‚æ”¾ç½®ä¸€ä¸ªé’©å­è°ƒç”¨ï¼ŒReact DevTools ä¸­å°†ä¸ä¼šå‡ºç°æ—¥å¿—è¾“å‡ºã€‚</p>
<pre class="language-javascript hljs">const AwesomeComponent = () =&gt; {
  useDebugValue("hey there"); // this does not work
  return &lt;div&gt;what's up?&lt;/div&gt;;
};
</pre>
<h2>ä¸º<code>useState</code>è°ƒè¯•æ”¹è¿› React DevTools è¾“å‡º</h2>
<p>æœ¬èŠ‚æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>useDebugValue</code>é’©å­æ¥æ”¹è¿›å…³äº<code>useState</code>é’©å­çš„è°ƒè¯•ä¿¡æ¯ã€‚</p>
<p>å½“æ‚¨åœ¨ä¸€ä¸ªç»„ä»¶æˆ–å®šåˆ¶é’©å­ä¸­ä½¿ç”¨å‡ ä¸ª<code>useState</code>é’©å­æ—¶ï¼Œæ‚¨å¯èƒ½ç†Ÿæ‚‰ React DevTools çš„å¯è·Ÿè¸ªæ€§é—®é¢˜:React DevTools ä¸æ˜¾ç¤ºçŠ¶æ€æ¡ç›®çš„æè¿°æ€§æ ‡ç­¾ã€‚</p>
<p>ä¸‹é¢æ˜¯ä½¿ç”¨<code>useFetch</code>é’©å­çš„è¾“å‡ºã€‚</p>
<figure id="attachment_70247" aria-describedby="caption-attachment-70247" class="wp-caption aligncenter"><img data-attachment-id="70247" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/debug-output-with-usefetch-hook/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png" data-orig-size="730,193" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="debug-output-with-usefetch-hook" data-image-description="" data-image-caption="&lt;p&gt;React DevTools does not show a descriptive label for state entries&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook-300x79.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png" decoding="async" class="size-full wp-image-70247 jetpack-lazy-image" src="../Images/87492562b6b1bc40e4684b58f285be59.png" alt="Debug output for with the useFetch Hook." data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook-300x79.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png"/><noscript><img data-lazy-fallback="1" data-attachment-id="70247" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/debug-output-with-usefetch-hook/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png" data-orig-size="730,193" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="debug-output-with-usefetch-hook" data-image-description="" data-image-caption="&lt;p&gt;React DevTools does not show a descriptive label for state entries&lt;/p&gt;&#10;" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook-300x79.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png" decoding="async" loading="lazy" class="size-full wp-image-70247" src="../Images/87492562b6b1bc40e4684b58f285be59.png" alt="Debug output for with the useFetch Hook." srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook-300x79.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/debug-output-with-usefetch-hook.png"/></noscript><figcaption id="caption-attachment-70247" class="wp-caption-text">React DevTools does not show a descriptive label for state entries</figcaption></figure>
<p>å‡è®¾æ‚¨é€‰æ‹©äº†ä¸€ä¸ªå…·æœ‰å¤šä¸ªå¸ƒå°”çŠ¶æ€å˜é‡çš„ç»„ä»¶ã€‚ä»é•¿è¿œæ¥çœ‹ï¼Œæ€»æ˜¯éœ€è¦æ³¨æ„å®ƒä»¬çš„é¡ºåºï¼Œä»¥ä¾¿å°†çŠ¶æ€æ¡ç›®ä¸æºä»£ç ä¸­ç›¸åº”çš„<code>useState</code>è°ƒç”¨ç›¸å…³è”ï¼Œè¿™å°†æ˜¯ä»¤äººç–²æƒ«çš„ã€‚</p>
<p>è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨å¤šä¸ªâ€œåŸå­â€çŠ¶æ€å˜é‡æ˜¯æ›´å¥½çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ç”¨å•ä¸ªå¯¹è±¡æ”¶é›†æ¯ä¸ªçŠ¶æ€â€œå·¥ä»¶â€ã€‚ç”±äº<code>useState</code>é’©å­ä¸æä¾›ç±»ä¼¼äº<a href="https://reactjs.org/docs/react-component.html#setstate"> setState </a>æ–¹æ³•çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä½¿ç”¨â€œåŸºäºç±»çš„å•ä¸€çŠ¶æ€å¯¹è±¡æ¨¡å¼â€ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºä½ å¿…é¡»å°å¿ƒåœ°å®Œå…¨å…‹éš†å¤æ‚çš„çŠ¶æ€å¯¹è±¡ï¼Œå¹¶ä¸”åªæ›´æ–°ç›¸å…³çš„éƒ¨åˆ†ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åˆ©ç”¨<code>useDebugState</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå¦ä¸€ä¸ªè‡ªå®šä¹‰æŒ‚é’©ã€‚</p>
<pre class="language-javascript hljs">// useComponentState.js
import { useState, useDebugValue } from "react";

export function useComponentState(initialValue, name) {
  const [value, setValue] = useState(initialValue);
  useDebugValue(`${name}: ${value}`);
  return [value, setValue];
}
</pre>
<p>è®©æˆ‘ä»¬æ›¿æ¢æˆ‘ä»¬çš„<code>useFetch</code>é’©å­ä¸­çš„<code>useState</code>è°ƒç”¨ã€‚</p>
<pre class="language-javascript hljs">import { useEffect, useDebugValue } from "react";

import { useComponentState } from "./useComponentState";
const useFetch = (url) =&gt; {
  useDebugValue(url, (url) =&gt; `url: ${url}`);
  const [response, setResponse] = useComponentState([], "fetched mp3s");
  const [error, setError] = useComponentState(null, "fetch error");
  useEffect(() =&gt; {
    async function fetchFiles() {
      try {
        const response = await fetch(url);
        const json = await response.json();
        setResponse(json);
      } catch (error) {
        setError(error);
      }
    }
    fetchFiles();
  }, [setError, setResponse, url]);
  useDebugValue(response, (mp3s) =&gt; mp3s.map((mp3) =&gt; mp3.label));
  return [response, error];
};
</pre>
<p>ç°åœ¨çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ã€‚æ›´å®¹æ˜“æ‰¾å‡ºä½ çš„çŠ¶æ€å˜é‡æ˜¾ç¤ºåœ¨å“ªé‡Œã€‚</p>
<p><img data-attachment-id="70252" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/react-devtools-render-labels-state-values/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png" data-orig-size="730,244" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="react-devtools-render-labels-state-values" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values-300x100.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png" decoding="async" class="aligncenter size-full wp-image-70252 jetpack-lazy-image" src="../Images/5440ea0bdb3d5c6d15767b5a33bf1c69.png" alt="React DevTools now renders labels with state values" data-lazy-srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values-300x100.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png"/></p><noscript><img data-lazy-fallback="1" data-attachment-id="70252" data-permalink="https://blog.logrocket.com/improve-custom-hook-debugging-with-usedebugvalue/react-devtools-render-labels-state-values/" data-orig-file="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png" data-orig-size="730,244" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="react-devtools-render-labels-state-values" data-image-description="" data-image-caption="" data-medium-file="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values-300x100.png" data-large-file="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png" decoding="async" loading="lazy" class="aligncenter size-full wp-image-70252" src="../Images/5440ea0bdb3d5c6d15767b5a33bf1c69.png" alt="React DevTools now renders labels with state values" srcset="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png 730w, https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values-300x100.png 300w" sizes="(max-width: 730px) 100vw, 730px" data-original-src="https://blog.logrocket.com/wp-content/uploads/2021/10/react-devtools-render-labels-state-values.png"/></noscript>
<h2>å‡¡äº‹éƒ½æœ‰ä»£ä»·</h2>
<p>åœ¨äº§å“ä»£ç ä¸­å¤§é‡ä½¿ç”¨<code>useDebugValue</code>å¯èƒ½ä¼šå¯¹åº”ç”¨ç¨‹åºçš„æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚æˆ‘ä¸è®¤ä¸ºæŠŠå®ƒç•™åœ¨æ‚¨çš„äº§å“ä»£ç ä¸­æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œä½†æ˜¯æ­£å¦‚å®˜æ–¹æ–‡æ¡£æ‰€è¯´ï¼ŒæŠŠå®ƒç•™åœ¨å…±äº«åº“ä¸­çš„å®šåˆ¶é’©å­çš„ä»£ç ä¸­å¯èƒ½æ˜¯å¥½çš„ã€‚</p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œåœ¨æœ¬æ–‡å‘è¡¨æ—¶ï¼Œè¿˜æ²¡æœ‰åŠæ³•åŸºäºç¯å¢ƒå˜é‡æœ‰æ¡ä»¶åœ°å‘ˆç°<code>useDebugValue</code>,å› ä¸ºé’©å­çš„è§„åˆ™é˜»æ­¢äº†æ¡ä»¶ä»£ç ä¸­çš„é’©å­è°ƒç”¨ã€‚</p>
<p>å¯¹æˆ‘æ¥è¯´ï¼Œ<code>useDebugValue</code>æ˜¯æˆ‘å·¥å…·ç®±ä¸­çš„å¦ä¸€ä¸ªå·¥å…·ï¼Œæˆ‘åªåœ¨å¼€å‘å®šåˆ¶é’©å­æ—¶ä½¿ç”¨ï¼Œå¹¶åœ¨å°†é’©å­æ¨åˆ° Git åº“ä¹‹å‰åˆ é™¤ã€‚å®ƒå½“ç„¶æ„æˆäº†å¯¹æ—§çš„<code>console.log</code>è°ƒç”¨å’Œè°ƒè¯•æ–­ç‚¹çš„æ›¿ä»£ã€‚</p><div class="code-block code-block-17">
<div class="blog-plug inline-plug react-plug" vwo-el-id="26283398190">
<h2 vwo-el-id="41600691720">ä½¿ç”¨ LogRocket æ¶ˆé™¤ä¼ ç»Ÿååº”é”™è¯¯æŠ¥å‘Šçš„å™ªéŸ³</h2>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" vwo-el-id="19356441070">LogRocket
</a><p>æ˜¯ä¸€æ¬¾ React analytics è§£å†³æ–¹æ¡ˆï¼Œå¯ä¿æŠ¤æ‚¨å…å—æ•°ç™¾ä¸ªè¯¯æŠ¥é”™è¯¯è­¦æŠ¥çš„å½±å“ï¼Œåªé’ˆå¯¹å°‘æ•°çœŸæ­£é‡è¦çš„é¡¹ç›®ã€‚LogRocket å‘Šè¯‰æ‚¨ React åº”ç”¨ç¨‹åºä¸­å®é™…å½±å“ç”¨æˆ·çš„æœ€å…·å½±å“åŠ›çš„ bug å’Œ UX é—®é¢˜ã€‚</p><a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441380">
<img class="first-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/f300c244a1a1cf916df8b4cb02bec6c6.png" vwo-el-id="18272717540" data-lazy-loaded="1" data-original-src="https://files.readme.io/27c94e7-Image_2017-06-05_at_9.46.04_PM.png"/>
</a>
<a class="signup" href="https://lp.logrocket.com/blg/react-signup-general" target="_blank" rel="noopener noreferrer" vwo-el-id="19356441690">
<img class="second-react-image alignnone size-full wp-image-46 jetpack-lazy-image jetpack-lazy-image--handled" src="../Images/d6f5a5dd739296c1dd7aab3d5e77eeb9.png" alt="LogRocket Dashboard Free Trial Banner" vwo-el-id="30720362350" data-lazy-loaded="1" data-original-src="https://blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png"/>
</a>
<a href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="35866400580">LogRocket
</a><p>è‡ªåŠ¨èšåˆå®¢æˆ·ç«¯é”™è¯¯ã€ååº”é”™è¯¯è¾¹ç•Œã€è¿˜åŸçŠ¶æ€ã€ç¼“æ…¢çš„ç»„ä»¶åŠ è½½æ—¶é—´ã€JS å¼‚å¸¸ã€å‰ç«¯æ€§èƒ½æŒ‡æ ‡å’Œç”¨æˆ·äº¤äº’ã€‚ç„¶åï¼ŒLogRocket ä½¿ç”¨æœºå™¨å­¦ä¹ æ¥é€šçŸ¥æ‚¨å½±å“å¤§å¤šæ•°ç”¨æˆ·çš„æœ€å…·å½±å“åŠ›çš„é—®é¢˜ï¼Œå¹¶æä¾›æ‚¨ä¿®å¤å®ƒæ‰€éœ€çš„ä¸Šä¸‹æ–‡ã€‚</p><p vwo-el-id="28675661060">å…³æ³¨é‡è¦çš„ React bugâ€”<a class="signup" href="https://lp.logrocket.com/blg/react-signup-issue-free" target="_blank" rel="noopener noreferrer" vwo-el-id="40093418840">ä»Šå¤©å°±è¯•è¯• LogRocketã€‘ã€‚</a></p>
</div></div>

<p class="clearfix"/>
<p class="clearfix"/>
</article>

</div>    
</body>
</html>