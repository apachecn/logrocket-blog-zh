# ä½¿ç”¨ Vue æµ‹è¯•å·¥å…·æµ‹è¯• Vue.js ç»„ä»¶

> åŸæ–‡ï¼š<https://blog.logrocket.com/testing-vue-js-components-vue-test-utils/>

æˆ‘çŸ¥é“ï¼Œå¯¹äºè®¸å¤šå¼€å‘äººå‘˜æ¥è¯´ï¼Œæµ‹è¯•ä¼¼ä¹æ˜¯æµªè´¹æ—¶é—´ã€‚ä½ è®¨åŒå®ƒï¼Œå¯¹å—ï¼Ÿä½†æ˜¯ï¼Œä½ åº”è¯¥å—ï¼Ÿå¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªå¯é çš„åº”ç”¨ç¨‹åºï¼Œä½ åº”è¯¥æµ‹è¯•ä½ çš„ç»„ä»¶å—ï¼Ÿ

æˆ‘å°†å‘Šè¯‰ä½ æˆ‘çš„æƒ³æ³•:æµ‹è¯•ä½ çš„ç»„ä»¶(å¹¶ä¸”ï¼Œé‡è¦çš„æ˜¯ï¼Œä»¥æ­£ç¡®çš„æ–¹å¼å»åš)æ˜¯ä½ èƒ½åšçš„æœ€å¥½çš„æŠ•èµ„ä¹‹ä¸€ï¼Œå¦‚æœä½ æ­£åœ¨æ„å»ºä¸€äº›é•¿æœŸçš„ä¸œè¥¿ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘å°†å›ç­”è¿™äº›é—®é¢˜ï¼Œå¹¶é€šè¿‡åˆ†äº«å‡ ä¸ªå‘ç”Ÿåœ¨æˆ‘èº«ä¸Šçš„æ•…äº‹æ¥æ€»ç»“ä½¿ç”¨ [Vue æµ‹è¯•å·¥å…·](https://vue-test-utils.vuejs.org/)æµ‹è¯•ä½ çš„ Vue.js ç»„ä»¶çš„å¥½å¤„ã€‚ğŸ¤«

æˆ‘ä»¬å°†è®¨è®ºä»¥ä¸‹å†…å®¹:

## ä¸ºä»€ä¹ˆè¦æµ‹è¯• Vue.js ç»„ä»¶ï¼Ÿ

å½“æ‚¨å°†ä»£ç æ¨å‘ç”Ÿäº§æ—¶ï¼Œæ‚¨ä¸å¸Œæœ›å¼•å…¥ bugã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªå¯¹ä½ çš„ä»£ç åº“äº†å¦‚æŒ‡æŒçš„å¤©æ‰å¼€å‘äººå‘˜ï¼Œä½ å¯èƒ½ä¸ä¼š(ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘å·²ç»çœ‹åˆ°å¾ˆå¤šä¼˜ç§€çš„ã€è‡ªä¿¡çš„å·¥ç¨‹å¸ˆå¼•å…¥äº†ä»–ä»¬æ²¡æœ‰é¢„è§åˆ°çš„ç½•è§æƒ…å†µ)ã€‚

ä½†æ˜¯ï¼Œå½“ä½ è¢«å¤§é‡çš„å·¥ä½œå‹å¾—å–˜ä¸è¿‡æ°”æ¥ï¼Œå› ä¸ºä½ çš„å…¬å¸åœ¨å‘å±•ï¼Œä½ éœ€è¦é›‡ç”¨ä¸€äº›åˆçº§å‘˜å·¥æ¥ä¸æ–­æ”¹è¿›äº§å“ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿä»–ä»¬ä¼šå¼•å…¥ bug å—ï¼Ÿå¯èƒ½æ¯”ä½ æƒ³è±¡çš„æ›´é¢‘ç¹ã€‚

åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œå½“åˆçº§å¼€å‘äººå‘˜æ¨å‡ºç ´åæ‚¨æœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€çš„ä¸œè¥¿æ—¶ï¼Œæ‚¨ä¼šå¸Œæœ›åœ¨å®ƒå½±å“åˆ°äº§å“æœåŠ¡å™¨ä¹‹å‰å¾—åˆ°é€šçŸ¥ã€‚å¦‚æœä½ çš„ä»£ç åº“è¢«æ­£ç¡®æµ‹è¯•ï¼Œå…¶ä¸­ä¸€ä¸ªæµ‹è¯•å°†ä¼šå¤±è´¥ï¼Œä½ å°†èƒ½å¤Ÿåœ¨ä»»ä½•æŸå®³å‘ç”Ÿä¹‹å‰ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ªé•¿æœŸé¡¹ç›®ï¼Œä½ åº”è¯¥æµ‹è¯•ä½ çš„ä»£ç åº“çš„ä¸€ä¸ªé‡è¦åŸå› :å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªå›¢é˜Ÿä¸­å·¥ä½œï¼Œå¿…é¡»äº’ç›¸ä¿æŠ¤ã€‚ä¸€äº›å…¬å¸ç”šè‡³é€šè¿‡åœ¨ä»–ä»¬çš„å·¥ä½œæµç¨‹ä¸­å¼•å…¥è¯¸å¦‚[æµ‹è¯•é©±åŠ¨å¼€å‘(TDD)](https://blog.logrocket.com/a-low-friction-way-to-do-tdd-with-react/) è¿™æ ·çš„æ–¹æ³•æ¥æ”¹å˜ä»–ä»¬çš„ç¼–ç æ–¹å¼ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™æ„å‘³ç€æ‚¨åœ¨ç¼–ç ä¸šåŠ¡é€»è¾‘ä¹‹å‰ç¼–å†™æµ‹è¯•(å³è§„èŒƒ)ã€‚

æ‚¨åº”è¯¥æµ‹è¯•ç»„ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œçš„å¦ä¸€ä¸ªåŸå› æ˜¯ï¼Œè¿™æ ·åšå¯ä»¥ä¸ºæ¯ä¸ªç»„ä»¶æä¾›æ–‡æ¡£ã€‚é€šè¿‡é˜…è¯»æµ‹è¯•(æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ä¸­æ¼”ç¤º)ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯¹äºç»™å®šçš„è¾“å…¥(ä¸€ä¸ªé“å…·ã€ä¸€ä¸ªäº‹ä»¶ç­‰)ï¼Œæˆ‘ä»¬å¯ä»¥æœŸæœ›ä»€ä¹ˆæ ·çš„è¾“å‡ºã€‚).è€Œä¸”ï¼Œæ‚¨å¯èƒ½å·²ç»çŸ¥é“ï¼Œä¼˜ç§€çš„æ–‡æ¡£ä¼šä½¿è°ƒè¯•å˜å¾—æ›´å®¹æ˜“ã€‚ğŸ˜ƒğŸ“–

ä½†æ˜¯å¦‚æœä½ é—®æˆ‘æˆ‘æœ€å–œæ¬¢æµ‹è¯•çš„å“ªä¸€ç‚¹ï¼Œé‚£å°±æ˜¯é‡æ„å¯ä»¥å˜å¾—å¤šäº§ã€‚å‡ å¹´å‰ï¼Œå½“æˆ‘å¼€å§‹èµ°ä¸Šæˆä¸ºä¸€å web å¼€å‘äººå‘˜çš„ç‹¬ç‰¹é“è·¯æ—¶ï¼Œæˆ‘å¾ˆå¿«è®¤è¯†åˆ°ä»£ç åº“ä¸æ˜¯é™æ€çš„ï¼Œä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå‘ç”Ÿå¾ˆå¤§å˜åŒ–ã€‚æ¢å¥è¯è¯´ï¼Œä½ å¿…é¡»æ¯å‘¨é‡æ„å®ƒçš„ä¸€éƒ¨åˆ†ã€‚

æˆ‘è®°å¾—äº§å“ç»ç†è®©æˆ‘åœ¨ä¸€ä¸ªæœ€å…³é”®çš„ç•Œé¢ä¸­å¼•å…¥ä¸€ä¸ªå­åŠŸèƒ½ã€‚å¯¹æˆ‘æ¥è¯´ä¸å¹¸çš„æ˜¯ï¼Œå®ƒéœ€è¦å¯¹è®¸å¤šç»„ä»¶è¿›è¡Œå®Œæ•´çš„é‡æ„æ‰èƒ½å·¥ä½œã€‚æˆ‘å®³æ€•æ‰“ç ´ä»€ä¹ˆä¸œè¥¿ï¼Œä½†è¿™ç§ææƒ§å¾ˆå¿«å°±æ¶ˆå¤±äº†ã€‚åœ¨æˆ‘å®Œæˆé‡æ„ä¹‹åï¼Œæˆ‘éå¸¸é«˜å…´åœ°çœ‹åˆ°æ‰€æœ‰çš„æµ‹è¯•éƒ½é€šè¿‡äº†ï¼Œæ²¡æœ‰è§¦å‘ä»»ä½•é”™è¯¯ã€‚

è‡ªä¿¡æ˜¯å…³é”®ï¼äº‹å®ä¸Šï¼Œè¿™æ˜¯æµ‹è¯• Vue.js ç»„ä»¶çš„å¦ä¸€ä¸ªå¥½å¤„ã€‚å½“æ‚¨ç¡®ä¿¡æ‚¨çš„ä»£ç å·¥ä½œæ­£å¸¸æ—¶ï¼Œæ‚¨å°±å¯ä»¥ç¡®ä¿¡æ‚¨æ²¡æœ‰å‘å¸ƒæŸåçš„è½¯ä»¶ã€‚ğŸ˜‡

å¦‚æœä½ ä»ç„¶ä¸ç›¸ä¿¡ï¼Œè¿™é‡Œæœ‰æ›´å¤šçš„é£Ÿç‰©ä¾›ä½ æ€è€ƒ:è§£å†³é—®é¢˜é€šå¸¸æ¯”é¢„é˜²é—®é¢˜è¦æ˜‚è´µå¾—å¤šã€‚ç¼–å†™æµ‹è¯•æ‰€èŠ±è´¹çš„æ—¶é—´æ˜¯å€¼å¾—çš„ã€‚

## åº”è¯¥å¦‚ä½•æµ‹è¯• Vue.js ç»„ä»¶ï¼Ÿ

è®¨è®ºæˆ‘ä»¬åº”è¯¥æµ‹è¯•ä»€ä¹ˆæ˜¯å¿…è¦çš„ã€‚å¯¹äº UI ç»„ä»¶ï¼Œæˆ‘ä¸å»ºè®®æµ‹è¯•æ¯ä¸€è¡Œä»£ç ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´è¿‡äºå…³æ³¨ç»„ä»¶çš„å†…éƒ¨å®ç°(ä¾‹å¦‚ï¼Œè¾¾åˆ° 100%çš„æµ‹è¯•è¦†ç›–ç‡)ã€‚

ç›¸åï¼Œæˆ‘ä»¬åº”è¯¥ç¼–å†™æ–­è¨€ç»„ä»¶å…¬å…±æ¥å£çš„æµ‹è¯•ï¼Œå¹¶å°†å…¶è§†ä¸ºå†…éƒ¨é»‘ç›’ã€‚ä¸€ä¸ªå•ç‹¬çš„æµ‹è¯•ç”¨ä¾‹å°†æ–­è¨€æä¾›ç»™ç»„ä»¶çš„ä¸€äº›è¾“å…¥(ç”¨æˆ·åŠ¨ä½œã€é“å…·ã€å­˜å‚¨)ä¼šäº§ç”Ÿé¢„æœŸçš„è¾“å‡º(ç»„ä»¶æ¸²æŸ“ã€vue äº‹ä»¶ã€å‡½æ•°è°ƒç”¨ç­‰)ã€‚).

æ­¤å¤–ï¼Œå»å¹´ï¼Œæˆ‘åœ¨ Vue Amsterdam è§‚çœ‹äº† Sarah Dayan çš„ç²¾å½©æ¼”è®²ï¼Œé¢˜ç›®æ˜¯â€œ[ç”¨ Vue.js è¿›è¡Œæµ‹è¯•é©±åŠ¨å¼€å‘](https://www.youtube.com/watch?v=LXR1DRm-Gzo)â€ã€‚åœ¨å¥¹çš„ä¸€å¼ å¹»ç¯ç‰‡ä¸­ï¼Œå¥¹è¯´è¦å†³å®šä½ æ˜¯å¦åº”è¯¥æµ‹è¯•ä½ çš„ä¸€ä¸ªç»„ä»¶(æˆ–è€…å…¶ä¸­çš„ä¸€ä¸ªç‰¹æ€§)ï¼Œä½ å¿…é¡»é—®ä½ è‡ªå·±:å¦‚æœå®ƒæ”¹å˜äº†ï¼Œæˆ‘ä¼šå…³å¿ƒå®ƒå—ï¼Ÿæ¢å¥è¯è¯´ï¼Œå¦‚æœæœ‰äººç ´åäº†è¿™ä¸ªç‰¹æ€§ï¼Œå®ƒæ˜¯å¦ä¼šå¯¼è‡´ç•Œé¢å‡ºç°é—®é¢˜ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œæ‚¨åº”è¯¥ç¼–å†™ä¸€ä¸ªæµ‹è¯•æ¥å¢å¼ºæ‚¨çš„ä»£ç ã€‚

## ä»€ä¹ˆæ˜¯ Vue æµ‹è¯•å·¥å…·ï¼Ÿ

ç°åœ¨æˆ‘ä»¬æ¥è°ˆè°ˆæˆ¿é—´é‡Œçš„å¤§è±¡ã€‚ä»€ä¹ˆæ˜¯ Vue æµ‹è¯•å·¥å…·ï¼ŸğŸ¤”

Vue Test Utils æ˜¯ä¸€ä¸ªå®˜æ–¹çš„å¸®åŠ©å‡½æ•°åº“ï¼Œå¸®åŠ©ç”¨æˆ·æµ‹è¯•ä»–ä»¬çš„ Vue.js ç»„ä»¶ã€‚å®ƒæä¾›äº†ä¸€äº›ä»¥éš”ç¦»æ–¹å¼æŒ‚è½½ Vue.js ç»„ä»¶å¹¶ä¸ä¹‹äº¤äº’çš„æ–¹æ³•ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºåŒ…è£…ã€‚ä½†æ˜¯ä»€ä¹ˆæ˜¯åŒ…è£…å‘¢ï¼Ÿ

åŒ…è£…å™¨æ˜¯å·²å®‰è£…ç»„ä»¶çš„æŠ½è±¡ã€‚å®ƒæä¾›äº†ä¸€äº›å®ç”¨åŠŸèƒ½ï¼Œè®©æˆ‘ä»¬çš„ç”Ÿæ´»å˜å¾—æ›´å®¹æ˜“ï¼Œæ¯”å¦‚å½“æˆ‘ä»¬æƒ³è¦è§¦å‘ä¸€æ¬¡ç‚¹å‡»æˆ–ä¸€ä¸ªäº‹ä»¶æ—¶ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥æ‰§è¡Œä¸€äº›è¾“å…¥(ç”¨æˆ·åŠ¨ä½œã€é“å…·ã€å•†åº—æ›´æ”¹ç­‰)ã€‚)è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ£€æŸ¥è¾“å‡ºæ˜¯å¦æ­£ç¡®(ç»„ä»¶æ¸²æŸ“ã€Vue äº‹ä»¶ã€å‡½æ•°è°ƒç”¨ç­‰)ã€‚).

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåŒ…è£…å™¨ä¸Šæ²¡æœ‰æ‚¨éœ€è¦çš„ä¸œè¥¿ï¼Œæ‚¨å¯ä»¥ç”¨`wrapper.vm`è·å– Vue å®ä¾‹ã€‚æ‰€ä»¥ä½ æœ‰å¾ˆå¤§çš„çµæ´»æ€§ã€‚

æ‚¨å¯ä»¥åœ¨å®˜æ–¹çš„ [Vue Test Utils æ–‡æ¡£](https://vue-test-utils.vuejs.org/api/wrapper/#properties)ä¸­æ‰¾åˆ°åŒ…è£…å™¨ä¸Šå¯ç”¨çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚

Vue Test Utils ä¹Ÿå…è®¸ç”¨`shallowMount`æˆ–å•ç‹¬çš„å­˜æ ¹æ¥å‘ˆç°æ¨¡ä»¿å’Œå­˜æ ¹ç»„ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬å°†åœ¨åé¢è®¨è®ºã€‚æ‰€ä»¥æ˜¯çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å®Œæ•´å¯é çš„åº“ï¼Œä½ ä¼šå–œæ¬¢çš„ã€‚ğŸ˜

## ä½¿ç”¨ Vue æµ‹è¯•å·¥å…·æµ‹è¯• Vue.js ç»„ä»¶

ç°åœ¨æ˜¯æ—¶å€™åŠ¨æ‰‹äº†ï¼Œå¼€å§‹ç”¨ Vue æµ‹è¯•å·¥å…·æµ‹è¯•æˆ‘ä»¬çš„ç»„ä»¶ã€‚

### å»ºç«‹åŸºç¡€è®¾æ–½

ä½ å¯ä»¥åœ¨ä¸¤ä½è¯•è·‘è€…ä¸­è¿›è¡Œé€‰æ‹©: [Jest](https://blog.logrocket.com/testing-with-jest-from-zero-to-hero-85ce0e9cc953/) æˆ–è€…[æ‘©å¡å’ŒæŸ´](https://blog.logrocket.com/how-to-test-strapi-endpoints-with-mocha-and-chai/)ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Jestï¼Œå› ä¸ºæ¨èä½¿ç”¨å¸¦æœ‰ [Jest](https://jestjs.io/) çš„ Vue æµ‹è¯•å·¥å…·ã€‚

å¦‚æœä½ ä¸ç†Ÿæ‚‰ Jestï¼Œè¿™æ˜¯ä¸€æ¬¾ç”±è„¸ä¹¦å¼€å‘çš„æµ‹è¯•ç‰ˆã€‚å®ƒæ—¨åœ¨æä¾›ä¸€ä¸ªåŒ…å«ç”µæ± çš„å•å…ƒæµ‹è¯•è§£å†³æ–¹æ¡ˆã€‚

å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Vue CLI æ„å»ºæ‚¨çš„é¡¹ç›®ï¼Œä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨æ‚¨å½“å‰çš„ Vue åº”ç”¨ç¨‹åºä¸­è®¾ç½® Vue æµ‹è¯•å·¥å…·ã€‚

> å¯¹äºæ‰‹åŠ¨å®‰è£…ï¼Œè¯·éµå¾ªæ–‡æ¡£ä¸­çš„[å®‰è£…æŒ‡å—](https://vue-test-utils.vuejs.org/installation/#using-vue-test-utils-with-jest-recommended)ã€‚

```
vue add unit-jest
npm install --save-dev @vue/test-utils

```

æ‚¨ç°åœ¨åº”è¯¥çœ‹åˆ°ä¸€ä¸ªæ–°çš„å‘½ä»¤è¢«æ·»åŠ åˆ°`package.json`ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•ã€‚

```
{
  "scripts": {
    "test:unit": "vue-cli-service test:unit"
  }
}

```

### æµ‹è¯•æˆ‘ä»¬çš„`HabitComponent`

ç°åœ¨æ˜¯æ—¶å€™åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€å¥—æµ‹è¯•äº†ã€‚å¯¹äºæˆ‘ä»¬çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä¹ æƒ¯è·Ÿè¸ªå™¨ã€‚å®ƒå°†ç”±ä¸€ä¸ªå•ç‹¬çš„éƒ¨åˆ†ç»„æˆï¼Œæˆ‘ä»¬å°†å…¶å‘½åä¸º`Habit.vue`ï¼Œæˆ‘ä»¬å°†åœ¨æ¯æ¬¡å®Œæˆä¹ æƒ¯æ—¶å‹¾é€‰å®ƒã€‚åœ¨ç»„ä»¶æ–‡ä»¶å¤¹ä¸­ï¼Œå¤åˆ¶/ç²˜è´´ä»¥ä¸‹ä»£ç :

```
<template>
  <div class="habit">
    <span class="habit__name">{{ name }}</span>
    <span :class="{ 'habit__box--done': done }" class="habit__box" @click="onHabitDone">
      <span v-if="done">âœ”</span>
    </span>
  </div>
</template>
<script>
export default {
  name: "Habit",
  props: {
    name: {
      type: String,
      required: true,
    },
  },
  data: () => ({
    done: false,
  }),
  methods: {
    onHabitDone() {
      this.done = !this.done;
    },
  },
};
</script>
<style>
.habit {
  height: 100vh;
  width: 100%;
  display: flex;
  text-align: center;
  justify-content: center;
  align-items: center;
  text-transform: uppercase;
  font-family: ui-sans-serif, system-ui;
}
.habit__name {
  font-weight: bold;
  font-size: 64px;
  margin-right: 20px;
}
.habit__box {
  width: 56px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 4px solid #cbd5e0;
  background-color: #ffffff;
  font-size: 40px;
  cursor: pointer;
  border-radius: 10px;
}
.habit__box--done {
  border-color: #22543d;
  background-color: #2f855a;
  color: white;
}
</style>

```

![Learn Something New Unchecked](img/219b3f8b128065c7962f62673cd91ee6.png)

![Learn Something New Checked](img/e028c6f784055b7ba99f17ad8f7452ac.png)

è¯¥ç»„ä»¶æ¥å—ä¸€ä¸ªå•ç‹¬çš„é“å…·(ä¹ æƒ¯çš„æ ‡é¢˜)ï¼Œå¹¶åŒ…å«ä¸€ä¸ªå½“æˆ‘ä»¬ç‚¹å‡»å®ƒæ—¶å˜æˆç»¿è‰²çš„æ¡†(å³ï¼Œä¹ æƒ¯å®Œæˆ)ã€‚

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„`tests`æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ›å»ºä¸€ä¸ª`Habit.spec.js`ã€‚æˆ‘ä»¬å°†åœ¨å…¶ä¸­ç¼–å†™æ‰€æœ‰çš„æµ‹è¯•ã€‚

è®©æˆ‘ä»¬ä»åˆ›å»ºåŒ…è£…å¯¹è±¡å¼€å§‹ï¼Œå¹¶ç¼–å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæµ‹è¯•ã€‚

```
import { mount } from "@vue/test-utils";
import Habit from "@/components/Habit";
describe("Habit", () => {
  it("makes sure the habit name is rendered", () => {
    const habitName = "Learn something new";
    const wrapper = mount(Habit, {
      propsData: {
        name: habitName,
      },
    });
    expect(wrapper.props().name).toBe(habitName);
    expect(wrapper.text()).toContain(habitName);
  });
});

```

å¦‚æœæ‚¨è¿è¡Œ`npm run test:unit`ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°æ‰€æœ‰æµ‹è¯•éƒ½æˆåŠŸäº†ã€‚

```
> vue-cli-service test:unit
 PASS  tests/unit/Habit.spec.js
  Habit
    âœ“ makes sure the habit name is rendered (11ms)
Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.135s
Ran all test suites.

```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¡®ä¿å½“æˆ‘ä»¬å•å‡»è¯¥æ¡†æ—¶ï¼Œæˆ‘ä»¬çš„ä¹ æƒ¯è¢«é€‰ä¸­ã€‚

```
it("marks the habit as completed", async () => {
  const wrapper = mount(Habit, {
    propsData: {
      name: "Learn something new",
    },
  });
  const box = wrapper.find(".habit__box");
  await box.trigger("click");
  expect(box.text()).toContain("âœ”");
});

```

æ³¨æ„æµ‹è¯•å¿…é¡»æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”éœ€è¦ç­‰å¾…è§¦å‘å™¨ã€‚æŸ¥çœ‹ Vue Test Utils æ–‡æ¡£ä¸­çš„â€œ[æµ‹è¯•å¼‚æ­¥è¡Œä¸º](https://vue-test-utils.vuejs.org/guides/#testing-asynchronous-behavior)â€ä¸€æ–‡ï¼Œäº†è§£ä¸ºä»€ä¹ˆè¿™æ˜¯å¿…è¦çš„ï¼Œä»¥åŠåœ¨æµ‹è¯•å¼‚æ­¥åœºæ™¯æ—¶éœ€è¦è€ƒè™‘çš„å…¶ä»–äº‹é¡¹ã€‚

```
> vue-cli-service test:unit
 PASS  tests/unit/Habit.spec.js
  Habit
    âœ“ makes sure the habit name is rendered (11ms)
    âœ“ marks the habit as completed (10ms)
Test Suites: 1 passed, 1 total
Tests:       2 passed, 2 total
Snapshots:   0 total
Time:        1.135s
Ran all test suites.

```

æˆ‘ä»¬è¿˜å¯ä»¥éªŒè¯å½“æˆ‘ä»¬ç‚¹å‡»å®ƒæ—¶æ˜¯å¦è°ƒç”¨äº†`onHabitDone`æ–¹æ³•ã€‚

```
it("calls the onHabitDone method", async () => {
  const wrapper = mount(Habit, {
    propsData: {
      name: "Learn something new",
    },
  });
  wrapper.setMethods({
    onHabitDone: jest.fn(),
  });
  const box = wrapper.find(".habit__box");
  await box.trigger("click");
  expect(wrapper.vm.onHabitDone).toHaveBeenCalled();
});

```

è¿è¡Œ`npm run test:unit`ï¼Œä¸€åˆ‡éƒ½åº”è¯¥æ˜¯ç»¿è‰²çš„ã€‚

ä¸‹é¢æ˜¯æ‚¨åº”è¯¥åœ¨ç»ˆç«¯ä¸­çœ‹åˆ°çš„å†…å®¹:

```
> vue-cli-service test:unit
 PASS  tests/unit/Habit.spec.js
  Habit
    âœ“ makes sure the habit name is rendered (11ms)
    âœ“ marks the habit as completed (10ms)
    âœ“ calls the onHabitDone method (2ms)
Test Suites: 1 passed, 1 total
Tests:       3 passed, 3 total
Snapshots:   0 total
Time:        1.135s
Ran all test suites.

```

å½“æˆ‘ä»¬æ”¹å˜ä¸€ä¸ªé“å…·æ—¶ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æ£€æŸ¥ç»„ä»¶çš„è¡Œä¸ºæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚

```
it("updates the habit method", async () => {
  const wrapper = mount(Habit, {
    propsData: {
      name: "Learn something new",
    },
  });
  const newHabitName = "Brush my teeth";
  await wrapper.setProps({
    name: newHabitName,
  });
  expect(wrapper.props().name).toBe(newHabitName);
});

```

ä¸‹é¢æ˜¯æ‚¨åº”è¯¥åœ¨ç»ˆç«¯ä¸­çœ‹åˆ°çš„å†…å®¹:

```
> vue-cli-service test:unit
 PASS  tests/unit/Habit.spec.js
  Habit
    âœ“ makes sure the habit name is rendered (11ms)
    âœ“ marks the habit as completed (10ms)
    âœ“ calls the onHabitDone method (2ms)
    âœ“ updates the habit method (2ms)
Test Suites: 1 passed, 1 total
Tests:       4 passed, 4 total
Snapshots:   0 total
Time:        1.135s
Ran all test suites.

```

ä¸ºäº†å¸®åŠ©ä½ æ›´å¿«åœ°ç¼–ç ï¼Œä¸‹é¢æ˜¯æˆ‘æœ€å¸¸ç”¨çš„åŒ…è£…æ–¹æ³•:

*   `wrapper.attributes()`:è¿”å›åŒ…è£…å™¨ DOM èŠ‚ç‚¹å±æ€§å¯¹è±¡
*   `wrapper.classes()`:è¿”å›åŒ…è£…å™¨ DOM èŠ‚ç‚¹ç±»
*   `wrapper.destroy()`:é”€æ¯ä¸€ä¸ª Vue ç»„ä»¶å®ä¾‹
*   `wrapper.emitted()`:è¿”å›ä¸€ä¸ªåŒ…å«åŒ…è£…å™¨ vm å‘å‡ºçš„è‡ªå®šä¹‰äº‹ä»¶çš„å¯¹è±¡
*   `wrapper.find()`:è¿”å›ç¬¬ä¸€ä¸ª DOM èŠ‚ç‚¹æˆ– Vue ç»„ä»¶åŒ¹é…é€‰æ‹©å™¨çš„åŒ…è£…å™¨
*   `wrapper.findAll()`:è¿”å›ä¸€ä¸ª WrapperArray
*   `wrapper.html()`:ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›åŒ…è£…å™¨ DOM èŠ‚ç‚¹çš„ HTML
*   `wrapper.isVisible()`:æ–­è¨€åŒ…è£…å™¨å¯è§
*   `wrapper.setData()`:è®¾ç½®åŒ…è£…è™šæ‹Ÿæœºæ•°æ®
*   `wrapper.setProps()`:è®¾ç½®åŒ…è£…è™šæ‹Ÿæœºå±æ€§å¹¶å¼ºåˆ¶æ›´æ–°
*   `wrapper.text()`:è¿”å›åŒ…è£…å™¨çš„æ–‡æœ¬å†…å®¹
*   `wrapper.trigger()`:åœ¨åŒ…è£…å™¨ DOM èŠ‚ç‚¹ä¸Šå¼‚æ­¥è§¦å‘äº‹ä»¶

### ä½¿ç”¨`fetch`

å¦‚æœæ‚¨åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨`fetch`æ–¹æ³•æ¥è°ƒç”¨ APIï¼Œæ‚¨å°†ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ç¡®ä¿åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­å®šä¹‰äº†`fetch`ã€‚

```
npm install -D isomorphic-fetch

```

ç„¶åæ›´æ–°ä½ çš„`package.json`ã€‚

```
{
  "scripts": {
    "test:unit": "vue-cli-service test:unit --require isomorphic-fetch"
  }
}

```

### `mount`å¯¹`shallowMount`

ä½ å¯èƒ½ä¼šå‘ç°æœ‰äº›äººåœ¨ç”¨`shallowMount`è€Œä¸æ˜¯`mount`ã€‚åŸå› æ˜¯ï¼Œåƒ`mount`ä¸€æ ·ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å·²æŒ‚è½½å’Œæ¸²æŸ“çš„ Vue.js ç»„ä»¶çš„åŒ…è£…å™¨ï¼Œä½†æ˜¯å¸¦æœ‰å­˜æ ¹å­ç»„ä»¶ã€‚

è¿™æ„å‘³ç€ç»„ä»¶çš„æ¸²æŸ“é€Ÿåº¦ä¼šæ›´å¿«ï¼Œå› ä¸ºå®ƒçš„æ‰€æœ‰å­ç»„ä»¶éƒ½ä¸ä¼šè¢«è®¡ç®—ã€‚ä¸è¿‡è¦å°å¿ƒï¼›å¦‚æœæ‚¨è¯•å›¾æµ‹è¯•ä¸å„¿ç«¥ç»„ä»¶ç›¸å…³çš„ä¸œè¥¿ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›éº»çƒ¦ã€‚

## æˆ‘ä»¬å°†ä½•å»ä½•ä»ï¼Ÿ

Vue Test Utils æ–‡æ¡£æ˜¯å¸®åŠ©æ‚¨å¼€å§‹çš„å¾ˆå¥½çš„èµ„æºâ€”â€”å°¤å…¶æ˜¯æ¯æœˆæ›´æ–°çš„[æŒ‡å—](https://vue-test-utils.vuejs.org/guides/#testing-asynchronous-behavior)ã€‚åŒ…å«æ‰€æœ‰[åŒ…è£…æ–¹æ³•](https://vue-test-utils.vuejs.org/api/wrapper/)å’Œ[Jest API](https://jestjs.io/docs/api)çš„é¡µé¢éƒ½æ˜¯éå¸¸å¥½çš„èµ„æºï¼Œä½ ä¹Ÿåº”è¯¥æŠŠå®ƒä»¬æ”¶è—èµ·æ¥ã€‚

è®°ä½ï¼Œä¸ºä½ çš„é¡¹ç›®ç»ƒä¹ å’Œç¼–å†™æµ‹è¯•æ˜¯å¼€å§‹å­¦ä¹ çš„æœ€å¥½æ–¹å¼ã€‚æˆ‘å¸Œæœ›è¿™ä¸ªæŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£ä½ çš„ç»„ä»¶æµ‹è¯•æœ‰å¤šå¥å£®ã€‚è¿™å¹¶ä¸éš¾ã€‚ğŸ˜ƒ

æˆ‘ä»¬å°†ä»¥è‘—åè®¡ç®—æœºç§‘å­¦å®¶å”çº³å¾·Â·å…‹åŠªç‰¹çš„ä¸€å¥è¯æ¥ç»“æŸæœ¬æŒ‡å—:â€œè®¡ç®—æœºæ“…é•¿éµå¾ªæŒ‡ä»¤ï¼Œä½†ä¸æ“…é•¿é˜…è¯»ä½ çš„æ€æƒ³ã€‚â€

æˆ‘å¾ˆä¹æ„é˜…è¯»ä½ çš„è¯„è®ºå’Œä½ çš„æ¨ç‰¹ä¿¡æ¯ã€‚å¦‚æœä½ å¯¹æˆ‘çš„ä½œå“æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥å» NadaRifki.com çš„[çœ‹çœ‹ã€‚](https://www.nadarifki.com/)

## åƒç”¨æˆ·ä¸€æ ·ä½“éªŒæ‚¨çš„ Vue åº”ç”¨

è°ƒè¯• Vue.js åº”ç”¨ç¨‹åºå¯èƒ½ä¼šå¾ˆå›°éš¾ï¼Œå°¤å…¶æ˜¯å½“ç”¨æˆ·ä¼šè¯æœŸé—´æœ‰å‡ åä¸ª(å¦‚æœä¸æ˜¯å‡ ç™¾ä¸ª)çªå˜æ—¶ã€‚å¦‚æœæ‚¨å¯¹ç›‘è§†å’Œè·Ÿè¸ªç”Ÿäº§ä¸­æ‰€æœ‰ç”¨æˆ·çš„ Vue çªå˜æ„Ÿå…´è¶£ï¼Œ

[try LogRocket](https://lp.logrocket.com/blg/vue-signup)

.

[![LogRocket Dashboard Free Trial Banner](img/0d269845910c723dd7df26adab9289cb.png)](https://lp.logrocket.com/blg/vue-signup)[https://logrocket.com/signup/](https://lp.logrocket.com/blg/vue-signup)

LogRocket å°±åƒæ˜¯ç½‘ç»œå’Œç§»åŠ¨åº”ç”¨ç¨‹åºçš„ DVRï¼Œè®°å½•ä½ çš„ Vue åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„ä¸€åˆ‡ï¼ŒåŒ…æ‹¬ç½‘ç»œè¯·æ±‚ã€JavaScript é”™è¯¯ã€æ€§èƒ½é—®é¢˜ç­‰ç­‰ã€‚æ‚¨å¯ä»¥æ±‡æ€»å¹¶æŠ¥å‘Šé—®é¢˜å‘ç”Ÿæ—¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯çŒœæµ‹é—®é¢˜å‘ç”Ÿçš„åŸå› ã€‚

LogRocket Vuex æ’ä»¶å°† Vuex çªå˜è®°å½•åˆ° LogRocket æ§åˆ¶å°ï¼Œä¸ºæ‚¨æä¾›å¯¼è‡´é”™è¯¯çš„ç¯å¢ƒï¼Œä»¥åŠå‡ºç°é—®é¢˜æ—¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚

ç°ä»£åŒ–æ‚¨è°ƒè¯• Vue åº”ç”¨çš„æ–¹å¼- [å¼€å§‹å…è´¹ç›‘æ§](https://lp.logrocket.com/blg/vue-signup)ã€‚